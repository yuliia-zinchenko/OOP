<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Read&amp;Watch: PIL.JpegImagePlugin Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Read&amp;Watch<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('namespace_p_i_l_1_1_jpeg_image_plugin.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">PIL.JpegImagePlugin Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_p_i_l_1_1_jpeg_image_plugin_1_1_jpeg_image_file.html">JpegImageFile</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="namespace_p_i_l_1_1_image.html">Image</a> plugin for JPEG and JFIF images.  <a href="class_p_i_l_1_1_jpeg_image_plugin_1_1_jpeg_image_file.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:afe15a3c3f72a567a64108675f1664b87" id="r_afe15a3c3f72a567a64108675f1664b87"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afe15a3c3f72a567a64108675f1664b87">Skip</a> (<a class="el" href="class_p_i_l_1_1_jpeg_image_plugin_1_1_jpeg_image_file.html">JpegImageFile</a> self, int marker)</td></tr>
<tr class="separator:afe15a3c3f72a567a64108675f1664b87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9de3d403408dd1e4fbf1a841abd3e7f9" id="r_a9de3d403408dd1e4fbf1a841abd3e7f9"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9de3d403408dd1e4fbf1a841abd3e7f9">APP</a> (<a class="el" href="class_p_i_l_1_1_jpeg_image_plugin_1_1_jpeg_image_file.html">JpegImageFile</a> self, int marker)</td></tr>
<tr class="separator:a9de3d403408dd1e4fbf1a841abd3e7f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a772c0d77e82bc5ee80530e80650cdfc6" id="r_a772c0d77e82bc5ee80530e80650cdfc6"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a772c0d77e82bc5ee80530e80650cdfc6">COM</a> (<a class="el" href="class_p_i_l_1_1_jpeg_image_plugin_1_1_jpeg_image_file.html">JpegImageFile</a> self, int marker)</td></tr>
<tr class="separator:a772c0d77e82bc5ee80530e80650cdfc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89e7f8788da7ed2ab1c96db5864cee11" id="r_a89e7f8788da7ed2ab1c96db5864cee11"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a89e7f8788da7ed2ab1c96db5864cee11">SOF</a> (<a class="el" href="class_p_i_l_1_1_jpeg_image_plugin_1_1_jpeg_image_file.html">JpegImageFile</a> self, int marker)</td></tr>
<tr class="separator:a89e7f8788da7ed2ab1c96db5864cee11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14e10f7b0d4e2499867dd8e4d1fb094c" id="r_a14e10f7b0d4e2499867dd8e4d1fb094c"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a14e10f7b0d4e2499867dd8e4d1fb094c">DQT</a> (<a class="el" href="class_p_i_l_1_1_jpeg_image_plugin_1_1_jpeg_image_file.html">JpegImageFile</a> self, int marker)</td></tr>
<tr class="separator:a14e10f7b0d4e2499867dd8e4d1fb094c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f74d2601a4ac083773a5747ad31672a" id="r_a3f74d2601a4ac083773a5747ad31672a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3f74d2601a4ac083773a5747ad31672a">_accept</a> (bytes prefix)</td></tr>
<tr class="separator:a3f74d2601a4ac083773a5747ad31672a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8b336bf3ae6123be5fbca0c08d40db2" id="r_af8b336bf3ae6123be5fbca0c08d40db2"><td class="memItemLeft" align="right" valign="top">dict[int, Any]|None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af8b336bf3ae6123be5fbca0c08d40db2">_getexif</a> (<a class="el" href="class_p_i_l_1_1_jpeg_image_plugin_1_1_jpeg_image_file.html">JpegImageFile</a> self)</td></tr>
<tr class="separator:af8b336bf3ae6123be5fbca0c08d40db2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5b0eb47167f3af323be1bedd83f0421" id="r_af5b0eb47167f3af323be1bedd83f0421"><td class="memItemLeft" align="right" valign="top">dict[int, Any]|None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af5b0eb47167f3af323be1bedd83f0421">_getmp</a> (<a class="el" href="class_p_i_l_1_1_jpeg_image_plugin_1_1_jpeg_image_file.html">JpegImageFile</a> self)</td></tr>
<tr class="separator:af5b0eb47167f3af323be1bedd83f0421"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff2aa1cda47ff39d51c118a35bdc2f9d" id="r_aff2aa1cda47ff39d51c118a35bdc2f9d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aff2aa1cda47ff39d51c118a35bdc2f9d">get_sampling</a> (<a class="el" href="class_p_i_l_1_1_image_1_1_image.html">Image.Image</a> im)</td></tr>
<tr class="separator:aff2aa1cda47ff39d51c118a35bdc2f9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab14944c7750f20a4d2328f277e6cca2b" id="r_ab14944c7750f20a4d2328f277e6cca2b"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab14944c7750f20a4d2328f277e6cca2b">_save</a> (<a class="el" href="class_p_i_l_1_1_image_1_1_image.html">Image.Image</a> im, IO[bytes] <a class="el" href="#afbb81958534085c78a999abdb1ed0665">fp</a>, str|bytes filename)</td></tr>
<tr class="separator:ab14944c7750f20a4d2328f277e6cca2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada8a3b869598115ac5b4788726ba84f3" id="r_ada8a3b869598115ac5b4788726ba84f3"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ada8a3b869598115ac5b4788726ba84f3">_save_cjpeg</a> (<a class="el" href="class_p_i_l_1_1_image_1_1_image.html">Image.Image</a> im, IO[bytes] <a class="el" href="#afbb81958534085c78a999abdb1ed0665">fp</a>, str|bytes filename)</td></tr>
<tr class="separator:ada8a3b869598115ac5b4788726ba84f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adaa95fbf8dcde283abb2a9f76142fe90" id="r_adaa95fbf8dcde283abb2a9f76142fe90"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_p_i_l_1_1_jpeg_image_plugin_1_1_jpeg_image_file.html">JpegImageFile</a>|<a class="el" href="class_p_i_l_1_1_mpo_image_plugin_1_1_mpo_image_file.html">MpoImageFile</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adaa95fbf8dcde283abb2a9f76142fe90">jpeg_factory</a> (IO[bytes] <a class="el" href="#afbb81958534085c78a999abdb1ed0665">fp</a>, str|bytes|None filename=None)</td></tr>
<tr class="memdesc:adaa95fbf8dcde283abb2a9f76142fe90"><td class="mdescLeft">&#160;</td><td class="mdescRight">Factory for making JPEG and MPO instances.  <br /></td></tr>
<tr class="separator:adaa95fbf8dcde283abb2a9f76142fe90"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a3b27b9d942b836a660aa4a35e3cc72c9" id="r_a3b27b9d942b836a660aa4a35e3cc72c9"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3b27b9d942b836a660aa4a35e3cc72c9">MARKER</a></td></tr>
<tr class="separator:a3b27b9d942b836a660aa4a35e3cc72c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d2046bc6df6ca9276d643df706f0aa9" id="r_a1d2046bc6df6ca9276d643df706f0aa9"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1d2046bc6df6ca9276d643df706f0aa9">RAWMODE</a></td></tr>
<tr class="separator:a1d2046bc6df6ca9276d643df706f0aa9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c522eff72189a902699b7f7a812696d" id="r_a5c522eff72189a902699b7f7a812696d"><td class="memItemLeft" align="right" valign="top">tuple&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5c522eff72189a902699b7f7a812696d">zigzag_index</a></td></tr>
<tr class="separator:a5c522eff72189a902699b7f7a812696d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bbc666db1d7d40d2f46edf4049b206b" id="r_a1bbc666db1d7d40d2f46edf4049b206b"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1bbc666db1d7d40d2f46edf4049b206b">samplings</a></td></tr>
<tr class="separator:a1bbc666db1d7d40d2f46edf4049b206b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbb81958534085c78a999abdb1ed0665" id="r_afbb81958534085c78a999abdb1ed0665"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afbb81958534085c78a999abdb1ed0665">fp</a></td></tr>
<tr class="separator:afbb81958534085c78a999abdb1ed0665"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40b92cd4a9c45da7b56686a3cc519624" id="r_a40b92cd4a9c45da7b56686a3cc519624"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a40b92cd4a9c45da7b56686a3cc519624">info</a></td></tr>
<tr class="separator:a40b92cd4a9c45da7b56686a3cc519624"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92799851a2c617a51da1a0b7965a70a0" id="r_a92799851a2c617a51da1a0b7965a70a0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a92799851a2c617a51da1a0b7965a70a0">_exif_offset</a> = self.fp.tell() - n + 6</td></tr>
<tr class="separator:a92799851a2c617a51da1a0b7965a70a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a456375d0b35ab014bd7158bbfda703eb" id="r_a456375d0b35ab014bd7158bbfda703eb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a456375d0b35ab014bd7158bbfda703eb">_size</a> = i16(s, 3), i16(s, 1)</td></tr>
<tr class="separator:a456375d0b35ab014bd7158bbfda703eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfc8adc0e5df82d6c92e3ff83b6321f5" id="r_acfc8adc0e5df82d6c92e3ff83b6321f5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acfc8adc0e5df82d6c92e3ff83b6321f5">bits</a> = s[0]</td></tr>
<tr class="separator:acfc8adc0e5df82d6c92e3ff83b6321f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a22d7065c3cc02c4c1f03cfe0a5b8c4" id="r_a6a22d7065c3cc02c4c1f03cfe0a5b8c4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6a22d7065c3cc02c4c1f03cfe0a5b8c4">layers</a> = s[5]</td></tr>
<tr class="separator:a6a22d7065c3cc02c4c1f03cfe0a5b8c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6ae54d57ff5bc6a00b78887e01ae83f" id="r_af6ae54d57ff5bc6a00b78887e01ae83f"><td class="memItemLeft" align="right" valign="top">str&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af6ae54d57ff5bc6a00b78887e01ae83f">_mode</a> = &quot;L&quot;</td></tr>
<tr class="separator:af6ae54d57ff5bc6a00b78887e01ae83f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47a254d76d58cbef017fed2014f3cf45" id="r_a47a254d76d58cbef017fed2014f3cf45"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a47a254d76d58cbef017fed2014f3cf45">icclist</a> = 1</td></tr>
<tr class="separator:a47a254d76d58cbef017fed2014f3cf45"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a3f74d2601a4ac083773a5747ad31672a" name="a3f74d2601a4ac083773a5747ad31672a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f74d2601a4ac083773a5747ad31672a">&#9670;&#160;</a></span>_accept()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> bool PIL.JpegImagePlugin._accept </td>
          <td>(</td>
          <td class="paramtype">bytes</td>          <td class="paramname"><span class="paramname"><em>prefix</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_jpeg_image_plugin_8py_source.html#l00323">323</a> of file <a class="el" href="_jpeg_image_plugin_8py_source.html">JpegImagePlugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  323</span><span class="keyword">def </span>_accept(prefix: bytes) -&gt; bool:</div>
<div class="line"><span class="lineno">  324</span>    <span class="comment"># Magic number was taken from https://en.wikipedia.org/wiki/JPEG</span></div>
<div class="line"><span class="lineno">  325</span>    <span class="keywordflow">return</span> prefix[:3] == b<span class="stringliteral">&quot;\xFF\xD8\xFF&quot;</span></div>
<div class="line"><span class="lineno">  326</span> </div>
<div class="line"><span class="lineno">  327</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="_jpeg_image_plugin_8py_source.html#l00336">PIL.JpegImagePlugin.JpegImageFile._open()</a>.</p>

</div>
</div>
<a id="af8b336bf3ae6123be5fbca0c08d40db2" name="af8b336bf3ae6123be5fbca0c08d40db2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8b336bf3ae6123be5fbca0c08d40db2">&#9670;&#160;</a></span>_getexif()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> dict[int, Any] | None PIL.JpegImagePlugin._getexif </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_p_i_l_1_1_jpeg_image_plugin_1_1_jpeg_image_file.html">JpegImageFile</a></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_jpeg_image_plugin_8py_source.html#l00521">521</a> of file <a class="el" href="_jpeg_image_plugin_8py_source.html">JpegImagePlugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  521</span><span class="keyword">def </span>_getexif(self: JpegImageFile) -&gt; dict[int, Any] | <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  522</span>    <span class="keywordflow">if</span> <span class="stringliteral">&quot;exif&quot;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> self.info:</div>
<div class="line"><span class="lineno">  523</span>        <span class="keywordflow">return</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  524</span>    <span class="keywordflow">return</span> self.getexif()._get_merged_dict()</div>
<div class="line"><span class="lineno">  525</span> </div>
<div class="line"><span class="lineno">  526</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af5b0eb47167f3af323be1bedd83f0421" name="af5b0eb47167f3af323be1bedd83f0421"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5b0eb47167f3af323be1bedd83f0421">&#9670;&#160;</a></span>_getmp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> dict[int, Any] | None PIL.JpegImagePlugin._getmp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_p_i_l_1_1_jpeg_image_plugin_1_1_jpeg_image_file.html">JpegImageFile</a></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_jpeg_image_plugin_8py_source.html#l00527">527</a> of file <a class="el" href="_jpeg_image_plugin_8py_source.html">JpegImagePlugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  527</span><span class="keyword">def </span>_getmp(self: JpegImageFile) -&gt; dict[int, Any] | <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  528</span>    <span class="comment"># Extract MP information.  This method was inspired by the &quot;highly</span></div>
<div class="line"><span class="lineno">  529</span>    <span class="comment"># experimental&quot; _getexif version that&#39;s been in use for years now,</span></div>
<div class="line"><span class="lineno">  530</span>    <span class="comment"># itself based on the ImageFileDirectory class in the TIFF plugin.</span></div>
<div class="line"><span class="lineno">  531</span> </div>
<div class="line"><span class="lineno">  532</span>    <span class="comment"># The MP record essentially consists of a TIFF file embedded in a JPEG</span></div>
<div class="line"><span class="lineno">  533</span>    <span class="comment"># application marker.</span></div>
<div class="line"><span class="lineno">  534</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  535</span>        data = self.info[<span class="stringliteral">&quot;mp&quot;</span>]</div>
<div class="line"><span class="lineno">  536</span>    <span class="keywordflow">except</span> KeyError:</div>
<div class="line"><span class="lineno">  537</span>        <span class="keywordflow">return</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  538</span>    file_contents = io.BytesIO(data)</div>
<div class="line"><span class="lineno">  539</span>    head = file_contents.read(8)</div>
<div class="line"><span class="lineno">  540</span>    endianness = <span class="stringliteral">&quot;&gt;&quot;</span> <span class="keywordflow">if</span> head[:4] == b<span class="stringliteral">&quot;\x4d\x4d\x00\x2a&quot;</span> <span class="keywordflow">else</span> <span class="stringliteral">&quot;&lt;&quot;</span></div>
<div class="line"><span class="lineno">  541</span>    <span class="comment"># process dictionary</span></div>
<div class="line"><span class="lineno">  542</span>    <span class="keyword">from</span> . <span class="keyword">import</span> TiffImagePlugin</div>
<div class="line"><span class="lineno">  543</span> </div>
<div class="line"><span class="lineno">  544</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  545</span>        info = TiffImagePlugin.ImageFileDirectory_v2(head)</div>
<div class="line"><span class="lineno">  546</span>        file_contents.seek(info.next)</div>
<div class="line"><span class="lineno">  547</span>        info.load(file_contents)</div>
<div class="line"><span class="lineno">  548</span>        mp = dict(info)</div>
<div class="line"><span class="lineno">  549</span>    <span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  550</span>        msg = <span class="stringliteral">&quot;malformed MP Index (unreadable directory)&quot;</span></div>
<div class="line"><span class="lineno">  551</span>        <span class="keywordflow">raise</span> SyntaxError(msg) <span class="keyword">from</span> e</div>
<div class="line"><span class="lineno">  552</span>    <span class="comment"># it&#39;s an error not to have a number of images</span></div>
<div class="line"><span class="lineno">  553</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  554</span>        quant = mp[0xB001]</div>
<div class="line"><span class="lineno">  555</span>    <span class="keywordflow">except</span> KeyError <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  556</span>        msg = <span class="stringliteral">&quot;malformed MP Index (no number of images)&quot;</span></div>
<div class="line"><span class="lineno">  557</span>        <span class="keywordflow">raise</span> SyntaxError(msg) <span class="keyword">from</span> e</div>
<div class="line"><span class="lineno">  558</span>    <span class="comment"># get MP entries</span></div>
<div class="line"><span class="lineno">  559</span>    mpentries = []</div>
<div class="line"><span class="lineno">  560</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  561</span>        rawmpentries = mp[0xB002]</div>
<div class="line"><span class="lineno">  562</span>        <span class="keywordflow">for</span> entrynum <span class="keywordflow">in</span> range(0, quant):</div>
<div class="line"><span class="lineno">  563</span>            unpackedentry = struct.unpack_from(</div>
<div class="line"><span class="lineno">  564</span>                f<span class="stringliteral">&quot;{endianness}LLLHH&quot;</span>, rawmpentries, entrynum * 16</div>
<div class="line"><span class="lineno">  565</span>            )</div>
<div class="line"><span class="lineno">  566</span>            labels = (<span class="stringliteral">&quot;Attribute&quot;</span>, <span class="stringliteral">&quot;Size&quot;</span>, <span class="stringliteral">&quot;DataOffset&quot;</span>, <span class="stringliteral">&quot;EntryNo1&quot;</span>, <span class="stringliteral">&quot;EntryNo2&quot;</span>)</div>
<div class="line"><span class="lineno">  567</span>            mpentry = dict(zip(labels, unpackedentry))</div>
<div class="line"><span class="lineno">  568</span>            mpentryattr = {</div>
<div class="line"><span class="lineno">  569</span>                <span class="stringliteral">&quot;DependentParentImageFlag&quot;</span>: bool(mpentry[<span class="stringliteral">&quot;Attribute&quot;</span>] &amp; (1 &lt;&lt; 31)),</div>
<div class="line"><span class="lineno">  570</span>                <span class="stringliteral">&quot;DependentChildImageFlag&quot;</span>: bool(mpentry[<span class="stringliteral">&quot;Attribute&quot;</span>] &amp; (1 &lt;&lt; 30)),</div>
<div class="line"><span class="lineno">  571</span>                <span class="stringliteral">&quot;RepresentativeImageFlag&quot;</span>: bool(mpentry[<span class="stringliteral">&quot;Attribute&quot;</span>] &amp; (1 &lt;&lt; 29)),</div>
<div class="line"><span class="lineno">  572</span>                <span class="stringliteral">&quot;Reserved&quot;</span>: (mpentry[<span class="stringliteral">&quot;Attribute&quot;</span>] &amp; (3 &lt;&lt; 27)) &gt;&gt; 27,</div>
<div class="line"><span class="lineno">  573</span>                <span class="stringliteral">&quot;ImageDataFormat&quot;</span>: (mpentry[<span class="stringliteral">&quot;Attribute&quot;</span>] &amp; (7 &lt;&lt; 24)) &gt;&gt; 24,</div>
<div class="line"><span class="lineno">  574</span>                <span class="stringliteral">&quot;MPType&quot;</span>: mpentry[<span class="stringliteral">&quot;Attribute&quot;</span>] &amp; 0x00FFFFFF,</div>
<div class="line"><span class="lineno">  575</span>            }</div>
<div class="line"><span class="lineno">  576</span>            <span class="keywordflow">if</span> mpentryattr[<span class="stringliteral">&quot;ImageDataFormat&quot;</span>] == 0:</div>
<div class="line"><span class="lineno">  577</span>                mpentryattr[<span class="stringliteral">&quot;ImageDataFormat&quot;</span>] = <span class="stringliteral">&quot;JPEG&quot;</span></div>
<div class="line"><span class="lineno">  578</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  579</span>                msg = <span class="stringliteral">&quot;unsupported picture format in MPO&quot;</span></div>
<div class="line"><span class="lineno">  580</span>                <span class="keywordflow">raise</span> SyntaxError(msg)</div>
<div class="line"><span class="lineno">  581</span>            mptypemap = {</div>
<div class="line"><span class="lineno">  582</span>                0x000000: <span class="stringliteral">&quot;Undefined&quot;</span>,</div>
<div class="line"><span class="lineno">  583</span>                0x010001: <span class="stringliteral">&quot;Large Thumbnail (VGA Equivalent)&quot;</span>,</div>
<div class="line"><span class="lineno">  584</span>                0x010002: <span class="stringliteral">&quot;Large Thumbnail (Full HD Equivalent)&quot;</span>,</div>
<div class="line"><span class="lineno">  585</span>                0x020001: <span class="stringliteral">&quot;Multi-Frame Image (Panorama)&quot;</span>,</div>
<div class="line"><span class="lineno">  586</span>                0x020002: <span class="stringliteral">&quot;Multi-Frame Image: (Disparity)&quot;</span>,</div>
<div class="line"><span class="lineno">  587</span>                0x020003: <span class="stringliteral">&quot;Multi-Frame Image: (Multi-Angle)&quot;</span>,</div>
<div class="line"><span class="lineno">  588</span>                0x030000: <span class="stringliteral">&quot;Baseline MP Primary Image&quot;</span>,</div>
<div class="line"><span class="lineno">  589</span>            }</div>
<div class="line"><span class="lineno">  590</span>            mpentryattr[<span class="stringliteral">&quot;MPType&quot;</span>] = mptypemap.get(mpentryattr[<span class="stringliteral">&quot;MPType&quot;</span>], <span class="stringliteral">&quot;Unknown&quot;</span>)</div>
<div class="line"><span class="lineno">  591</span>            mpentry[<span class="stringliteral">&quot;Attribute&quot;</span>] = mpentryattr</div>
<div class="line"><span class="lineno">  592</span>            mpentries.append(mpentry)</div>
<div class="line"><span class="lineno">  593</span>        mp[0xB002] = mpentries</div>
<div class="line"><span class="lineno">  594</span>    <span class="keywordflow">except</span> KeyError <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  595</span>        msg = <span class="stringliteral">&quot;malformed MP Index (bad MP Entry)&quot;</span></div>
<div class="line"><span class="lineno">  596</span>        <span class="keywordflow">raise</span> SyntaxError(msg) <span class="keyword">from</span> e</div>
<div class="line"><span class="lineno">  597</span>    <span class="comment"># Next we should try and parse the individual image unique ID list;</span></div>
<div class="line"><span class="lineno">  598</span>    <span class="comment"># we don&#39;t because I&#39;ve never seen this actually used in a real MPO</span></div>
<div class="line"><span class="lineno">  599</span>    <span class="comment"># file and so can&#39;t test it.</span></div>
<div class="line"><span class="lineno">  600</span>    <span class="keywordflow">return</span> mp</div>
<div class="line"><span class="lineno">  601</span> </div>
<div class="line"><span class="lineno">  602</span> </div>
<div class="line"><span class="lineno">  603</span><span class="comment"># --------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  604</span><span class="comment"># stuff to save JPEG files</span></div>
<div class="line"><span class="lineno">  605</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab14944c7750f20a4d2328f277e6cca2b" name="ab14944c7750f20a4d2328f277e6cca2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab14944c7750f20a4d2328f277e6cca2b">&#9670;&#160;</a></span>_save()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> None PIL.JpegImagePlugin._save </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_p_i_l_1_1_image_1_1_image.html">Image.Image</a></td>          <td class="paramname"><span class="paramname"><em>im</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IO[bytes]</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str | bytes</td>          <td class="paramname"><span class="paramname"><em>filename</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_jpeg_image_plugin_8py_source.html#l00649">649</a> of file <a class="el" href="_jpeg_image_plugin_8py_source.html">JpegImagePlugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  649</span><span class="keyword">def </span>_save(im: Image.Image, fp: IO[bytes], filename: str | bytes) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  650</span>    <span class="keywordflow">if</span> im.width == 0 <span class="keywordflow">or</span> im.height == 0:</div>
<div class="line"><span class="lineno">  651</span>        msg = <span class="stringliteral">&quot;cannot write empty image as JPEG&quot;</span></div>
<div class="line"><span class="lineno">  652</span>        <span class="keywordflow">raise</span> ValueError(msg)</div>
<div class="line"><span class="lineno">  653</span> </div>
<div class="line"><span class="lineno">  654</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  655</span>        rawmode = RAWMODE[im.mode]</div>
<div class="line"><span class="lineno">  656</span>    <span class="keywordflow">except</span> KeyError <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  657</span>        msg = f<span class="stringliteral">&quot;cannot write mode {im.mode} as JPEG&quot;</span></div>
<div class="line"><span class="lineno">  658</span>        <span class="keywordflow">raise</span> OSError(msg) <span class="keyword">from</span> e</div>
<div class="line"><span class="lineno">  659</span> </div>
<div class="line"><span class="lineno">  660</span>    info = im.encoderinfo</div>
<div class="line"><span class="lineno">  661</span> </div>
<div class="line"><span class="lineno">  662</span>    dpi = [round(x) <span class="keywordflow">for</span> x <span class="keywordflow">in</span> info.get(<span class="stringliteral">&quot;dpi&quot;</span>, (0, 0))]</div>
<div class="line"><span class="lineno">  663</span> </div>
<div class="line"><span class="lineno">  664</span>    quality = info.get(<span class="stringliteral">&quot;quality&quot;</span>, -1)</div>
<div class="line"><span class="lineno">  665</span>    subsampling = info.get(<span class="stringliteral">&quot;subsampling&quot;</span>, -1)</div>
<div class="line"><span class="lineno">  666</span>    qtables = info.get(<span class="stringliteral">&quot;qtables&quot;</span>)</div>
<div class="line"><span class="lineno">  667</span> </div>
<div class="line"><span class="lineno">  668</span>    <span class="keywordflow">if</span> quality == <span class="stringliteral">&quot;keep&quot;</span>:</div>
<div class="line"><span class="lineno">  669</span>        quality = -1</div>
<div class="line"><span class="lineno">  670</span>        subsampling = <span class="stringliteral">&quot;keep&quot;</span></div>
<div class="line"><span class="lineno">  671</span>        qtables = <span class="stringliteral">&quot;keep&quot;</span></div>
<div class="line"><span class="lineno">  672</span>    <span class="keywordflow">elif</span> quality <span class="keywordflow">in</span> presets:</div>
<div class="line"><span class="lineno">  673</span>        preset = presets[quality]</div>
<div class="line"><span class="lineno">  674</span>        quality = -1</div>
<div class="line"><span class="lineno">  675</span>        subsampling = preset.get(<span class="stringliteral">&quot;subsampling&quot;</span>, -1)</div>
<div class="line"><span class="lineno">  676</span>        qtables = preset.get(<span class="stringliteral">&quot;quantization&quot;</span>)</div>
<div class="line"><span class="lineno">  677</span>    <span class="keywordflow">elif</span> <span class="keywordflow">not</span> isinstance(quality, int):</div>
<div class="line"><span class="lineno">  678</span>        msg = <span class="stringliteral">&quot;Invalid quality setting&quot;</span></div>
<div class="line"><span class="lineno">  679</span>        <span class="keywordflow">raise</span> ValueError(msg)</div>
<div class="line"><span class="lineno">  680</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  681</span>        <span class="keywordflow">if</span> subsampling <span class="keywordflow">in</span> presets:</div>
<div class="line"><span class="lineno">  682</span>            subsampling = presets[subsampling].get(<span class="stringliteral">&quot;subsampling&quot;</span>, -1)</div>
<div class="line"><span class="lineno">  683</span>        <span class="keywordflow">if</span> isinstance(qtables, str) <span class="keywordflow">and</span> qtables <span class="keywordflow">in</span> presets:</div>
<div class="line"><span class="lineno">  684</span>            qtables = presets[qtables].get(<span class="stringliteral">&quot;quantization&quot;</span>)</div>
<div class="line"><span class="lineno">  685</span> </div>
<div class="line"><span class="lineno">  686</span>    <span class="keywordflow">if</span> subsampling == <span class="stringliteral">&quot;4:4:4&quot;</span>:</div>
<div class="line"><span class="lineno">  687</span>        subsampling = 0</div>
<div class="line"><span class="lineno">  688</span>    <span class="keywordflow">elif</span> subsampling == <span class="stringliteral">&quot;4:2:2&quot;</span>:</div>
<div class="line"><span class="lineno">  689</span>        subsampling = 1</div>
<div class="line"><span class="lineno">  690</span>    <span class="keywordflow">elif</span> subsampling == <span class="stringliteral">&quot;4:2:0&quot;</span>:</div>
<div class="line"><span class="lineno">  691</span>        subsampling = 2</div>
<div class="line"><span class="lineno">  692</span>    <span class="keywordflow">elif</span> subsampling == <span class="stringliteral">&quot;4:1:1&quot;</span>:</div>
<div class="line"><span class="lineno">  693</span>        <span class="comment"># For compatibility. Before Pillow 4.3, 4:1:1 actually meant 4:2:0.</span></div>
<div class="line"><span class="lineno">  694</span>        <span class="comment"># Set 4:2:0 if someone is still using that value.</span></div>
<div class="line"><span class="lineno">  695</span>        subsampling = 2</div>
<div class="line"><span class="lineno">  696</span>    <span class="keywordflow">elif</span> subsampling == <span class="stringliteral">&quot;keep&quot;</span>:</div>
<div class="line"><span class="lineno">  697</span>        <span class="keywordflow">if</span> im.format != <span class="stringliteral">&quot;JPEG&quot;</span>:</div>
<div class="line"><span class="lineno">  698</span>            msg = <span class="stringliteral">&quot;Cannot use &#39;keep&#39; when original image is not a JPEG&quot;</span></div>
<div class="line"><span class="lineno">  699</span>            <span class="keywordflow">raise</span> ValueError(msg)</div>
<div class="line"><span class="lineno">  700</span>        subsampling = get_sampling(im)</div>
<div class="line"><span class="lineno">  701</span> </div>
<div class="line"><span class="lineno">  702</span>    <span class="keyword">def </span>validate_qtables(</div>
<div class="line"><span class="lineno">  703</span>        qtables: (</div>
<div class="line"><span class="lineno">  704</span>            str | tuple[list[int], ...] | list[list[int]] | dict[int, list[int]] | <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  705</span>        )</div>
<div class="line"><span class="lineno">  706</span>    ) -&gt; list[list[int]] | <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  707</span>        <span class="keywordflow">if</span> qtables <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  708</span>            <span class="keywordflow">return</span> qtables</div>
<div class="line"><span class="lineno">  709</span>        <span class="keywordflow">if</span> isinstance(qtables, str):</div>
<div class="line"><span class="lineno">  710</span>            <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  711</span>                lines = [</div>
<div class="line"><span class="lineno">  712</span>                    int(num)</div>
<div class="line"><span class="lineno">  713</span>                    <span class="keywordflow">for</span> line <span class="keywordflow">in</span> qtables.splitlines()</div>
<div class="line"><span class="lineno">  714</span>                    <span class="keywordflow">for</span> num <span class="keywordflow">in</span> line.split(<span class="stringliteral">&quot;#&quot;</span>, 1)[0].split()</div>
<div class="line"><span class="lineno">  715</span>                ]</div>
<div class="line"><span class="lineno">  716</span>            <span class="keywordflow">except</span> ValueError <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  717</span>                msg = <span class="stringliteral">&quot;Invalid quantization table&quot;</span></div>
<div class="line"><span class="lineno">  718</span>                <span class="keywordflow">raise</span> ValueError(msg) <span class="keyword">from</span> e</div>
<div class="line"><span class="lineno">  719</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  720</span>                qtables = [lines[s : s + 64] <span class="keywordflow">for</span> s <span class="keywordflow">in</span> range(0, len(lines), 64)]</div>
<div class="line"><span class="lineno">  721</span>        <span class="keywordflow">if</span> isinstance(qtables, (tuple, list, dict)):</div>
<div class="line"><span class="lineno">  722</span>            <span class="keywordflow">if</span> isinstance(qtables, dict):</div>
<div class="line"><span class="lineno">  723</span>                qtables = [</div>
<div class="line"><span class="lineno">  724</span>                    qtables[key] <span class="keywordflow">for</span> key <span class="keywordflow">in</span> range(len(qtables)) <span class="keywordflow">if</span> key <span class="keywordflow">in</span> qtables</div>
<div class="line"><span class="lineno">  725</span>                ]</div>
<div class="line"><span class="lineno">  726</span>            <span class="keywordflow">elif</span> isinstance(qtables, tuple):</div>
<div class="line"><span class="lineno">  727</span>                qtables = list(qtables)</div>
<div class="line"><span class="lineno">  728</span>            <span class="keywordflow">if</span> <span class="keywordflow">not</span> (0 &lt; len(qtables) &lt; 5):</div>
<div class="line"><span class="lineno">  729</span>                msg = <span class="stringliteral">&quot;None or too many quantization tables&quot;</span></div>
<div class="line"><span class="lineno">  730</span>                <span class="keywordflow">raise</span> ValueError(msg)</div>
<div class="line"><span class="lineno">  731</span>            <span class="keywordflow">for</span> idx, table <span class="keywordflow">in</span> enumerate(qtables):</div>
<div class="line"><span class="lineno">  732</span>                <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  733</span>                    <span class="keywordflow">if</span> len(table) != 64:</div>
<div class="line"><span class="lineno">  734</span>                        msg = <span class="stringliteral">&quot;Invalid quantization table&quot;</span></div>
<div class="line"><span class="lineno">  735</span>                        <span class="keywordflow">raise</span> TypeError(msg)</div>
<div class="line"><span class="lineno">  736</span>                    table_array = array.array(<span class="stringliteral">&quot;H&quot;</span>, table)</div>
<div class="line"><span class="lineno">  737</span>                <span class="keywordflow">except</span> TypeError <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  738</span>                    msg = <span class="stringliteral">&quot;Invalid quantization table&quot;</span></div>
<div class="line"><span class="lineno">  739</span>                    <span class="keywordflow">raise</span> ValueError(msg) <span class="keyword">from</span> e</div>
<div class="line"><span class="lineno">  740</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  741</span>                    qtables[idx] = list(table_array)</div>
<div class="line"><span class="lineno">  742</span>            <span class="keywordflow">return</span> qtables</div>
<div class="line"><span class="lineno">  743</span> </div>
<div class="line"><span class="lineno">  744</span>    <span class="keywordflow">if</span> qtables == <span class="stringliteral">&quot;keep&quot;</span>:</div>
<div class="line"><span class="lineno">  745</span>        <span class="keywordflow">if</span> im.format != <span class="stringliteral">&quot;JPEG&quot;</span>:</div>
<div class="line"><span class="lineno">  746</span>            msg = <span class="stringliteral">&quot;Cannot use &#39;keep&#39; when original image is not a JPEG&quot;</span></div>
<div class="line"><span class="lineno">  747</span>            <span class="keywordflow">raise</span> ValueError(msg)</div>
<div class="line"><span class="lineno">  748</span>        qtables = getattr(im, <span class="stringliteral">&quot;quantization&quot;</span>, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  749</span>    qtables = validate_qtables(qtables)</div>
<div class="line"><span class="lineno">  750</span> </div>
<div class="line"><span class="lineno">  751</span>    extra = info.get(<span class="stringliteral">&quot;extra&quot;</span>, b<span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><span class="lineno">  752</span> </div>
<div class="line"><span class="lineno">  753</span>    MAX_BYTES_IN_MARKER = 65533</div>
<div class="line"><span class="lineno">  754</span>    xmp = info.get(<span class="stringliteral">&quot;xmp&quot;</span>, im.info.get(<span class="stringliteral">&quot;xmp&quot;</span>))</div>
<div class="line"><span class="lineno">  755</span>    <span class="keywordflow">if</span> xmp:</div>
<div class="line"><span class="lineno">  756</span>        overhead_len = 29  <span class="comment"># b&quot;http://ns.adobe.com/xap/1.0/\x00&quot;</span></div>
<div class="line"><span class="lineno">  757</span>        max_data_bytes_in_marker = MAX_BYTES_IN_MARKER - overhead_len</div>
<div class="line"><span class="lineno">  758</span>        <span class="keywordflow">if</span> len(xmp) &gt; max_data_bytes_in_marker:</div>
<div class="line"><span class="lineno">  759</span>            msg = <span class="stringliteral">&quot;XMP data is too long&quot;</span></div>
<div class="line"><span class="lineno">  760</span>            <span class="keywordflow">raise</span> ValueError(msg)</div>
<div class="line"><span class="lineno">  761</span>        size = o16(2 + overhead_len + len(xmp))</div>
<div class="line"><span class="lineno">  762</span>        extra += b<span class="stringliteral">&quot;\xFF\xE1&quot;</span> + size + b<span class="stringliteral">&quot;http://ns.adobe.com/xap/1.0/\x00&quot;</span> + xmp</div>
<div class="line"><span class="lineno">  763</span> </div>
<div class="line"><span class="lineno">  764</span>    icc_profile = info.get(<span class="stringliteral">&quot;icc_profile&quot;</span>)</div>
<div class="line"><span class="lineno">  765</span>    <span class="keywordflow">if</span> icc_profile:</div>
<div class="line"><span class="lineno">  766</span>        overhead_len = 14  <span class="comment"># b&quot;ICC_PROFILE\0&quot; + o8(i) + o8(len(markers))</span></div>
<div class="line"><span class="lineno">  767</span>        max_data_bytes_in_marker = MAX_BYTES_IN_MARKER - overhead_len</div>
<div class="line"><span class="lineno">  768</span>        markers = []</div>
<div class="line"><span class="lineno">  769</span>        <span class="keywordflow">while</span> icc_profile:</div>
<div class="line"><span class="lineno">  770</span>            markers.append(icc_profile[:max_data_bytes_in_marker])</div>
<div class="line"><span class="lineno">  771</span>            icc_profile = icc_profile[max_data_bytes_in_marker:]</div>
<div class="line"><span class="lineno">  772</span>        i = 1</div>
<div class="line"><span class="lineno">  773</span>        <span class="keywordflow">for</span> marker <span class="keywordflow">in</span> markers:</div>
<div class="line"><span class="lineno">  774</span>            size = o16(2 + overhead_len + len(marker))</div>
<div class="line"><span class="lineno">  775</span>            extra += (</div>
<div class="line"><span class="lineno">  776</span>                b<span class="stringliteral">&quot;\xFF\xE2&quot;</span></div>
<div class="line"><span class="lineno">  777</span>                + size</div>
<div class="line"><span class="lineno">  778</span>                + b<span class="stringliteral">&quot;ICC_PROFILE\0&quot;</span></div>
<div class="line"><span class="lineno">  779</span>                + o8(i)</div>
<div class="line"><span class="lineno">  780</span>                + o8(len(markers))</div>
<div class="line"><span class="lineno">  781</span>                + marker</div>
<div class="line"><span class="lineno">  782</span>            )</div>
<div class="line"><span class="lineno">  783</span>            i += 1</div>
<div class="line"><span class="lineno">  784</span> </div>
<div class="line"><span class="lineno">  785</span>    comment = info.get(<span class="stringliteral">&quot;comment&quot;</span>, im.info.get(<span class="stringliteral">&quot;comment&quot;</span>))</div>
<div class="line"><span class="lineno">  786</span> </div>
<div class="line"><span class="lineno">  787</span>    <span class="comment"># &quot;progressive&quot; is the official name, but older documentation</span></div>
<div class="line"><span class="lineno">  788</span>    <span class="comment"># says &quot;progression&quot;</span></div>
<div class="line"><span class="lineno">  789</span>    <span class="comment"># FIXME: issue a warning if the wrong form is used (post-1.1.7)</span></div>
<div class="line"><span class="lineno">  790</span>    progressive = info.get(<span class="stringliteral">&quot;progressive&quot;</span>, <span class="keyword">False</span>) <span class="keywordflow">or</span> info.get(<span class="stringliteral">&quot;progression&quot;</span>, <span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  791</span> </div>
<div class="line"><span class="lineno">  792</span>    optimize = info.get(<span class="stringliteral">&quot;optimize&quot;</span>, <span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  793</span> </div>
<div class="line"><span class="lineno">  794</span>    exif = info.get(<span class="stringliteral">&quot;exif&quot;</span>, b<span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><span class="lineno">  795</span>    <span class="keywordflow">if</span> isinstance(exif, Image.Exif):</div>
<div class="line"><span class="lineno">  796</span>        exif = exif.tobytes()</div>
<div class="line"><span class="lineno">  797</span>    <span class="keywordflow">if</span> len(exif) &gt; MAX_BYTES_IN_MARKER:</div>
<div class="line"><span class="lineno">  798</span>        msg = <span class="stringliteral">&quot;EXIF data is too long&quot;</span></div>
<div class="line"><span class="lineno">  799</span>        <span class="keywordflow">raise</span> ValueError(msg)</div>
<div class="line"><span class="lineno">  800</span> </div>
<div class="line"><span class="lineno">  801</span>    <span class="comment"># get keyword arguments</span></div>
<div class="line"><span class="lineno">  802</span>    im.encoderconfig = (</div>
<div class="line"><span class="lineno">  803</span>        quality,</div>
<div class="line"><span class="lineno">  804</span>        progressive,</div>
<div class="line"><span class="lineno">  805</span>        info.get(<span class="stringliteral">&quot;smooth&quot;</span>, 0),</div>
<div class="line"><span class="lineno">  806</span>        optimize,</div>
<div class="line"><span class="lineno">  807</span>        info.get(<span class="stringliteral">&quot;keep_rgb&quot;</span>, <span class="keyword">False</span>),</div>
<div class="line"><span class="lineno">  808</span>        info.get(<span class="stringliteral">&quot;streamtype&quot;</span>, 0),</div>
<div class="line"><span class="lineno">  809</span>        dpi[0],</div>
<div class="line"><span class="lineno">  810</span>        dpi[1],</div>
<div class="line"><span class="lineno">  811</span>        subsampling,</div>
<div class="line"><span class="lineno">  812</span>        info.get(<span class="stringliteral">&quot;restart_marker_blocks&quot;</span>, 0),</div>
<div class="line"><span class="lineno">  813</span>        info.get(<span class="stringliteral">&quot;restart_marker_rows&quot;</span>, 0),</div>
<div class="line"><span class="lineno">  814</span>        qtables,</div>
<div class="line"><span class="lineno">  815</span>        comment,</div>
<div class="line"><span class="lineno">  816</span>        extra,</div>
<div class="line"><span class="lineno">  817</span>        exif,</div>
<div class="line"><span class="lineno">  818</span>    )</div>
<div class="line"><span class="lineno">  819</span> </div>
<div class="line"><span class="lineno">  820</span>    <span class="comment"># if we optimize, libjpeg needs a buffer big enough to hold the whole image</span></div>
<div class="line"><span class="lineno">  821</span>    <span class="comment"># in a shot. Guessing on the size, at im.size bytes. (raw pixel size is</span></div>
<div class="line"><span class="lineno">  822</span>    <span class="comment"># channels*size, this is a value that&#39;s been used in a django patch.</span></div>
<div class="line"><span class="lineno">  823</span>    <span class="comment"># https://github.com/matthewwithanm/django-imagekit/issues/50</span></div>
<div class="line"><span class="lineno">  824</span>    bufsize = 0</div>
<div class="line"><span class="lineno">  825</span>    <span class="keywordflow">if</span> optimize <span class="keywordflow">or</span> progressive:</div>
<div class="line"><span class="lineno">  826</span>        <span class="comment"># CMYK can be bigger</span></div>
<div class="line"><span class="lineno">  827</span>        <span class="keywordflow">if</span> im.mode == <span class="stringliteral">&quot;CMYK&quot;</span>:</div>
<div class="line"><span class="lineno">  828</span>            bufsize = 4 * im.size[0] * im.size[1]</div>
<div class="line"><span class="lineno">  829</span>        <span class="comment"># keep sets quality to -1, but the actual value may be high.</span></div>
<div class="line"><span class="lineno">  830</span>        <span class="keywordflow">elif</span> quality &gt;= 95 <span class="keywordflow">or</span> quality == -1:</div>
<div class="line"><span class="lineno">  831</span>            bufsize = 2 * im.size[0] * im.size[1]</div>
<div class="line"><span class="lineno">  832</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  833</span>            bufsize = im.size[0] * im.size[1]</div>
<div class="line"><span class="lineno">  834</span>        <span class="keywordflow">if</span> exif:</div>
<div class="line"><span class="lineno">  835</span>            bufsize += len(exif) + 5</div>
<div class="line"><span class="lineno">  836</span>        <span class="keywordflow">if</span> extra:</div>
<div class="line"><span class="lineno">  837</span>            bufsize += len(extra) + 1</div>
<div class="line"><span class="lineno">  838</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  839</span>        <span class="comment"># The EXIF info needs to be written as one block, + APP1, + one spare byte.</span></div>
<div class="line"><span class="lineno">  840</span>        <span class="comment"># Ensure that our buffer is big enough. Same with the icc_profile block.</span></div>
<div class="line"><span class="lineno">  841</span>        bufsize = max(bufsize, len(exif) + 5, len(extra) + 1)</div>
<div class="line"><span class="lineno">  842</span> </div>
<div class="line"><span class="lineno">  843</span>    ImageFile._save(</div>
<div class="line"><span class="lineno">  844</span>        im, fp, [ImageFile._Tile(<span class="stringliteral">&quot;jpeg&quot;</span>, (0, 0) + im.size, 0, rawmode)], bufsize</div>
<div class="line"><span class="lineno">  845</span>    )</div>
<div class="line"><span class="lineno">  846</span> </div>
<div class="line"><span class="lineno">  847</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="_jpeg_image_plugin_8py_source.html#l00635">get_sampling()</a>.</p>

</div>
</div>
<a id="ada8a3b869598115ac5b4788726ba84f3" name="ada8a3b869598115ac5b4788726ba84f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada8a3b869598115ac5b4788726ba84f3">&#9670;&#160;</a></span>_save_cjpeg()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> None PIL.JpegImagePlugin._save_cjpeg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_p_i_l_1_1_image_1_1_image.html">Image.Image</a></td>          <td class="paramname"><span class="paramname"><em>im</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IO[bytes]</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str | bytes</td>          <td class="paramname"><span class="paramname"><em>filename</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_jpeg_image_plugin_8py_source.html#l00848">848</a> of file <a class="el" href="_jpeg_image_plugin_8py_source.html">JpegImagePlugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  848</span><span class="keyword">def </span>_save_cjpeg(im: Image.Image, fp: IO[bytes], filename: str | bytes) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  849</span>    <span class="comment"># ALTERNATIVE: handle JPEGs via the IJG command line utilities.</span></div>
<div class="line"><span class="lineno">  850</span>    tempfile = im._dump()</div>
<div class="line"><span class="lineno">  851</span>    subprocess.check_call([<span class="stringliteral">&quot;cjpeg&quot;</span>, <span class="stringliteral">&quot;-outfile&quot;</span>, filename, tempfile])</div>
<div class="line"><span class="lineno">  852</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  853</span>        os.unlink(tempfile)</div>
<div class="line"><span class="lineno">  854</span>    <span class="keywordflow">except</span> OSError:</div>
<div class="line"><span class="lineno">  855</span>        <span class="keywordflow">pass</span></div>
<div class="line"><span class="lineno">  856</span> </div>
<div class="line"><span class="lineno">  857</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9de3d403408dd1e4fbf1a841abd3e7f9" name="a9de3d403408dd1e4fbf1a841abd3e7f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9de3d403408dd1e4fbf1a841abd3e7f9">&#9670;&#160;</a></span>APP()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None PIL.JpegImagePlugin.APP </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_p_i_l_1_1_jpeg_image_plugin_1_1_jpeg_image_file.html">JpegImageFile</a></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>marker</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_jpeg_image_plugin_8py_source.html#l00067">67</a> of file <a class="el" href="_jpeg_image_plugin_8py_source.html">JpegImagePlugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   67</span><span class="keyword">def </span>APP(self: JpegImageFile, marker: int) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">   68</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno">   69</span>    <span class="comment"># Application marker.  Store these in the APP dictionary.</span></div>
<div class="line"><span class="lineno">   70</span>    <span class="comment"># Also look for well-known application markers.</span></div>
<div class="line"><span class="lineno">   71</span> </div>
<div class="line"><span class="lineno">   72</span>    n = i16(self.fp.read(2)) - 2</div>
<div class="line"><span class="lineno">   73</span>    s = ImageFile._safe_read(self.fp, n)</div>
<div class="line"><span class="lineno">   74</span> </div>
<div class="line"><span class="lineno">   75</span>    app = <span class="stringliteral">&quot;APP%d&quot;</span> % (marker &amp; 15)</div>
<div class="line"><span class="lineno">   76</span> </div>
<div class="line"><span class="lineno">   77</span>    self.app[app] = s  <span class="comment"># compatibility</span></div>
<div class="line"><span class="lineno">   78</span>    self.applist.append((app, s))</div>
<div class="line"><span class="lineno">   79</span> </div>
<div class="line"><span class="lineno">   80</span>    <span class="keywordflow">if</span> marker == 0xFFE0 <span class="keywordflow">and</span> s[:4] == b<span class="stringliteral">&quot;JFIF&quot;</span>:</div>
<div class="line"><span class="lineno">   81</span>        <span class="comment"># extract JFIF information</span></div>
<div class="line"><span class="lineno">   82</span>        self.info[<span class="stringliteral">&quot;jfif&quot;</span>] = version = i16(s, 5)  <span class="comment"># version</span></div>
<div class="line"><span class="lineno">   83</span>        self.info[<span class="stringliteral">&quot;jfif_version&quot;</span>] = divmod(version, 256)</div>
<div class="line"><span class="lineno">   84</span>        <span class="comment"># extract JFIF properties</span></div>
<div class="line"><span class="lineno">   85</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">   86</span>            jfif_unit = s[7]</div>
<div class="line"><span class="lineno">   87</span>            jfif_density = i16(s, 8), i16(s, 10)</div>
<div class="line"><span class="lineno">   88</span>        <span class="keywordflow">except</span> Exception:</div>
<div class="line"><span class="lineno">   89</span>            <span class="keywordflow">pass</span></div>
<div class="line"><span class="lineno">   90</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">   91</span>            <span class="keywordflow">if</span> jfif_unit == 1:</div>
<div class="line"><span class="lineno">   92</span>                self.info[<span class="stringliteral">&quot;dpi&quot;</span>] = jfif_density</div>
<div class="line"><span class="lineno">   93</span>            self.info[<span class="stringliteral">&quot;jfif_unit&quot;</span>] = jfif_unit</div>
<div class="line"><span class="lineno">   94</span>            self.info[<span class="stringliteral">&quot;jfif_density&quot;</span>] = jfif_density</div>
<div class="line"><span class="lineno">   95</span>    <span class="keywordflow">elif</span> marker == 0xFFE1 <span class="keywordflow">and</span> s[:6] == b<span class="stringliteral">&quot;Exif\0\0&quot;</span>:</div>
<div class="line"><span class="lineno">   96</span>        <span class="comment"># extract EXIF information</span></div>
<div class="line"><span class="lineno">   97</span>        <span class="keywordflow">if</span> <span class="stringliteral">&quot;exif&quot;</span> <span class="keywordflow">in</span> self.info:</div>
<div class="line"><span class="lineno">   98</span>            self.info[<span class="stringliteral">&quot;exif&quot;</span>] += s[6:]</div>
<div class="line"><span class="lineno">   99</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  100</span>            self.info[<span class="stringliteral">&quot;exif&quot;</span>] = s</div>
<div class="line"><span class="lineno">  101</span>            self._exif_offset = self.fp.tell() - n + 6</div>
<div class="line"><span class="lineno">  102</span>    <span class="keywordflow">elif</span> marker == 0xFFE1 <span class="keywordflow">and</span> s[:29] == b<span class="stringliteral">&quot;http://ns.adobe.com/xap/1.0/\x00&quot;</span>:</div>
<div class="line"><span class="lineno">  103</span>        self.info[<span class="stringliteral">&quot;xmp&quot;</span>] = s.split(b<span class="stringliteral">&quot;\x00&quot;</span>, 1)[1]</div>
<div class="line"><span class="lineno">  104</span>    <span class="keywordflow">elif</span> marker == 0xFFE2 <span class="keywordflow">and</span> s[:5] == b<span class="stringliteral">&quot;FPXR\0&quot;</span>:</div>
<div class="line"><span class="lineno">  105</span>        <span class="comment"># extract FlashPix information (incomplete)</span></div>
<div class="line"><span class="lineno">  106</span>        self.info[<span class="stringliteral">&quot;flashpix&quot;</span>] = s  <span class="comment"># FIXME: value will change</span></div>
<div class="line"><span class="lineno">  107</span>    <span class="keywordflow">elif</span> marker == 0xFFE2 <span class="keywordflow">and</span> s[:12] == b<span class="stringliteral">&quot;ICC_PROFILE\0&quot;</span>:</div>
<div class="line"><span class="lineno">  108</span>        <span class="comment"># Since an ICC profile can be larger than the maximum size of</span></div>
<div class="line"><span class="lineno">  109</span>        <span class="comment"># a JPEG marker (64K), we need provisions to split it into</span></div>
<div class="line"><span class="lineno">  110</span>        <span class="comment"># multiple markers. The format defined by the ICC specifies</span></div>
<div class="line"><span class="lineno">  111</span>        <span class="comment"># one or more APP2 markers containing the following data:</span></div>
<div class="line"><span class="lineno">  112</span>        <span class="comment">#   Identifying string      ASCII &quot;ICC_PROFILE\0&quot;  (12 bytes)</span></div>
<div class="line"><span class="lineno">  113</span>        <span class="comment">#   Marker sequence number  1, 2, etc (1 byte)</span></div>
<div class="line"><span class="lineno">  114</span>        <span class="comment">#   Number of markers       Total of APP2&#39;s used (1 byte)</span></div>
<div class="line"><span class="lineno">  115</span>        <span class="comment">#   Profile data            (remainder of APP2 data)</span></div>
<div class="line"><span class="lineno">  116</span>        <span class="comment"># Decoders should use the marker sequence numbers to</span></div>
<div class="line"><span class="lineno">  117</span>        <span class="comment"># reassemble the profile, rather than assuming that the APP2</span></div>
<div class="line"><span class="lineno">  118</span>        <span class="comment"># markers appear in the correct sequence.</span></div>
<div class="line"><span class="lineno">  119</span>        self.icclist.append(s)</div>
<div class="line"><span class="lineno">  120</span>    <span class="keywordflow">elif</span> marker == 0xFFED <span class="keywordflow">and</span> s[:14] == b<span class="stringliteral">&quot;Photoshop 3.0\x00&quot;</span>:</div>
<div class="line"><span class="lineno">  121</span>        <span class="comment"># parse the image resource block</span></div>
<div class="line"><span class="lineno">  122</span>        offset = 14</div>
<div class="line"><span class="lineno">  123</span>        photoshop = self.info.setdefault(<span class="stringliteral">&quot;photoshop&quot;</span>, {})</div>
<div class="line"><span class="lineno">  124</span>        <span class="keywordflow">while</span> s[offset : offset + 4] == b<span class="stringliteral">&quot;8BIM&quot;</span>:</div>
<div class="line"><span class="lineno">  125</span>            <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  126</span>                offset += 4</div>
<div class="line"><span class="lineno">  127</span>                <span class="comment"># resource code</span></div>
<div class="line"><span class="lineno">  128</span>                code = i16(s, offset)</div>
<div class="line"><span class="lineno">  129</span>                offset += 2</div>
<div class="line"><span class="lineno">  130</span>                <span class="comment"># resource name (usually empty)</span></div>
<div class="line"><span class="lineno">  131</span>                name_len = s[offset]</div>
<div class="line"><span class="lineno">  132</span>                <span class="comment"># name = s[offset+1:offset+1+name_len]</span></div>
<div class="line"><span class="lineno">  133</span>                offset += 1 + name_len</div>
<div class="line"><span class="lineno">  134</span>                offset += offset &amp; 1  <span class="comment"># align</span></div>
<div class="line"><span class="lineno">  135</span>                <span class="comment"># resource data block</span></div>
<div class="line"><span class="lineno">  136</span>                size = i32(s, offset)</div>
<div class="line"><span class="lineno">  137</span>                offset += 4</div>
<div class="line"><span class="lineno">  138</span>                data = s[offset : offset + size]</div>
<div class="line"><span class="lineno">  139</span>                <span class="keywordflow">if</span> code == 0x03ED:  <span class="comment"># ResolutionInfo</span></div>
<div class="line"><span class="lineno">  140</span>                    photoshop[code] = {</div>
<div class="line"><span class="lineno">  141</span>                        <span class="stringliteral">&quot;XResolution&quot;</span>: i32(data, 0) / 65536,</div>
<div class="line"><span class="lineno">  142</span>                        <span class="stringliteral">&quot;DisplayedUnitsX&quot;</span>: i16(data, 4),</div>
<div class="line"><span class="lineno">  143</span>                        <span class="stringliteral">&quot;YResolution&quot;</span>: i32(data, 8) / 65536,</div>
<div class="line"><span class="lineno">  144</span>                        <span class="stringliteral">&quot;DisplayedUnitsY&quot;</span>: i16(data, 12),</div>
<div class="line"><span class="lineno">  145</span>                    }</div>
<div class="line"><span class="lineno">  146</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  147</span>                    photoshop[code] = data</div>
<div class="line"><span class="lineno">  148</span>                offset += size</div>
<div class="line"><span class="lineno">  149</span>                offset += offset &amp; 1  <span class="comment"># align</span></div>
<div class="line"><span class="lineno">  150</span>            <span class="keywordflow">except</span> struct.error:</div>
<div class="line"><span class="lineno">  151</span>                <span class="keywordflow">break</span>  <span class="comment"># insufficient data</span></div>
<div class="line"><span class="lineno">  152</span> </div>
<div class="line"><span class="lineno">  153</span>    <span class="keywordflow">elif</span> marker == 0xFFEE <span class="keywordflow">and</span> s[:5] == b<span class="stringliteral">&quot;Adobe&quot;</span>:</div>
<div class="line"><span class="lineno">  154</span>        self.info[<span class="stringliteral">&quot;adobe&quot;</span>] = i16(s, 5)</div>
<div class="line"><span class="lineno">  155</span>        <span class="comment"># extract Adobe custom properties</span></div>
<div class="line"><span class="lineno">  156</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  157</span>            adobe_transform = s[11]</div>
<div class="line"><span class="lineno">  158</span>        <span class="keywordflow">except</span> IndexError:</div>
<div class="line"><span class="lineno">  159</span>            <span class="keywordflow">pass</span></div>
<div class="line"><span class="lineno">  160</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  161</span>            self.info[<span class="stringliteral">&quot;adobe_transform&quot;</span>] = adobe_transform</div>
<div class="line"><span class="lineno">  162</span>    <span class="keywordflow">elif</span> marker == 0xFFE2 <span class="keywordflow">and</span> s[:4] == b<span class="stringliteral">&quot;MPF\0&quot;</span>:</div>
<div class="line"><span class="lineno">  163</span>        <span class="comment"># extract MPO information</span></div>
<div class="line"><span class="lineno">  164</span>        self.info[<span class="stringliteral">&quot;mp&quot;</span>] = s[4:]</div>
<div class="line"><span class="lineno">  165</span>        <span class="comment"># offset is current location minus buffer size</span></div>
<div class="line"><span class="lineno">  166</span>        <span class="comment"># plus constant header size</span></div>
<div class="line"><span class="lineno">  167</span>        self.info[<span class="stringliteral">&quot;mpoffset&quot;</span>] = self.fp.tell() - n + 4</div>
<div class="line"><span class="lineno">  168</span> </div>
<div class="line"><span class="lineno">  169</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a772c0d77e82bc5ee80530e80650cdfc6" name="a772c0d77e82bc5ee80530e80650cdfc6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a772c0d77e82bc5ee80530e80650cdfc6">&#9670;&#160;</a></span>COM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None PIL.JpegImagePlugin.COM </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_p_i_l_1_1_jpeg_image_plugin_1_1_jpeg_image_file.html">JpegImageFile</a></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>marker</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_jpeg_image_plugin_8py_source.html#l00170">170</a> of file <a class="el" href="_jpeg_image_plugin_8py_source.html">JpegImagePlugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  170</span><span class="keyword">def </span>COM(self: JpegImageFile, marker: int) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  171</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno">  172</span>    <span class="comment"># Comment marker.  Store these in the APP dictionary.</span></div>
<div class="line"><span class="lineno">  173</span>    n = i16(self.fp.read(2)) - 2</div>
<div class="line"><span class="lineno">  174</span>    s = ImageFile._safe_read(self.fp, n)</div>
<div class="line"><span class="lineno">  175</span> </div>
<div class="line"><span class="lineno">  176</span>    self.info[<span class="stringliteral">&quot;comment&quot;</span>] = s</div>
<div class="line"><span class="lineno">  177</span>    self.app[<span class="stringliteral">&quot;COM&quot;</span>] = s  <span class="comment"># compatibility</span></div>
<div class="line"><span class="lineno">  178</span>    self.applist.append((<span class="stringliteral">&quot;COM&quot;</span>, s))</div>
<div class="line"><span class="lineno">  179</span> </div>
<div class="line"><span class="lineno">  180</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a14e10f7b0d4e2499867dd8e4d1fb094c" name="a14e10f7b0d4e2499867dd8e4d1fb094c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14e10f7b0d4e2499867dd8e4d1fb094c">&#9670;&#160;</a></span>DQT()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None PIL.JpegImagePlugin.DQT </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_p_i_l_1_1_jpeg_image_plugin_1_1_jpeg_image_file.html">JpegImageFile</a></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>marker</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_jpeg_image_plugin_8py_source.html#l00229">229</a> of file <a class="el" href="_jpeg_image_plugin_8py_source.html">JpegImagePlugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  229</span><span class="keyword">def </span>DQT(self: JpegImageFile, marker: int) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  230</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno">  231</span>    <span class="comment"># Define quantization table.  Note that there might be more</span></div>
<div class="line"><span class="lineno">  232</span>    <span class="comment"># than one table in each marker.</span></div>
<div class="line"><span class="lineno">  233</span> </div>
<div class="line"><span class="lineno">  234</span>    <span class="comment"># FIXME: The quantization tables can be used to estimate the</span></div>
<div class="line"><span class="lineno">  235</span>    <span class="comment"># compression quality.</span></div>
<div class="line"><span class="lineno">  236</span> </div>
<div class="line"><span class="lineno">  237</span>    n = i16(self.fp.read(2)) - 2</div>
<div class="line"><span class="lineno">  238</span>    s = ImageFile._safe_read(self.fp, n)</div>
<div class="line"><span class="lineno">  239</span>    <span class="keywordflow">while</span> len(s):</div>
<div class="line"><span class="lineno">  240</span>        v = s[0]</div>
<div class="line"><span class="lineno">  241</span>        precision = 1 <span class="keywordflow">if</span> (v // 16 == 0) <span class="keywordflow">else</span> 2  <span class="comment"># in bytes</span></div>
<div class="line"><span class="lineno">  242</span>        qt_length = 1 + precision * 64</div>
<div class="line"><span class="lineno">  243</span>        <span class="keywordflow">if</span> len(s) &lt; qt_length:</div>
<div class="line"><span class="lineno">  244</span>            msg = <span class="stringliteral">&quot;bad quantization table marker&quot;</span></div>
<div class="line"><span class="lineno">  245</span>            <span class="keywordflow">raise</span> SyntaxError(msg)</div>
<div class="line"><span class="lineno">  246</span>        data = array.array(<span class="stringliteral">&quot;B&quot;</span> <span class="keywordflow">if</span> precision == 1 <span class="keywordflow">else</span> <span class="stringliteral">&quot;H&quot;</span>, s[1:qt_length])</div>
<div class="line"><span class="lineno">  247</span>        <span class="keywordflow">if</span> sys.byteorder == <span class="stringliteral">&quot;little&quot;</span> <span class="keywordflow">and</span> precision &gt; 1:</div>
<div class="line"><span class="lineno">  248</span>            data.byteswap()  <span class="comment"># the values are always big-endian</span></div>
<div class="line"><span class="lineno">  249</span>        self.quantization[v &amp; 15] = [data[i] <span class="keywordflow">for</span> i <span class="keywordflow">in</span> zigzag_index]</div>
<div class="line"><span class="lineno">  250</span>        s = s[qt_length:]</div>
<div class="line"><span class="lineno">  251</span> </div>
<div class="line"><span class="lineno">  252</span> </div>
<div class="line"><span class="lineno">  253</span><span class="comment">#</span></div>
<div class="line"><span class="lineno">  254</span><span class="comment"># JPEG marker table</span></div>
<div class="line"><span class="lineno">  255</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aff2aa1cda47ff39d51c118a35bdc2f9d" name="aff2aa1cda47ff39d51c118a35bdc2f9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff2aa1cda47ff39d51c118a35bdc2f9d">&#9670;&#160;</a></span>get_sampling()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> int PIL.JpegImagePlugin.get_sampling </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_p_i_l_1_1_image_1_1_image.html">Image.Image</a></td>          <td class="paramname"><span class="paramname"><em>im</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_jpeg_image_plugin_8py_source.html#l00635">635</a> of file <a class="el" href="_jpeg_image_plugin_8py_source.html">JpegImagePlugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  635</span><span class="keyword">def </span>get_sampling(im: Image.Image) -&gt; int:</div>
<div class="line"><span class="lineno">  636</span>    <span class="comment"># There&#39;s no subsampling when images have only 1 layer</span></div>
<div class="line"><span class="lineno">  637</span>    <span class="comment"># (grayscale images) or when they are CMYK (4 layers),</span></div>
<div class="line"><span class="lineno">  638</span>    <span class="comment"># so set subsampling to the default value.</span></div>
<div class="line"><span class="lineno">  639</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno">  640</span>    <span class="comment"># NOTE: currently Pillow can&#39;t encode JPEG to YCCK format.</span></div>
<div class="line"><span class="lineno">  641</span>    <span class="comment"># If YCCK support is added in the future, subsampling code will have</span></div>
<div class="line"><span class="lineno">  642</span>    <span class="comment"># to be updated (here and in JpegEncode.c) to deal with 4 layers.</span></div>
<div class="line"><span class="lineno">  643</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(im, JpegImageFile) <span class="keywordflow">or</span> im.layers <span class="keywordflow">in</span> (1, 4):</div>
<div class="line"><span class="lineno">  644</span>        <span class="keywordflow">return</span> -1</div>
<div class="line"><span class="lineno">  645</span>    sampling = im.layer[0][1:3] + im.layer[1][1:3] + im.layer[2][1:3]</div>
<div class="line"><span class="lineno">  646</span>    <span class="keywordflow">return</span> samplings.get(sampling, -1)</div>
<div class="line"><span class="lineno">  647</span> </div>
<div class="line"><span class="lineno">  648</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="_jpeg_image_plugin_8py_source.html#l00649">_save()</a>.</p>

</div>
</div>
<a id="adaa95fbf8dcde283abb2a9f76142fe90" name="adaa95fbf8dcde283abb2a9f76142fe90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adaa95fbf8dcde283abb2a9f76142fe90">&#9670;&#160;</a></span>jpeg_factory()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> <a class="el" href="class_p_i_l_1_1_jpeg_image_plugin_1_1_jpeg_image_file.html">JpegImageFile</a> | <a class="el" href="class_p_i_l_1_1_mpo_image_plugin_1_1_mpo_image_file.html">MpoImageFile</a> PIL.JpegImagePlugin.jpeg_factory </td>
          <td>(</td>
          <td class="paramtype">IO[bytes]</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str | bytes | None </td>          <td class="paramname"><span class="paramname"><em>filename</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Factory for making JPEG and MPO instances. </p>

<p class="definition">Definition at line <a class="el" href="_jpeg_image_plugin_8py_source.html#l00860">860</a> of file <a class="el" href="_jpeg_image_plugin_8py_source.html">JpegImagePlugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  862</span>) -&gt; JpegImageFile | MpoImageFile:</div>
<div class="line"><span class="lineno">  863</span>    im = JpegImageFile(fp, filename)</div>
<div class="line"><span class="lineno">  864</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  865</span>        mpheader = im._getmp()</div>
<div class="line"><span class="lineno">  866</span>        <span class="keywordflow">if</span> mpheader <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> mpheader[45057] &gt; 1:</div>
<div class="line"><span class="lineno">  867</span>            <span class="keywordflow">for</span> segment, content <span class="keywordflow">in</span> im.applist:</div>
<div class="line"><span class="lineno">  868</span>                <span class="keywordflow">if</span> segment == <span class="stringliteral">&quot;APP1&quot;</span> <span class="keywordflow">and</span> b<span class="stringliteral">&#39; hdrgm:Version=&quot;&#39;</span> <span class="keywordflow">in</span> content:</div>
<div class="line"><span class="lineno">  869</span>                    <span class="comment"># Ultra HDR images are not yet supported</span></div>
<div class="line"><span class="lineno">  870</span>                    <span class="keywordflow">return</span> im</div>
<div class="line"><span class="lineno">  871</span>            <span class="comment"># It&#39;s actually an MPO</span></div>
<div class="line"><span class="lineno">  872</span>            <span class="keyword">from</span> .MpoImagePlugin <span class="keyword">import</span> MpoImageFile</div>
<div class="line"><span class="lineno">  873</span> </div>
<div class="line"><span class="lineno">  874</span>            <span class="comment"># Don&#39;t reload everything, just convert it.</span></div>
<div class="line"><span class="lineno">  875</span>            im = MpoImageFile.adopt(im, mpheader)</div>
<div class="line"><span class="lineno">  876</span>    <span class="keywordflow">except</span> (TypeError, IndexError):</div>
<div class="line"><span class="lineno">  877</span>        <span class="comment"># It is really a JPEG</span></div>
<div class="line"><span class="lineno">  878</span>        <span class="keywordflow">pass</span></div>
<div class="line"><span class="lineno">  879</span>    <span class="keywordflow">except</span> SyntaxError:</div>
<div class="line"><span class="lineno">  880</span>        warnings.warn(</div>
<div class="line"><span class="lineno">  881</span>            <span class="stringliteral">&quot;Image appears to be a malformed MPO file, it will be &quot;</span></div>
<div class="line"><span class="lineno">  882</span>            <span class="stringliteral">&quot;interpreted as a base JPEG file&quot;</span></div>
<div class="line"><span class="lineno">  883</span>        )</div>
<div class="line"><span class="lineno">  884</span>    <span class="keywordflow">return</span> im</div>
<div class="line"><span class="lineno">  885</span> </div>
<div class="line"><span class="lineno">  886</span> </div>
<div class="line"><span class="lineno">  887</span><span class="comment"># ---------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  888</span><span class="comment"># Registry stuff</span></div>
<div class="line"><span class="lineno">  889</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="afe15a3c3f72a567a64108675f1664b87" name="afe15a3c3f72a567a64108675f1664b87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe15a3c3f72a567a64108675f1664b87">&#9670;&#160;</a></span>Skip()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None PIL.JpegImagePlugin.Skip </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_p_i_l_1_1_jpeg_image_plugin_1_1_jpeg_image_file.html">JpegImageFile</a></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>marker</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_jpeg_image_plugin_8py_source.html#l00062">62</a> of file <a class="el" href="_jpeg_image_plugin_8py_source.html">JpegImagePlugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   62</span><span class="keyword">def </span>Skip(self: JpegImageFile, marker: int) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">   63</span>    n = i16(self.fp.read(2)) - 2</div>
<div class="line"><span class="lineno">   64</span>    ImageFile._safe_read(self.fp, n)</div>
<div class="line"><span class="lineno">   65</span> </div>
<div class="line"><span class="lineno">   66</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a89e7f8788da7ed2ab1c96db5864cee11" name="a89e7f8788da7ed2ab1c96db5864cee11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89e7f8788da7ed2ab1c96db5864cee11">&#9670;&#160;</a></span>SOF()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None PIL.JpegImagePlugin.SOF </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_p_i_l_1_1_jpeg_image_plugin_1_1_jpeg_image_file.html">JpegImageFile</a></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>marker</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_jpeg_image_plugin_8py_source.html#l00181">181</a> of file <a class="el" href="_jpeg_image_plugin_8py_source.html">JpegImagePlugin.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  181</span><span class="keyword">def </span>SOF(self: JpegImageFile, marker: int) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  182</span>    <span class="comment">#</span></div>
<div class="line"><span class="lineno">  183</span>    <span class="comment"># Start of frame marker.  Defines the size and mode of the</span></div>
<div class="line"><span class="lineno">  184</span>    <span class="comment"># image.  JPEG is colour blind, so we use some simple</span></div>
<div class="line"><span class="lineno">  185</span>    <span class="comment"># heuristics to map the number of layers to an appropriate</span></div>
<div class="line"><span class="lineno">  186</span>    <span class="comment"># mode.  Note that this could be made a bit brighter, by</span></div>
<div class="line"><span class="lineno">  187</span>    <span class="comment"># looking for JFIF and Adobe APP markers.</span></div>
<div class="line"><span class="lineno">  188</span> </div>
<div class="line"><span class="lineno">  189</span>    n = i16(self.fp.read(2)) - 2</div>
<div class="line"><span class="lineno">  190</span>    s = ImageFile._safe_read(self.fp, n)</div>
<div class="line"><span class="lineno">  191</span>    self._size = i16(s, 3), i16(s, 1)</div>
<div class="line"><span class="lineno">  192</span> </div>
<div class="line"><span class="lineno">  193</span>    self.bits = s[0]</div>
<div class="line"><span class="lineno">  194</span>    <span class="keywordflow">if</span> self.bits != 8:</div>
<div class="line"><span class="lineno">  195</span>        msg = f<span class="stringliteral">&quot;cannot handle {self.bits}-bit layers&quot;</span></div>
<div class="line"><span class="lineno">  196</span>        <span class="keywordflow">raise</span> SyntaxError(msg)</div>
<div class="line"><span class="lineno">  197</span> </div>
<div class="line"><span class="lineno">  198</span>    self.layers = s[5]</div>
<div class="line"><span class="lineno">  199</span>    <span class="keywordflow">if</span> self.layers == 1:</div>
<div class="line"><span class="lineno">  200</span>        self._mode = <span class="stringliteral">&quot;L&quot;</span></div>
<div class="line"><span class="lineno">  201</span>    <span class="keywordflow">elif</span> self.layers == 3:</div>
<div class="line"><span class="lineno">  202</span>        self._mode = <span class="stringliteral">&quot;RGB&quot;</span></div>
<div class="line"><span class="lineno">  203</span>    <span class="keywordflow">elif</span> self.layers == 4:</div>
<div class="line"><span class="lineno">  204</span>        self._mode = <span class="stringliteral">&quot;CMYK&quot;</span></div>
<div class="line"><span class="lineno">  205</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  206</span>        msg = f<span class="stringliteral">&quot;cannot handle {self.layers}-layer images&quot;</span></div>
<div class="line"><span class="lineno">  207</span>        <span class="keywordflow">raise</span> SyntaxError(msg)</div>
<div class="line"><span class="lineno">  208</span> </div>
<div class="line"><span class="lineno">  209</span>    <span class="keywordflow">if</span> marker <span class="keywordflow">in</span> [0xFFC2, 0xFFC6, 0xFFCA, 0xFFCE]:</div>
<div class="line"><span class="lineno">  210</span>        self.info[<span class="stringliteral">&quot;progressive&quot;</span>] = self.info[<span class="stringliteral">&quot;progression&quot;</span>] = 1</div>
<div class="line"><span class="lineno">  211</span> </div>
<div class="line"><span class="lineno">  212</span>    <span class="keywordflow">if</span> self.icclist:</div>
<div class="line"><span class="lineno">  213</span>        <span class="comment"># fixup icc profile</span></div>
<div class="line"><span class="lineno">  214</span>        self.icclist.sort()  <span class="comment"># sort by sequence number</span></div>
<div class="line"><span class="lineno">  215</span>        <span class="keywordflow">if</span> self.icclist[0][13] == len(self.icclist):</div>
<div class="line"><span class="lineno">  216</span>            profile = [p[14:] <span class="keywordflow">for</span> p <span class="keywordflow">in</span> self.icclist]</div>
<div class="line"><span class="lineno">  217</span>            icc_profile = b<span class="stringliteral">&quot;&quot;</span>.join(profile)</div>
<div class="line"><span class="lineno">  218</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  219</span>            icc_profile = <span class="keywordtype">None</span>  <span class="comment"># wrong number of fragments</span></div>
<div class="line"><span class="lineno">  220</span>        self.info[<span class="stringliteral">&quot;icc_profile&quot;</span>] = icc_profile</div>
<div class="line"><span class="lineno">  221</span>        self.icclist = []</div>
<div class="line"><span class="lineno">  222</span> </div>
<div class="line"><span class="lineno">  223</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(6, len(s), 3):</div>
<div class="line"><span class="lineno">  224</span>        t = s[i : i + 3]</div>
<div class="line"><span class="lineno">  225</span>        <span class="comment"># 4-tuples: id, vsamp, hsamp, qtable</span></div>
<div class="line"><span class="lineno">  226</span>        self.layer.append((t[0], t[1] // 16, t[1] &amp; 15, t[2]))</div>
<div class="line"><span class="lineno">  227</span> </div>
<div class="line"><span class="lineno">  228</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a92799851a2c617a51da1a0b7965a70a0" name="a92799851a2c617a51da1a0b7965a70a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92799851a2c617a51da1a0b7965a70a0">&#9670;&#160;</a></span>_exif_offset</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int PIL.JpegImagePlugin._exif_offset = self.fp.tell() - n + 6</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_jpeg_image_plugin_8py_source.html#l00101">101</a> of file <a class="el" href="_jpeg_image_plugin_8py_source.html">JpegImagePlugin.py</a>.</p>

</div>
</div>
<a id="af6ae54d57ff5bc6a00b78887e01ae83f" name="af6ae54d57ff5bc6a00b78887e01ae83f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6ae54d57ff5bc6a00b78887e01ae83f">&#9670;&#160;</a></span>_mode</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">str PIL.JpegImagePlugin._mode = &quot;L&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_jpeg_image_plugin_8py_source.html#l00200">200</a> of file <a class="el" href="_jpeg_image_plugin_8py_source.html">JpegImagePlugin.py</a>.</p>

</div>
</div>
<a id="a456375d0b35ab014bd7158bbfda703eb" name="a456375d0b35ab014bd7158bbfda703eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a456375d0b35ab014bd7158bbfda703eb">&#9670;&#160;</a></span>_size</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PIL.JpegImagePlugin._size = i16(s, 3), i16(s, 1)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_jpeg_image_plugin_8py_source.html#l00191">191</a> of file <a class="el" href="_jpeg_image_plugin_8py_source.html">JpegImagePlugin.py</a>.</p>

</div>
</div>
<a id="acfc8adc0e5df82d6c92e3ff83b6321f5" name="acfc8adc0e5df82d6c92e3ff83b6321f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfc8adc0e5df82d6c92e3ff83b6321f5">&#9670;&#160;</a></span>bits</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PIL.JpegImagePlugin.bits = s[0]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_jpeg_image_plugin_8py_source.html#l00193">193</a> of file <a class="el" href="_jpeg_image_plugin_8py_source.html">JpegImagePlugin.py</a>.</p>

</div>
</div>
<a id="afbb81958534085c78a999abdb1ed0665" name="afbb81958534085c78a999abdb1ed0665"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbb81958534085c78a999abdb1ed0665">&#9670;&#160;</a></span>fp</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PIL.JpegImagePlugin.fp</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_jpeg_image_plugin_8py_source.html#l00064">64</a> of file <a class="el" href="_jpeg_image_plugin_8py_source.html">JpegImagePlugin.py</a>.</p>

</div>
</div>
<a id="a47a254d76d58cbef017fed2014f3cf45" name="a47a254d76d58cbef017fed2014f3cf45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47a254d76d58cbef017fed2014f3cf45">&#9670;&#160;</a></span>icclist</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">list PIL.JpegImagePlugin.icclist = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_jpeg_image_plugin_8py_source.html#l00212">212</a> of file <a class="el" href="_jpeg_image_plugin_8py_source.html">JpegImagePlugin.py</a>.</p>

</div>
</div>
<a id="a40b92cd4a9c45da7b56686a3cc519624" name="a40b92cd4a9c45da7b56686a3cc519624"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40b92cd4a9c45da7b56686a3cc519624">&#9670;&#160;</a></span>info</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PIL.JpegImagePlugin.info</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_jpeg_image_plugin_8py_source.html#l00097">97</a> of file <a class="el" href="_jpeg_image_plugin_8py_source.html">JpegImagePlugin.py</a>.</p>

</div>
</div>
<a id="a6a22d7065c3cc02c4c1f03cfe0a5b8c4" name="a6a22d7065c3cc02c4c1f03cfe0a5b8c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a22d7065c3cc02c4c1f03cfe0a5b8c4">&#9670;&#160;</a></span>layers</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int PIL.JpegImagePlugin.layers = s[5]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_jpeg_image_plugin_8py_source.html#l00198">198</a> of file <a class="el" href="_jpeg_image_plugin_8py_source.html">JpegImagePlugin.py</a>.</p>

</div>
</div>
<a id="a3b27b9d942b836a660aa4a35e3cc72c9" name="a3b27b9d942b836a660aa4a35e3cc72c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b27b9d942b836a660aa4a35e3cc72c9">&#9670;&#160;</a></span>MARKER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dict PIL.JpegImagePlugin.MARKER</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_jpeg_image_plugin_8py_source.html#l00256">256</a> of file <a class="el" href="_jpeg_image_plugin_8py_source.html">JpegImagePlugin.py</a>.</p>

</div>
</div>
<a id="a1d2046bc6df6ca9276d643df706f0aa9" name="a1d2046bc6df6ca9276d643df706f0aa9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d2046bc6df6ca9276d643df706f0aa9">&#9670;&#160;</a></span>RAWMODE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dict PIL.JpegImagePlugin.RAWMODE</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  {</div>
<div class="line"><span class="lineno">    2</span>    <span class="stringliteral">&quot;1&quot;</span>: <span class="stringliteral">&quot;L&quot;</span>,</div>
<div class="line"><span class="lineno">    3</span>    <span class="stringliteral">&quot;L&quot;</span>: <span class="stringliteral">&quot;L&quot;</span>,</div>
<div class="line"><span class="lineno">    4</span>    <span class="stringliteral">&quot;RGB&quot;</span>: <span class="stringliteral">&quot;RGB&quot;</span>,</div>
<div class="line"><span class="lineno">    5</span>    <span class="stringliteral">&quot;RGBX&quot;</span>: <span class="stringliteral">&quot;RGB&quot;</span>,</div>
<div class="line"><span class="lineno">    6</span>    <span class="stringliteral">&quot;CMYK&quot;</span>: <span class="stringliteral">&quot;CMYK;I&quot;</span>,  <span class="comment"># assume adobe conventions</span></div>
<div class="line"><span class="lineno">    7</span>    <span class="stringliteral">&quot;YCbCr&quot;</span>: <span class="stringliteral">&quot;YCbCr&quot;</span>,</div>
<div class="line"><span class="lineno">    8</span>}</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="_jpeg_image_plugin_8py_source.html#l00606">606</a> of file <a class="el" href="_jpeg_image_plugin_8py_source.html">JpegImagePlugin.py</a>.</p>

</div>
</div>
<a id="a1bbc666db1d7d40d2f46edf4049b206b" name="a1bbc666db1d7d40d2f46edf4049b206b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1bbc666db1d7d40d2f46edf4049b206b">&#9670;&#160;</a></span>samplings</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dict PIL.JpegImagePlugin.samplings</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  {</div>
<div class="line"><span class="lineno">    2</span>    (1, 1, 1, 1, 1, 1): 0,</div>
<div class="line"><span class="lineno">    3</span>    (2, 1, 1, 1, 1, 1): 1,</div>
<div class="line"><span class="lineno">    4</span>    (2, 2, 1, 1, 1, 1): 2,</div>
<div class="line"><span class="lineno">    5</span>}</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="_jpeg_image_plugin_8py_source.html#l00627">627</a> of file <a class="el" href="_jpeg_image_plugin_8py_source.html">JpegImagePlugin.py</a>.</p>

</div>
</div>
<a id="a5c522eff72189a902699b7f7a812696d" name="a5c522eff72189a902699b7f7a812696d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c522eff72189a902699b7f7a812696d">&#9670;&#160;</a></span>zigzag_index</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">tuple PIL.JpegImagePlugin.zigzag_index</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  (</div>
<div class="line"><span class="lineno">    2</span>    0,  1,  5,  6, 14, 15, 27, 28,</div>
<div class="line"><span class="lineno">    3</span>    2,  4,  7, 13, 16, 26, 29, 42,</div>
<div class="line"><span class="lineno">    4</span>    3,  8, 12, 17, 25, 30, 41, 43,</div>
<div class="line"><span class="lineno">    5</span>    9, 11, 18, 24, 31, 40, 44, 53,</div>
<div class="line"><span class="lineno">    6</span>    10, 19, 23, 32, 39, 45, 52, 54,</div>
<div class="line"><span class="lineno">    7</span>    20, 22, 33, 38, 46, 51, 55, 60,</div>
<div class="line"><span class="lineno">    8</span>    21, 34, 37, 47, 50, 56, 59, 61,</div>
<div class="line"><span class="lineno">    9</span>    35, 36, 48, 49, 57, 58, 62, 63,</div>
<div class="line"><span class="lineno">   10</span>)</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="_jpeg_image_plugin_8py_source.html#l00616">616</a> of file <a class="el" href="_jpeg_image_plugin_8py_source.html">JpegImagePlugin.py</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespace_p_i_l.html">PIL</a></li><li class="navelem"><a class="el" href="namespace_p_i_l_1_1_jpeg_image_plugin.html">JpegImagePlugin</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
