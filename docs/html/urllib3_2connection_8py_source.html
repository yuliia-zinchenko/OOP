<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Read&amp;Watch: project/ENV/Lib/site-packages/urllib3/connection.py Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Read&amp;Watch<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('urllib3_2connection_8py_source.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">connection.py</div></div>
</div><!--header-->
<div class="contents">
<a href="urllib3_2connection_8py.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno"><a class="line" href="namespaceurllib3_1_1connection.html">    1</a></span><span class="keyword">from</span> __future__ <span class="keyword">import</span> annotations</div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span> </div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="keyword">import</span> datetime</div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="keyword">import</span> http.client</div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="keyword">import</span> logging</div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="keyword">import</span> os</div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="keyword">import</span> re</div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="keyword">import</span> socket</div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="keyword">import</span> sys</div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="keyword">import</span> threading</div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="keyword">import</span> typing</div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="keyword">import</span> warnings</div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="keyword">from</span> http.client <span class="keyword">import</span> HTTPConnection <span class="keyword">as</span> _HTTPConnection</div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="keyword">from</span> http.client <span class="keyword">import</span> HTTPException <span class="keyword">as</span> HTTPException  <span class="comment"># noqa: F401</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="keyword">from</span> http.client <span class="keyword">import</span> ResponseNotReady</div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="keyword">from</span> socket <span class="keyword">import</span> timeout <span class="keyword">as</span> SocketTimeout</div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span> </div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="keywordflow">if</span> typing.TYPE_CHECKING:</div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span>    <span class="keyword">from</span> .response <span class="keyword">import</span> HTTPResponse</div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span>    <span class="keyword">from</span> .util.ssl_ <span class="keyword">import</span> _TYPE_PEER_CERT_RET_DICT</div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span>    <span class="keyword">from</span> .util.ssltransport <span class="keyword">import</span> SSLTransport</div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span> </div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="keyword">from</span> ._collections <span class="keyword">import</span> HTTPHeaderDict</div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="keyword">from</span> .http2 <span class="keyword">import</span> probe <span class="keyword">as</span> http2_probe</div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="keyword">from</span> .util.response <span class="keyword">import</span> assert_header_parsing</div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="keyword">from</span> .util.timeout <span class="keyword">import</span> _DEFAULT_TIMEOUT, _TYPE_TIMEOUT, Timeout</div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="keyword">from</span> .util.util <span class="keyword">import</span> to_str</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="keyword">from</span> .util.wait <span class="keyword">import</span> wait_for_read</div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span> </div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="keywordflow">try</span>:  <span class="comment"># Compiled with SSL?</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span>    <span class="keyword">import</span> ssl</div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span> </div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno"><a class="line" href="namespaceurllib3_1_1connection.html#a24df56ff6559af80ba44f7c32d971920">   33</a></span>    BaseSSLError = ssl.SSLError</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="keywordflow">except</span> (ImportError, AttributeError):</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno"><a class="line" href="namespaceurllib3_1_1connection.html#ab714463a1adda171bf29a2d78eb552c2">   35</a></span>    ssl = <span class="keywordtype">None</span>  <span class="comment"># type: ignore[assignment]</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span> </div>
<div class="foldopen" id="foldopen00037" data-start="" data-end="">
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_base_s_s_l_error.html">   37</a></span>    <span class="keyword">class </span><a class="code hl_class" href="classurllib3_1_1connection_1_1_base_s_s_l_error.html">BaseSSLError</a>(BaseException):  <span class="comment"># type: ignore[no-redef]</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>        <span class="keywordflow">pass</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span> </div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span> </div>
</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="keyword">from</span> ._base_connection <span class="keyword">import</span> _TYPE_BODY</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span><span class="keyword">from</span> ._base_connection <span class="keyword">import</span> ProxyConfig <span class="keyword">as</span> ProxyConfig</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span><span class="keyword">from</span> ._base_connection <span class="keyword">import</span> _ResponseOptions <span class="keyword">as</span> _ResponseOptions</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span><span class="keyword">from</span> ._version <span class="keyword">import</span> __version__</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span><span class="keyword">from</span> .exceptions <span class="keyword">import</span> (</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>    ConnectTimeoutError,</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>    HeaderParsingError,</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>    NameResolutionError,</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>    NewConnectionError,</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>    ProxyError,</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>    SystemTimeWarning,</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>)</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span><span class="keyword">from</span> .util <span class="keyword">import</span> SKIP_HEADER, SKIPPABLE_HEADERS, connection, ssl_</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span><span class="keyword">from</span> .util.request <span class="keyword">import</span> body_to_chunks</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span><span class="keyword">from</span> .util.ssl_ <span class="keyword">import</span> assert_fingerprint <span class="keyword">as</span> _assert_fingerprint</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span><span class="keyword">from</span> .util.ssl_ <span class="keyword">import</span> (</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>    create_urllib3_context,</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>    is_ipaddress,</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>    resolve_cert_reqs,</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>    resolve_ssl_version,</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>    ssl_wrap_socket,</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>)</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span><span class="keyword">from</span> .util.ssl_match_hostname <span class="keyword">import</span> CertificateError, match_hostname</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span><span class="keyword">from</span> .util.url <span class="keyword">import</span> Url</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span> </div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span><span class="comment"># Not a no-op, we&#39;re adding this to the namespace so it can be imported.</span></div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno"><a class="line" href="namespaceurllib3_1_1connection.html#aefd220f86f2ca9170aecb3b7a6d0a4e7">   67</a></span>ConnectionError = ConnectionError</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno"><a class="line" href="namespaceurllib3_1_1connection.html#afd47037a4ea06c01f59661b4d7ff8037">   68</a></span>BrokenPipeError = BrokenPipeError</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span> </div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span> </div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno"><a class="line" href="namespaceurllib3_1_1connection.html#aed1e4dbc4bfbd35381824454c1b4664e">   71</a></span>log = logging.getLogger(__name__)</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span> </div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno"><a class="line" href="namespaceurllib3_1_1connection.html#ac7c58106547bc5721e67be84e8d88a5b">   73</a></span>port_by_scheme = {<span class="stringliteral">&quot;http&quot;</span>: 80, <span class="stringliteral">&quot;https&quot;</span>: 443}</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span> </div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span><span class="comment"># When it comes time to update this value as a part of regular maintenance</span></div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span><span class="comment"># (ie test_recent_date is failing) update it to ~6 months before the current date.</span></div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno"><a class="line" href="namespaceurllib3_1_1connection.html#a0d4f8e0ac03d437ec09f51802c685b6a">   77</a></span>RECENT_DATE = datetime.date(2023, 6, 1)</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span> </div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno"><a class="line" href="namespaceurllib3_1_1connection.html#a0c47ea7f7a34323c0983aedf4ad3e9a6">   79</a></span>_CONTAINS_CONTROL_CHAR_RE = re.compile(<span class="stringliteral">r&quot;[^-!#$%&amp;&#39;*+.^_`|~0-9a-zA-Z]&quot;</span>)</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span> </div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno"><a class="line" href="namespaceurllib3_1_1connection.html#a35f20effa6a1bae5bca2e0e7d5635602">   81</a></span>_HAS_SYS_AUDIT = hasattr(sys, <span class="stringliteral">&quot;audit&quot;</span>)</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span> </div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span> </div>
<div class="foldopen" id="foldopen00084" data-start="" data-end="">
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html">   84</a></span><span class="keyword">class </span><a class="code hl_class" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html">HTTPConnection</a>(_HTTPConnection):</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span><span class="stringliteral">    Based on :class:`http.client.HTTPConnection` but provides an extra constructor</span></div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span><span class="stringliteral">    backwards-compatibility layer between older and newer Pythons.</span></div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span><span class="stringliteral"></span> </div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span><span class="stringliteral">    Additional keyword parameters are used to configure attributes of the connection.</span></div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span><span class="stringliteral">    Accepted parameters include:</span></div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span><span class="stringliteral"></span> </div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span><span class="stringliteral">    - ``source_address``: Set the source address for the current connection.</span></div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span><span class="stringliteral">    - ``socket_options``: Set specific options on the underlying socket. If not specified, then</span></div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span><span class="stringliteral">      defaults are loaded from ``HTTPConnection.default_socket_options`` which includes disabling</span></div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span><span class="stringliteral">      Nagle&#39;s algorithm (sets TCP_NODELAY to 1) unless the connection is behind a proxy.</span></div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span><span class="stringliteral"></span> </div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span><span class="stringliteral">      For example, if you wish to enable TCP Keep Alive in addition to the defaults,</span></div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span><span class="stringliteral">      you might pass:</span></div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span><span class="stringliteral"></span> </div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span><span class="stringliteral">      .. code-block:: python</span></div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span><span class="stringliteral"></span> </div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span><span class="stringliteral">         HTTPConnection.default_socket_options + [</span></div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span><span class="stringliteral">             (socket.SOL_SOCKET, socket.SO_KEEPALIVE, 1),</span></div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span><span class="stringliteral">         ]</span></div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span><span class="stringliteral"></span> </div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span><span class="stringliteral">      Or you may want to disable the defaults by passing an empty list (e.g., ``[]``).</span></div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span> </div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#afcc2a54dfedb1a36015224fa29863ba9">  109</a></span>    default_port: typing.ClassVar[int] = port_by_scheme[<span class="stringliteral">&quot;http&quot;</span>]  <span class="comment"># type: ignore[misc]</span></div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span> </div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>    <span class="comment">#: Disable Nagle&#39;s algorithm by default.</span></div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>    <span class="comment">#: ``[(socket.IPPROTO_TCP, socket.TCP_NODELAY, 1)]``</span></div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#aa896bac6778f24b7a73226638ab8f97c">  113</a></span>    default_socket_options: typing.ClassVar[connection._TYPE_SOCKET_OPTIONS] = [</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>        (socket.IPPROTO_TCP, socket.TCP_NODELAY, 1)</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>    ]</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span> </div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>    <span class="comment">#: Whether this connection verifies the host&#39;s certificate.</span></div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#ab2024bc528bed4d7ad133e14942968e7">  118</a></span>    is_verified: bool = <span class="keyword">False</span></div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span> </div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>    <span class="comment">#: Whether this proxy connection verified the proxy host&#39;s certificate.</span></div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>    <span class="comment"># If no proxy is currently connected to the value will be ``None``.</span></div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#ad67213dfc08ca8483cf0ca6c553f673c">  122</a></span>    proxy_is_verified: bool | <span class="keywordtype">None</span> = <span class="keywordtype">None</span></div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span> </div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>    blocksize: int</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a33d5752e3a0c43884cd55119c3e86319">  125</a></span>    source_address: tuple[str, int] | <span class="keywordtype">None</span></div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a069610759fc064f1c752d6db69505bf9">  126</a></span>    socket_options: connection._TYPE_SOCKET_OPTIONS | <span class="keywordtype">None</span></div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span> </div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>    _has_connected_to_proxy: bool</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a32ff1302772ff6496fad96dfdeb9b2e2">  129</a></span>    _response_options: _ResponseOptions | <span class="keywordtype">None</span></div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#ac62b9b5e5c739db48b12215dece40edc">  130</a></span>    _tunnel_host: str | <span class="keywordtype">None</span></div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a70a25a4b5bb68d6fe038a6b563efe3fd">  131</a></span>    _tunnel_port: int | <span class="keywordtype">None</span></div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a4ae38e1d4616fbebdd79638d84be469f">  132</a></span>    _tunnel_scheme: str | <span class="keywordtype">None</span></div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span> </div>
<div class="foldopen" id="foldopen00134" data-start="" data-end="">
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#abf44329ead690242cb73c3bb4accbc8e">  134</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#abf44329ead690242cb73c3bb4accbc8e">__init__</a>(</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>        self,</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>        host: str,</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>        port: int | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>        *,</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>        timeout: _TYPE_TIMEOUT = _DEFAULT_TIMEOUT,</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>        source_address: tuple[str, int] | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>        blocksize: int = 16384,</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>        socket_options: <span class="keywordtype">None</span></div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>        | (connection._TYPE_SOCKET_OPTIONS) = default_socket_options,</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>        proxy: Url | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>        proxy_config: ProxyConfig | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>    ) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>        super().<a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#abf44329ead690242cb73c3bb4accbc8e">__init__</a>(</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>            host=host,</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>            port=port,</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>            timeout=Timeout.resolve_default_timeout(timeout),</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>            source_address=source_address,</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>            blocksize=blocksize,</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>        )</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a069610759fc064f1c752d6db69505bf9">socket_options</a> = socket_options</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a138f40e175e42ae521bbe2d0f6d9d9c6">  155</a></span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a138f40e175e42ae521bbe2d0f6d9d9c6">proxy</a> = proxy</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#acb69d5766717630021f67595c141178d">  156</a></span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#acb69d5766717630021f67595c141178d">proxy_config</a> = proxy_config</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span> </div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a3577c782aacf3b5ec02fe3a3e33be7cf">  158</a></span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a3577c782aacf3b5ec02fe3a3e33be7cf">_has_connected_to_proxy</a> = <span class="keyword">False</span></div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a32ff1302772ff6496fad96dfdeb9b2e2">_response_options</a> = <span class="keywordtype">None</span></div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#ac62b9b5e5c739db48b12215dece40edc">_tunnel_host</a>: str | <span class="keywordtype">None</span> = <span class="keywordtype">None</span></div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a70a25a4b5bb68d6fe038a6b563efe3fd">_tunnel_port</a>: int | <span class="keywordtype">None</span> = <span class="keywordtype">None</span></div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a4ae38e1d4616fbebdd79638d84be469f">_tunnel_scheme</a>: str | <span class="keywordtype">None</span> = <span class="keywordtype">None</span></div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span> </div>
</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>    <span class="preprocessor">@property</span></div>
<div class="foldopen" id="foldopen00165" data-start="" data-end="">
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a126905c04798cc422a4a4163aa3271b0">  165</a></span>    <span class="keyword">def </span><a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a6adcc2d915be7a8b571ee3f40198c00d">host</a>(self) -&gt; str:</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span><span class="stringliteral">        Getter method to remove any trailing dots that indicate the hostname is an FQDN.</span></div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span><span class="stringliteral"></span> </div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span><span class="stringliteral">        In general, SSL certificates don&#39;t include the trailing dot indicating a</span></div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span><span class="stringliteral">        fully-qualified domain name, and thus, they don&#39;t validate properly when</span></div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span><span class="stringliteral">        checked against a domain name that includes the dot. In addition, some</span></div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span><span class="stringliteral">        servers may not expect to receive the trailing dot when provided.</span></div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span><span class="stringliteral"></span> </div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span><span class="stringliteral">        However, the hostname with trailing dot is critical to DNS resolution; doing a</span></div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span><span class="stringliteral">        lookup with the trailing dot will properly only resolve the appropriate FQDN,</span></div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span><span class="stringliteral">        whereas a lookup without a trailing dot will search the system&#39;s search domain</span></div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span><span class="stringliteral">        list. Thus, it&#39;s important to keep the original host around for use only in</span></div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span><span class="stringliteral">        those cases where it&#39;s appropriate (i.e., when doing DNS lookup to establish the</span></div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span><span class="stringliteral">        actual TCP connection across which we&#39;re going to send HTTP requests).</span></div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>        <span class="keywordflow">return</span> self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a09dc1873bf231d71d622071c6af6e732">_dns_host</a>.rstrip(<span class="stringliteral">&quot;.&quot;</span>)</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span> </div>
</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>    <span class="preprocessor">@host.setter</span></div>
<div class="foldopen" id="foldopen00184" data-start="" data-end="">
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a4460a072c3fb1e5404c27e797823367f">  184</a></span>    <span class="keyword">def </span><a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a6adcc2d915be7a8b571ee3f40198c00d">host</a>(self, value: str) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span><span class="stringliteral">        Setter for the `host` property.</span></div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span><span class="stringliteral"></span> </div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span><span class="stringliteral">        We assume that only urllib3 uses the _dns_host attribute; httplib itself</span></div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span><span class="stringliteral">        only uses `host`, and it seems reasonable that other libraries follow suit.</span></div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a09dc1873bf231d71d622071c6af6e732">  191</a></span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a09dc1873bf231d71d622071c6af6e732">_dns_host</a> = value</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span> </div>
</div>
<div class="foldopen" id="foldopen00193" data-start="" data-end="">
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#adef2aa29d40b8252a2abc8cdf3b8c33f">  193</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#adef2aa29d40b8252a2abc8cdf3b8c33f">_new_conn</a>(self) -&gt; socket.socket:</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>        <span class="stringliteral">&quot;&quot;&quot;Establish a socket connection and set nodelay settings on it.</span></div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span><span class="stringliteral"></span> </div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span><span class="stringliteral">        :return: New socket connection.</span></div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>            sock = connection.create_connection(</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>                (self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a09dc1873bf231d71d622071c6af6e732">_dns_host</a>, self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a67806327cbd2db96731f201ab7548f41">port</a>),</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>                self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a225e4b3774685481ebe57be464057f13">timeout</a>,</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>                source_address=self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a33d5752e3a0c43884cd55119c3e86319">source_address</a>,</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>                socket_options=self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a069610759fc064f1c752d6db69505bf9">socket_options</a>,</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>            )</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>        <span class="keywordflow">except</span> socket.gaierror <span class="keyword">as</span> e:</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a6adcc2d915be7a8b571ee3f40198c00d">  206</a></span>            <span class="keywordflow">raise</span> <a class="code hl_class" href="classurllib3_1_1exceptions_1_1_name_resolution_error.html">NameResolutionError</a>(self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a6adcc2d915be7a8b571ee3f40198c00d">host</a>, self, e) <span class="keyword">from</span> e</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>        <span class="keywordflow">except</span> SocketTimeout <span class="keyword">as</span> e:</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>            <span class="keywordflow">raise</span> <a class="code hl_class" href="classurllib3_1_1exceptions_1_1_connect_timeout_error.html">ConnectTimeoutError</a>(</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>                self,</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>                f<span class="stringliteral">&quot;Connection to {self.host} timed out. (connect timeout={self.timeout})&quot;</span>,</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>            ) <span class="keyword">from</span> e</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span> </div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>        <span class="keywordflow">except</span> OSError <span class="keyword">as</span> e:</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>            <span class="keywordflow">raise</span> <a class="code hl_class" href="classurllib3_1_1exceptions_1_1_new_connection_error.html">NewConnectionError</a>(</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>                self, f<span class="stringliteral">&quot;Failed to establish a new connection: {e}&quot;</span></div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>            ) <span class="keyword">from</span> e</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span> </div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>        <span class="comment"># Audit hooks are only available in Python 3.8+</span></div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>        <span class="keywordflow">if</span> _HAS_SYS_AUDIT:</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a67806327cbd2db96731f201ab7548f41">  220</a></span>            sys.audit(<span class="stringliteral">&quot;http.client.connect&quot;</span>, self, self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a6adcc2d915be7a8b571ee3f40198c00d">host</a>, self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a67806327cbd2db96731f201ab7548f41">port</a>)</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span> </div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>        <span class="keywordflow">return</span> sock</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span> </div>
</div>
<div class="foldopen" id="foldopen00224" data-start="" data-end="">
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a7a2bf829d9093cda2fe52c53d5d7dde0">  224</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a7a2bf829d9093cda2fe52c53d5d7dde0">set_tunnel</a>(</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>        self,</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>        host: str,</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>        port: int | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>        headers: typing.Mapping[str, str] | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>        scheme: str = <span class="stringliteral">&quot;http&quot;</span>,</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>    ) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>        <span class="keywordflow">if</span> scheme <span class="keywordflow">not</span> <span class="keywordflow">in</span> (<span class="stringliteral">&quot;http&quot;</span>, <span class="stringliteral">&quot;https&quot;</span>):</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>            <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>                f<span class="stringliteral">&quot;Invalid proxy scheme for tunneling: {scheme!r}, must be either &#39;http&#39; or &#39;https&#39;&quot;</span></div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>            )</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>        super().<a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a7a2bf829d9093cda2fe52c53d5d7dde0">set_tunnel</a>(host, port=port, headers=headers)</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a4ae38e1d4616fbebdd79638d84be469f">_tunnel_scheme</a> = scheme</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span> </div>
</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>    <span class="keywordflow">if</span> sys.version_info &lt; (3, 11, 4):</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span> </div>
<div class="foldopen" id="foldopen00240" data-start="" data-end="">
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#ad9558b239d5382b6116b120e2ae1aceb">  240</a></span>        <span class="keyword">def </span><a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#ad9558b239d5382b6116b120e2ae1aceb">_tunnel</a>(self) -&gt; None:</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>            _MAXLINE = http.client._MAXLINE  <span class="comment"># type: ignore[attr-defined]</span></div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>            connect = b<span class="stringliteral">&quot;CONNECT %s:%d HTTP/1.0\r\n&quot;</span> % (  <span class="comment"># type: ignore[str-format]</span></div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>                self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#ac62b9b5e5c739db48b12215dece40edc">_tunnel_host</a>.encode(<span class="stringliteral">&quot;ascii&quot;</span>),  <span class="comment"># type: ignore[union-attr]</span></div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>                self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a70a25a4b5bb68d6fe038a6b563efe3fd">_tunnel_port</a>,</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>            )</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>            headers = [connect]</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>            <span class="keywordflow">for</span> header, value <span class="keywordflow">in</span> self._tunnel_headers.items():  <span class="comment"># type: ignore[attr-defined]</span></div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>                headers.append(f<span class="stringliteral">&quot;{header}: {value}\r\n&quot;</span>.encode(<span class="stringliteral">&quot;latin-1&quot;</span>))</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>            headers.append(b<span class="stringliteral">&quot;\r\n&quot;</span>)</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>            <span class="comment"># Making a single send() call instead of one per line encourages</span></div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>            <span class="comment"># the host OS to use a more optimal packet size instead of</span></div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>            <span class="comment"># potentially emitting a series of small packets.</span></div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>            self.send(b<span class="stringliteral">&quot;&quot;</span>.join(headers))</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>            del headers</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span> </div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>            response = self.response_class(self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a4f2571c7c5aa18b267286ee62e4ea9b2">sock</a>, method=self._method)  <span class="comment"># type: ignore[attr-defined]</span></div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>            <span class="keywordflow">try</span>:</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>                (version, code, message) = response._read_status()  <span class="comment"># type: ignore[attr-defined]</span></div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span> </div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>                <span class="keywordflow">if</span> code != http.HTTPStatus.OK:</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>                    self.<a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a8e859602d666e43aaa31a256820b5c41">close</a>()</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>                    <span class="keywordflow">raise</span> OSError(f<span class="stringliteral">&quot;Tunnel connection failed: {code} {message.strip()}&quot;</span>)</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>                <span class="keywordflow">while</span> <span class="keyword">True</span>:</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>                    line = response.fp.readline(_MAXLINE + 1)</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>                    <span class="keywordflow">if</span> len(line) &gt; _MAXLINE:</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>                        <span class="keywordflow">raise</span> http.client.LineTooLong(<span class="stringliteral">&quot;header line&quot;</span>)</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>                    <span class="keywordflow">if</span> <span class="keywordflow">not</span> line:</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>                        <span class="comment"># for sites which EOF without sending a trailer</span></div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>                        <span class="keywordflow">break</span></div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>                    <span class="keywordflow">if</span> line <span class="keywordflow">in</span> (b<span class="stringliteral">&quot;\r\n&quot;</span>, b<span class="stringliteral">&quot;\n&quot;</span>, b<span class="stringliteral">&quot;&quot;</span>):</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>                        <span class="keywordflow">break</span></div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span> </div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>                    <span class="keywordflow">if</span> self.debuglevel &gt; 0:</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>                        print(<span class="stringliteral">&quot;header:&quot;</span>, line.decode())</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>            <span class="keywordflow">finally</span>:</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>                response.close()</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span> </div>
</div>
<div class="foldopen" id="foldopen00278" data-start="" data-end="">
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a2e8722fd073695e4dad1517f95059d4c">  278</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a2e8722fd073695e4dad1517f95059d4c">connect</a>(self) -&gt; None:</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a4f2571c7c5aa18b267286ee62e4ea9b2">  279</a></span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a4f2571c7c5aa18b267286ee62e4ea9b2">sock</a> = self.<a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#adef2aa29d40b8252a2abc8cdf3b8c33f">_new_conn</a>()</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>        <span class="keywordflow">if</span> self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#ac62b9b5e5c739db48b12215dece40edc">_tunnel_host</a>:</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>            <span class="comment"># If we&#39;re tunneling it means we&#39;re connected to our proxy.</span></div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>            self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a3577c782aacf3b5ec02fe3a3e33be7cf">_has_connected_to_proxy</a> = <span class="keyword">True</span></div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span> </div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>            <span class="comment"># TODO: Fix tunnel so it doesn&#39;t depend on self.sock state.</span></div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>            self.<a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#ad9558b239d5382b6116b120e2ae1aceb">_tunnel</a>()</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span> </div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>        <span class="comment"># If there&#39;s a proxy to be connected to we are fully connected.</span></div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>        <span class="comment"># This is set twice (once above and here) due to forwarding proxies</span></div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>        <span class="comment"># not using tunnelling.</span></div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a3577c782aacf3b5ec02fe3a3e33be7cf">_has_connected_to_proxy</a> = bool(self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a138f40e175e42ae521bbe2d0f6d9d9c6">proxy</a>)</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span> </div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>        <span class="keywordflow">if</span> self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a3577c782aacf3b5ec02fe3a3e33be7cf">_has_connected_to_proxy</a>:</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>            self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#ad67213dfc08ca8483cf0ca6c553f673c">proxy_is_verified</a> = <span class="keyword">False</span></div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span> </div>
</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>    <span class="preprocessor">@property</span></div>
<div class="foldopen" id="foldopen00296" data-start="" data-end="">
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a245ae940942ab94d5887f5b7ca979d4a">  296</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a245ae940942ab94d5887f5b7ca979d4a">is_closed</a>(self) -&gt; bool:</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>        <span class="keywordflow">return</span> self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a4f2571c7c5aa18b267286ee62e4ea9b2">sock</a> <span class="keywordflow">is</span> <span class="keywordtype">None</span></div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span> </div>
</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>    <span class="preprocessor">@property</span></div>
<div class="foldopen" id="foldopen00300" data-start="" data-end="">
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#aeff1e87db65d9d62fd7be3b5cc356b76">  300</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#aeff1e87db65d9d62fd7be3b5cc356b76">is_connected</a>(self) -&gt; bool:</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>        <span class="keywordflow">if</span> self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a4f2571c7c5aa18b267286ee62e4ea9b2">sock</a> <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>            <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>        <span class="keywordflow">return</span> <span class="keywordflow">not</span> wait_for_read(self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a4f2571c7c5aa18b267286ee62e4ea9b2">sock</a>, timeout=0.0)</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span> </div>
</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>    <span class="preprocessor">@property</span></div>
<div class="foldopen" id="foldopen00306" data-start="" data-end="">
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a1e21d360e7fde5d6f011030107c0448d">  306</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a1e21d360e7fde5d6f011030107c0448d">has_connected_to_proxy</a>(self) -&gt; bool:</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>        <span class="keywordflow">return</span> self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a3577c782aacf3b5ec02fe3a3e33be7cf">_has_connected_to_proxy</a></div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span> </div>
</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>    <span class="preprocessor">@property</span></div>
<div class="foldopen" id="foldopen00310" data-start="" data-end="">
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a70b6501eb42eaf279d09e82cdfb73f70">  310</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a70b6501eb42eaf279d09e82cdfb73f70">proxy_is_forwarding</a>(self) -&gt; bool:</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span><span class="stringliteral">        Return True if a forwarding proxy is configured, else return False</span></div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>        <span class="keywordflow">return</span> bool(self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a138f40e175e42ae521bbe2d0f6d9d9c6">proxy</a>) <span class="keywordflow">and</span> self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#ac62b9b5e5c739db48b12215dece40edc">_tunnel_host</a> <span class="keywordflow">is</span> <span class="keywordtype">None</span></div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span> </div>
</div>
<div class="foldopen" id="foldopen00316" data-start="" data-end="">
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a8e859602d666e43aaa31a256820b5c41">  316</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a8e859602d666e43aaa31a256820b5c41">close</a>(self) -&gt; None:</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>            super().<a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a8e859602d666e43aaa31a256820b5c41">close</a>()</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>        <span class="keywordflow">finally</span>:</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>            <span class="comment"># Reset all stateful properties so connection</span></div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>            <span class="comment"># can be re-used without leaking prior configs.</span></div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>            self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a4f2571c7c5aa18b267286ee62e4ea9b2">sock</a> = <span class="keywordtype">None</span></div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>            self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#ab2024bc528bed4d7ad133e14942968e7">is_verified</a> = <span class="keyword">False</span></div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>            self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#ad67213dfc08ca8483cf0ca6c553f673c">proxy_is_verified</a> = <span class="keywordtype">None</span></div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>            self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a3577c782aacf3b5ec02fe3a3e33be7cf">_has_connected_to_proxy</a> = <span class="keyword">False</span></div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>            self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a32ff1302772ff6496fad96dfdeb9b2e2">_response_options</a> = <span class="keywordtype">None</span></div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>            self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#ac62b9b5e5c739db48b12215dece40edc">_tunnel_host</a> = <span class="keywordtype">None</span></div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>            self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a70a25a4b5bb68d6fe038a6b563efe3fd">_tunnel_port</a> = <span class="keywordtype">None</span></div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>            self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a4ae38e1d4616fbebdd79638d84be469f">_tunnel_scheme</a> = <span class="keywordtype">None</span></div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span> </div>
</div>
<div class="foldopen" id="foldopen00331" data-start="" data-end="">
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a224c389ef32f81a56aa7a6c9f67ed118">  331</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a224c389ef32f81a56aa7a6c9f67ed118">putrequest</a>(</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>        self,</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>        method: str,</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>        url: str,</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>        skip_host: bool = <span class="keyword">False</span>,</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>        skip_accept_encoding: bool = <span class="keyword">False</span>,</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>    ) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>        <span class="stringliteral">&quot;&quot;&quot;&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>        <span class="comment"># Empty docstring because the indentation of CPython&#39;s implementation</span></div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>        <span class="comment"># is broken but we don&#39;t want this method in our documentation.</span></div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>        match = _CONTAINS_CONTROL_CHAR_RE.search(method)</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>        <span class="keywordflow">if</span> match:</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>            <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>                f<span class="stringliteral">&quot;Method cannot contain non-token characters {method!r} (found at least {match.group()!r})&quot;</span></div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>            )</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span> </div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>        <span class="keywordflow">return</span> super().<a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a224c389ef32f81a56aa7a6c9f67ed118">putrequest</a>(</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>            method, url, skip_host=skip_host, skip_accept_encoding=skip_accept_encoding</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>        )</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span> </div>
</div>
<div class="foldopen" id="foldopen00351" data-start="" data-end="">
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a7e68cf0c3c3b86ab4437c16cd477072b">  351</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a7e68cf0c3c3b86ab4437c16cd477072b">putheader</a>(self, header: str, *values: str) -&gt; <span class="keywordtype">None</span>:  <span class="comment"># type: ignore[override]</span></div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>        <span class="stringliteral">&quot;&quot;&quot;&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> any(isinstance(v, str) <span class="keywordflow">and</span> v == SKIP_HEADER <span class="keywordflow">for</span> v <span class="keywordflow">in</span> values):</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>            super().<a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a7e68cf0c3c3b86ab4437c16cd477072b">putheader</a>(header, *values)</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>        <span class="keywordflow">elif</span> to_str(header.lower()) <span class="keywordflow">not</span> <span class="keywordflow">in</span> SKIPPABLE_HEADERS:</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>            skippable_headers = <span class="stringliteral">&quot;&#39;, &#39;&quot;</span>.join(</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>                [str.title(header) <span class="keywordflow">for</span> header <span class="keywordflow">in</span> sorted(SKIPPABLE_HEADERS)]</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>            )</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>            <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>                f<span class="stringliteral">&quot;urllib3.util.SKIP_HEADER only supports &#39;{skippable_headers}&#39;&quot;</span></div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>            )</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span> </div>
</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>    <span class="comment"># `request` method&#39;s signature intentionally violates LSP.</span></div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>    <span class="comment"># urllib3&#39;s API is different from `http.client.HTTPConnection` and the subclassing is only incidental.</span></div>
<div class="foldopen" id="foldopen00365" data-start="" data-end="">
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a5ea5daaf7a800e00ec6a9898ce5e8c5d">  365</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a5ea5daaf7a800e00ec6a9898ce5e8c5d">request</a>(  <span class="comment"># type: ignore[override]</span></div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>        self,</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>        method: str,</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>        url: str,</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>        body: _TYPE_BODY | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>        headers: typing.Mapping[str, str] | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>        *,</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>        chunked: bool = <span class="keyword">False</span>,</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>        preload_content: bool = <span class="keyword">True</span>,</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>        decode_content: bool = <span class="keyword">True</span>,</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>        enforce_content_length: bool = <span class="keyword">True</span>,</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>    ) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>        <span class="comment"># Update the inner socket&#39;s timeout value to send the request.</span></div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>        <span class="comment"># This only triggers if the connection is re-used.</span></div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>        <span class="keywordflow">if</span> self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a4f2571c7c5aa18b267286ee62e4ea9b2">sock</a> <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a225e4b3774685481ebe57be464057f13">  380</a></span>            self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a4f2571c7c5aa18b267286ee62e4ea9b2">sock</a>.settimeout(self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a225e4b3774685481ebe57be464057f13">timeout</a>)</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span> </div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>        <span class="comment"># Store these values to be fed into the HTTPResponse</span></div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>        <span class="comment"># object later. TODO: Remove this in favor of a real</span></div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>        <span class="comment"># HTTP lifecycle mechanism.</span></div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span> </div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>        <span class="comment"># We have to store these before we call .request()</span></div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>        <span class="comment"># because sometimes we can still salvage a response</span></div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>        <span class="comment"># off the wire even if we aren&#39;t able to completely</span></div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>        <span class="comment"># send the request body.</span></div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a32ff1302772ff6496fad96dfdeb9b2e2">_response_options</a> = <a class="code hl_class" href="classurllib3_1_1__base__connection_1_1___response_options.html">_ResponseOptions</a>(</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>            request_method=method,</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>            request_url=url,</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>            preload_content=preload_content,</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>            decode_content=decode_content,</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>            enforce_content_length=enforce_content_length,</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>        )</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span> </div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>        <span class="keywordflow">if</span> headers <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>            headers = {}</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>        header_keys = frozenset(to_str(k.lower()) <span class="keywordflow">for</span> k <span class="keywordflow">in</span> headers)</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>        skip_accept_encoding = <span class="stringliteral">&quot;accept-encoding&quot;</span> <span class="keywordflow">in</span> header_keys</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>        skip_host = <span class="stringliteral">&quot;host&quot;</span> <span class="keywordflow">in</span> header_keys</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>        self.<a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a224c389ef32f81a56aa7a6c9f67ed118">putrequest</a>(</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>            method, url, skip_accept_encoding=skip_accept_encoding, skip_host=skip_host</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>        )</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span> </div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>        <span class="comment"># Transform the body into an iterable of sendall()-able chunks</span></div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>        <span class="comment"># and detect if an explicit Content-Length is doable.</span></div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>        chunks_and_cl = body_to_chunks(body, method=method, blocksize=self.blocksize)</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>        chunks = chunks_and_cl.chunks</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>        content_length = chunks_and_cl.content_length</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span> </div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>        <span class="comment"># When chunked is explicit set to &#39;True&#39; we respect that.</span></div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>        <span class="keywordflow">if</span> chunked:</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>            <span class="keywordflow">if</span> <span class="stringliteral">&quot;transfer-encoding&quot;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> header_keys:</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>                self.<a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a7e68cf0c3c3b86ab4437c16cd477072b">putheader</a>(<span class="stringliteral">&quot;Transfer-Encoding&quot;</span>, <span class="stringliteral">&quot;chunked&quot;</span>)</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>            <span class="comment"># Detect whether a framing mechanism is already in use. If so</span></div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>            <span class="comment"># we respect that value, otherwise we pick chunked vs content-length</span></div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>            <span class="comment"># depending on the type of &#39;body&#39;.</span></div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>            <span class="keywordflow">if</span> <span class="stringliteral">&quot;content-length&quot;</span> <span class="keywordflow">in</span> header_keys:</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>                chunked = <span class="keyword">False</span></div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>            <span class="keywordflow">elif</span> <span class="stringliteral">&quot;transfer-encoding&quot;</span> <span class="keywordflow">in</span> header_keys:</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>                chunked = <span class="keyword">True</span></div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span> </div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>            <span class="comment"># Otherwise we go off the recommendation of &#39;body_to_chunks()&#39;.</span></div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>                chunked = <span class="keyword">False</span></div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>                <span class="keywordflow">if</span> content_length <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>                    <span class="keywordflow">if</span> chunks <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>                        chunked = <span class="keyword">True</span></div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>                        self.<a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a7e68cf0c3c3b86ab4437c16cd477072b">putheader</a>(<span class="stringliteral">&quot;Transfer-Encoding&quot;</span>, <span class="stringliteral">&quot;chunked&quot;</span>)</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>                    self.<a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a7e68cf0c3c3b86ab4437c16cd477072b">putheader</a>(<span class="stringliteral">&quot;Content-Length&quot;</span>, str(content_length))</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span> </div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>        <span class="comment"># Now that framing headers are out of the way we send all the other headers.</span></div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>        <span class="keywordflow">if</span> <span class="stringliteral">&quot;user-agent&quot;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> header_keys:</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>            self.<a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a7e68cf0c3c3b86ab4437c16cd477072b">putheader</a>(<span class="stringliteral">&quot;User-Agent&quot;</span>, <a class="code hl_function" href="namespaceurllib3_1_1connection.html#ad4284a84a783e20d70d6a91d7ea9c8fc">_get_default_user_agent</a>())</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>        <span class="keywordflow">for</span> header, value <span class="keywordflow">in</span> headers.items():</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>            self.<a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a7e68cf0c3c3b86ab4437c16cd477072b">putheader</a>(header, value)</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>        self.endheaders()</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span> </div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>        <span class="comment"># If we&#39;re given a body we start sending that in chunks.</span></div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>        <span class="keywordflow">if</span> chunks <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>            <span class="keywordflow">for</span> chunk <span class="keywordflow">in</span> chunks:</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>                <span class="comment"># Sending empty chunks isn&#39;t allowed for TE: chunked</span></div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>                <span class="comment"># as it indicates the end of the body.</span></div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>                <span class="keywordflow">if</span> <span class="keywordflow">not</span> chunk:</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>                    <span class="keywordflow">continue</span></div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>                <span class="keywordflow">if</span> isinstance(chunk, str):</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>                    chunk = chunk.encode(<span class="stringliteral">&quot;utf-8&quot;</span>)</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>                <span class="keywordflow">if</span> chunked:</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>                    self.send(b<span class="stringliteral">&quot;%x\r\n%b\r\n&quot;</span> % (len(chunk), chunk))</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>                    self.send(chunk)</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span> </div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>        <span class="comment"># Regardless of whether we have a body or not, if we&#39;re in</span></div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>        <span class="comment"># chunked mode we want to send an explicit empty chunk.</span></div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>        <span class="keywordflow">if</span> chunked:</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>            self.send(b<span class="stringliteral">&quot;0\r\n\r\n&quot;</span>)</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span> </div>
</div>
<div class="foldopen" id="foldopen00462" data-start="" data-end="">
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a38b88879b22e03a1a7c4eda5c786e660">  462</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a38b88879b22e03a1a7c4eda5c786e660">request_chunked</a>(</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>        self,</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>        method: str,</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>        url: str,</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>        body: _TYPE_BODY | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>        headers: typing.Mapping[str, str] | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>    ) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span><span class="stringliteral">        Alternative to the common request method, which sends the</span></div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span><span class="stringliteral">        body with chunked encoding and not as one block</span></div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>        warnings.warn(</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>            <span class="stringliteral">&quot;HTTPConnection.request_chunked() is deprecated and will be removed &quot;</span></div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>            <span class="stringliteral">&quot;in urllib3 v2.1.0. Instead use HTTPConnection.request(..., chunked=True).&quot;</span>,</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>            category=DeprecationWarning,</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>            stacklevel=2,</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>        )</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>        self.<a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a5ea5daaf7a800e00ec6a9898ce5e8c5d">request</a>(method, url, body=body, headers=headers, chunked=<span class="keyword">True</span>)</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span> </div>
</div>
<div class="foldopen" id="foldopen00481" data-start="" data-end="">
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a0178a01a73acfe8bf8cf472ace861b06">  481</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a0178a01a73acfe8bf8cf472ace861b06">getresponse</a>(  <span class="comment"># type: ignore[override]</span></div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>        self,</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>    ) -&gt; HTTPResponse:</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span><span class="stringliteral">        Get the response from the server.</span></div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span><span class="stringliteral"></span> </div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span><span class="stringliteral">        If the HTTPConnection is in the correct state, returns an instance of HTTPResponse or of whatever object is returned by the response_class variable.</span></div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span><span class="stringliteral"></span> </div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span><span class="stringliteral">        If a request has not been sent or if a previous response has not be handled, ResponseNotReady is raised. If the HTTP response indicates that the connection should be closed, then it will be closed before the response is returned. When the connection is closed, the underlying socket is closed.</span></div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>        <span class="comment"># Raise the same error as http.client.HTTPConnection</span></div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>        <span class="keywordflow">if</span> self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a32ff1302772ff6496fad96dfdeb9b2e2">_response_options</a> <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>            <span class="keywordflow">raise</span> ResponseNotReady()</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span> </div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>        <span class="comment"># Reset this attribute for being used again.</span></div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>        resp_options = self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a32ff1302772ff6496fad96dfdeb9b2e2">_response_options</a></div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a32ff1302772ff6496fad96dfdeb9b2e2">_response_options</a> = <span class="keywordtype">None</span></div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span> </div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>        <span class="comment"># Since the connection&#39;s timeout value may have been updated</span></div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>        <span class="comment"># we need to set the timeout on the socket.</span></div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a4f2571c7c5aa18b267286ee62e4ea9b2">sock</a>.settimeout(self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a225e4b3774685481ebe57be464057f13">timeout</a>)</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span> </div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>        <span class="comment"># This is needed here to avoid circular import errors</span></div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>        <span class="keyword">from</span> .response <span class="keyword">import</span> HTTPResponse</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span> </div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>        <span class="comment"># Get the response from http.client.HTTPConnection</span></div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>        httplib_response = super().<a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a0178a01a73acfe8bf8cf472ace861b06">getresponse</a>()</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span> </div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>            assert_header_parsing(httplib_response.msg)</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>        <span class="keywordflow">except</span> (HeaderParsingError, TypeError) <span class="keyword">as</span> hpe:</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>            log.warning(</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>                <span class="stringliteral">&quot;Failed to parse headers (url=%s): %s&quot;</span>,</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>                <a class="code hl_function" href="namespaceurllib3_1_1connection.html#ac17669b97da01f7bd786677ac7fcbe12">_url_from_connection</a>(self, resp_options.request_url),</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>                hpe,</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>                exc_info=<span class="keyword">True</span>,</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>            )</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span> </div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>        headers = <a class="code hl_class" href="classurllib3_1_1__collections_1_1_h_t_t_p_header_dict.html">HTTPHeaderDict</a>(httplib_response.msg.items())</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span> </div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>        response = <a class="code hl_class" href="classurllib3_1_1response_1_1_h_t_t_p_response.html">HTTPResponse</a>(</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>            body=httplib_response,</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>            headers=headers,</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>            status=httplib_response.status,</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>            version=httplib_response.version,</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>            version_string=getattr(self, <span class="stringliteral">&quot;_http_vsn_str&quot;</span>, <span class="stringliteral">&quot;HTTP/?&quot;</span>),</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>            reason=httplib_response.reason,</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>            preload_content=resp_options.preload_content,</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>            decode_content=resp_options.decode_content,</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>            original_response=httplib_response,</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>            enforce_content_length=resp_options.enforce_content_length,</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>            request_method=resp_options.request_method,</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>            request_url=resp_options.request_url,</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>        )</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>        <span class="keywordflow">return</span> response</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span> </div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span> </div>
</div>
</div>
<div class="foldopen" id="foldopen00538" data-start="" data-end="">
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html">  538</a></span><span class="keyword">class </span><a class="code hl_class" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html">HTTPSConnection</a>(<a class="code hl_class" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html">HTTPConnection</a>):</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span><span class="stringliteral">    Many of the parameters to this constructor are passed to the underlying SSL</span></div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span><span class="stringliteral">    socket by means of :py:func:`urllib3.util.ssl_wrap_socket`.</span></div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span> </div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html">  544</a></span>    default_port = port_by_scheme[<span class="stringliteral">&quot;https&quot;</span>]  <span class="comment"># type: ignore[misc]</span></div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span> </div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#add3f483d73b4b60c67fedab8795bc4d1">  546</a></span>    cert_reqs: int | str | <span class="keywordtype">None</span> = <span class="keywordtype">None</span></div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#aeb4a9277c12bb430d6a2504b9ab1c822">  547</a></span>    ca_certs: str | <span class="keywordtype">None</span> = <span class="keywordtype">None</span></div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a54f24ddaa6311a05729a5066e77b7b00">  548</a></span>    ca_cert_dir: str | <span class="keywordtype">None</span> = <span class="keywordtype">None</span></div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a05e53643dca0211bdd2f0f2f35c77554">  549</a></span>    ca_cert_data: <span class="keywordtype">None</span> | str | bytes = <span class="keywordtype">None</span></div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a19c6efeea9be3c87766c4b0942d36a6a">  550</a></span>    ssl_version: int | str | <span class="keywordtype">None</span> = <span class="keywordtype">None</span></div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#adf77d09ba71f57838286ca64301bd946">  551</a></span>    ssl_minimum_version: int | <span class="keywordtype">None</span> = <span class="keywordtype">None</span></div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a3528a881ba475a0b1593e1dd32aff5a7">  552</a></span>    ssl_maximum_version: int | <span class="keywordtype">None</span> = <span class="keywordtype">None</span></div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#ac890c82a1e9d64b0afe710c12baf6c3f">  553</a></span>    assert_fingerprint: str | <span class="keywordtype">None</span> = <span class="keywordtype">None</span></div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a92c4b32af723e61bc06c01dd00942965">  554</a></span>    _connect_callback: typing.Callable[..., <span class="keywordtype">None</span>] | <span class="keywordtype">None</span> = <span class="keywordtype">None</span></div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span> </div>
<div class="foldopen" id="foldopen00556" data-start="" data-end="">
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a639ad9c6b5c23bc4d256d9c850472194">  556</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a639ad9c6b5c23bc4d256d9c850472194">__init__</a>(</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>        self,</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>        host: str,</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>        port: int | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>        *,</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>        timeout: _TYPE_TIMEOUT = _DEFAULT_TIMEOUT,</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>        source_address: tuple[str, int] | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>        blocksize: int = 16384,</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>        socket_options: <span class="keywordtype">None</span></div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>        | (connection._TYPE_SOCKET_OPTIONS) = HTTPConnection.default_socket_options,</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>        proxy: Url | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>        proxy_config: ProxyConfig | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>        cert_reqs: int | str | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>        assert_hostname: <span class="keywordtype">None</span> | str | typing.Literal[<span class="keyword">False</span>] = <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>        assert_fingerprint: str | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>        server_hostname: str | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>        ssl_context: ssl.SSLContext | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>        ca_certs: str | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>        ca_cert_dir: str | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>        ca_cert_data: <span class="keywordtype">None</span> | str | bytes = <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>        ssl_minimum_version: int | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>        ssl_maximum_version: int | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>        ssl_version: int | str | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>,  <span class="comment"># Deprecated</span></div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>        cert_file: str | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>        key_file: str | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>        key_password: str | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>    ) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>        super().<a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a639ad9c6b5c23bc4d256d9c850472194">__init__</a>(</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>            host,</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>            port=port,</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>            timeout=timeout,</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>            source_address=source_address,</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>            blocksize=blocksize,</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>            socket_options=socket_options,</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>            proxy=proxy,</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>            proxy_config=proxy_config,</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>        )</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span> </div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a0fd6e807c951cff8718e3b7aebeeda31">  594</a></span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a0fd6e807c951cff8718e3b7aebeeda31">key_file</a> = key_file</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a1eb8acbbacf35a8323c6162d28501648">  595</a></span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a1eb8acbbacf35a8323c6162d28501648">cert_file</a> = cert_file</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#aa28e57e29bfaf55f8b2798254d460570">  596</a></span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#aa28e57e29bfaf55f8b2798254d460570">key_password</a> = key_password</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a063459be701ada39a64e8309952d0926">  597</a></span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a063459be701ada39a64e8309952d0926">ssl_context</a> = ssl_context</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a0bfa819f75e91b20d04909f2e67c1c43">  598</a></span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a0bfa819f75e91b20d04909f2e67c1c43">server_hostname</a> = server_hostname</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#ab2abebc8793ba8716ea74c365ad190fd">  599</a></span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#ab2abebc8793ba8716ea74c365ad190fd">assert_hostname</a> = assert_hostname</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#ac890c82a1e9d64b0afe710c12baf6c3f">assert_fingerprint</a> = assert_fingerprint</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a19c6efeea9be3c87766c4b0942d36a6a">ssl_version</a> = ssl_version</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#adf77d09ba71f57838286ca64301bd946">ssl_minimum_version</a> = ssl_minimum_version</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a3528a881ba475a0b1593e1dd32aff5a7">ssl_maximum_version</a> = ssl_maximum_version</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#aeb4a9277c12bb430d6a2504b9ab1c822">ca_certs</a> = ca_certs <span class="keywordflow">and</span> os.path.expanduser(ca_certs)</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a54f24ddaa6311a05729a5066e77b7b00">ca_cert_dir</a> = ca_cert_dir <span class="keywordflow">and</span> os.path.expanduser(ca_cert_dir)</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a05e53643dca0211bdd2f0f2f35c77554">ca_cert_data</a> = ca_cert_data</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span> </div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>        <span class="comment"># cert_reqs depends on ssl_context so calculate last.</span></div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>        <span class="keywordflow">if</span> cert_reqs <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>            <span class="keywordflow">if</span> self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a063459be701ada39a64e8309952d0926">ssl_context</a> <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>                cert_reqs = self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a063459be701ada39a64e8309952d0926">ssl_context</a>.verify_mode</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>                cert_reqs = resolve_cert_reqs(<span class="keywordtype">None</span>)</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#add3f483d73b4b60c67fedab8795bc4d1">cert_reqs</a> = cert_reqs</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a92c4b32af723e61bc06c01dd00942965">_connect_callback</a> = <span class="keywordtype">None</span></div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span> </div>
</div>
<div class="foldopen" id="foldopen00617" data-start="" data-end="">
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#aacc3f9aa60e688cce4ad39c9bb34c8b2">  617</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#aacc3f9aa60e688cce4ad39c9bb34c8b2">set_cert</a>(</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>        self,</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>        key_file: str | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>        cert_file: str | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>        cert_reqs: int | str | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>        key_password: str | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>        ca_certs: str | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>        assert_hostname: <span class="keywordtype">None</span> | str | typing.Literal[<span class="keyword">False</span>] = <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>        assert_fingerprint: str | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>        ca_cert_dir: str | <span class="keywordtype">None</span> = <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>        ca_cert_data: <span class="keywordtype">None</span> | str | bytes = <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>    ) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span><span class="stringliteral">        This method should only be called once, before the connection is used.</span></div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>        warnings.warn(</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>            <span class="stringliteral">&quot;HTTPSConnection.set_cert() is deprecated and will be removed &quot;</span></div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>            <span class="stringliteral">&quot;in urllib3 v2.1.0. Instead provide the parameters to the &quot;</span></div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>            <span class="stringliteral">&quot;HTTPSConnection constructor.&quot;</span>,</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>            category=DeprecationWarning,</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>            stacklevel=2,</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>        )</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span> </div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>        <span class="comment"># If cert_reqs is not provided we&#39;ll assume CERT_REQUIRED unless we also</span></div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>        <span class="comment"># have an SSLContext object in which case we&#39;ll use its verify_mode.</span></div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>        <span class="keywordflow">if</span> cert_reqs <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>            <span class="keywordflow">if</span> self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a063459be701ada39a64e8309952d0926">ssl_context</a> <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>                cert_reqs = self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a063459be701ada39a64e8309952d0926">ssl_context</a>.verify_mode</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>                cert_reqs = resolve_cert_reqs(<span class="keywordtype">None</span>)</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span> </div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a0fd6e807c951cff8718e3b7aebeeda31">key_file</a> = key_file</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a1eb8acbbacf35a8323c6162d28501648">cert_file</a> = cert_file</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#add3f483d73b4b60c67fedab8795bc4d1">cert_reqs</a> = cert_reqs</div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#aa28e57e29bfaf55f8b2798254d460570">key_password</a> = key_password</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#ab2abebc8793ba8716ea74c365ad190fd">assert_hostname</a> = assert_hostname</div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#ac890c82a1e9d64b0afe710c12baf6c3f">assert_fingerprint</a> = assert_fingerprint</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#aeb4a9277c12bb430d6a2504b9ab1c822">ca_certs</a> = ca_certs <span class="keywordflow">and</span> os.path.expanduser(ca_certs)</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a54f24ddaa6311a05729a5066e77b7b00">ca_cert_dir</a> = ca_cert_dir <span class="keywordflow">and</span> os.path.expanduser(ca_cert_dir)</div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a05e53643dca0211bdd2f0f2f35c77554">ca_cert_data</a> = ca_cert_data</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span> </div>
</div>
<div class="foldopen" id="foldopen00658" data-start="" data-end="">
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a9259b90e935c71c0088f2d09f7058153">  658</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a9259b90e935c71c0088f2d09f7058153">connect</a>(self) -&gt; None:</div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>        <span class="comment"># Today we don&#39;t need to be doing this step before the /actual/ socket</span></div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>        <span class="comment"># connection, however in the future we&#39;ll need to decide whether to</span></div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>        <span class="comment"># create a new socket or re-use an existing &quot;shared&quot; socket as a part</span></div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>        <span class="comment"># of the HTTP/2 handshake dance.</span></div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>        <span class="keywordflow">if</span> self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#ac62b9b5e5c739db48b12215dece40edc">_tunnel_host</a> <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a70a25a4b5bb68d6fe038a6b563efe3fd">_tunnel_port</a> <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>            probe_http2_host = self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#ac62b9b5e5c739db48b12215dece40edc">_tunnel_host</a></div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>            probe_http2_port = self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a70a25a4b5bb68d6fe038a6b563efe3fd">_tunnel_port</a></div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>            probe_http2_host = self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a6adcc2d915be7a8b571ee3f40198c00d">host</a></div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>            probe_http2_port = self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a67806327cbd2db96731f201ab7548f41">port</a></div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span> </div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>        <span class="comment"># Check if the target origin supports HTTP/2.</span></div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>        <span class="comment"># If the value comes back as &#39;None&#39; it means that the current thread</span></div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>        <span class="comment"># is probing for HTTP/2 support. Otherwise, we&#39;re waiting for another</span></div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>        <span class="comment"># probe to complete, or we get a value right away.</span></div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>        target_supports_http2: bool | <span class="keywordtype">None</span></div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>        <span class="keywordflow">if</span> <span class="stringliteral">&quot;h2&quot;</span> <span class="keywordflow">in</span> ssl_.ALPN_PROTOCOLS:</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>            target_supports_http2 = http2_probe.acquire_and_get(</div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>                host=probe_http2_host, port=probe_http2_port</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>            )</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>            <span class="comment"># If HTTP/2 isn&#39;t going to be offered it doesn&#39;t matter if</span></div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>            <span class="comment"># the target supports HTTP/2. Don&#39;t want to make a probe.</span></div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>            target_supports_http2 = <span class="keyword">False</span></div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span> </div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>        <span class="keywordflow">if</span> self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a92c4b32af723e61bc06c01dd00942965">_connect_callback</a> <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>            self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a92c4b32af723e61bc06c01dd00942965">_connect_callback</a>(</div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>                <span class="stringliteral">&quot;before connect&quot;</span>,</div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>                thread_id=threading.get_ident(),</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>                target_supports_http2=target_supports_http2,</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>            )</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span> </div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>            sock: socket.socket | ssl.SSLSocket</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html">  693</a></span>            self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a4f2571c7c5aa18b267286ee62e4ea9b2">sock</a> = sock = self.<a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#adef2aa29d40b8252a2abc8cdf3b8c33f">_new_conn</a>()</div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>            server_hostname: str = self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a6adcc2d915be7a8b571ee3f40198c00d">host</a></div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>            tls_in_tls = <span class="keyword">False</span></div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span> </div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>            <span class="comment"># Do we need to establish a tunnel?</span></div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>            <span class="keywordflow">if</span> self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#ac62b9b5e5c739db48b12215dece40edc">_tunnel_host</a> <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>                <span class="comment"># We&#39;re tunneling to an HTTPS origin so need to do TLS-in-TLS.</span></div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html">  700</a></span>                <span class="keywordflow">if</span> self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a4ae38e1d4616fbebdd79638d84be469f">_tunnel_scheme</a> == <span class="stringliteral">&quot;https&quot;</span>:</div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>                    <span class="comment"># _connect_tls_proxy will verify and assign proxy_is_verified</span></div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>                    self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a4f2571c7c5aa18b267286ee62e4ea9b2">sock</a> = sock = self.<a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a9ad5d26186dcf8c5317edc1b383a6201">_connect_tls_proxy</a>(self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a6adcc2d915be7a8b571ee3f40198c00d">host</a>, sock)</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>                    tls_in_tls = <span class="keyword">True</span></div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>                <span class="keywordflow">elif</span> self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a4ae38e1d4616fbebdd79638d84be469f">_tunnel_scheme</a> == <span class="stringliteral">&quot;http&quot;</span>:</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html">  705</a></span>                    self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#ad67213dfc08ca8483cf0ca6c553f673c">proxy_is_verified</a> = <span class="keyword">False</span></div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span> </div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>                <span class="comment"># If we&#39;re tunneling it means we&#39;re connected to our proxy.</span></div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html">  708</a></span>                self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a3577c782aacf3b5ec02fe3a3e33be7cf">_has_connected_to_proxy</a> = <span class="keyword">True</span></div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span> </div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>                self.<a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#ad9558b239d5382b6116b120e2ae1aceb">_tunnel</a>()</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>                <span class="comment"># Override the host with the one we&#39;re requesting data from.</span></div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>                server_hostname = self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#ac62b9b5e5c739db48b12215dece40edc">_tunnel_host</a></div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span> </div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>            <span class="keywordflow">if</span> self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a0bfa819f75e91b20d04909f2e67c1c43">server_hostname</a> <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>                server_hostname = self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a0bfa819f75e91b20d04909f2e67c1c43">server_hostname</a></div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span> </div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>            is_time_off = datetime.date.today() &lt; RECENT_DATE</div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>            <span class="keywordflow">if</span> is_time_off:</div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>                warnings.warn(</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>                    (</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>                        f<span class="stringliteral">&quot;System time is way off (before {RECENT_DATE}). This will probably &quot;</span></div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>                        <span class="stringliteral">&quot;lead to SSL verification errors&quot;</span></div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>                    ),</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>                    SystemTimeWarning,</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>                )</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span> </div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>            <span class="comment"># Remove trailing &#39;.&#39; from fqdn hostnames to allow certificate validation</span></div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>            server_hostname_rm_dot = server_hostname.rstrip(<span class="stringliteral">&quot;.&quot;</span>)</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span> </div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>            sock_and_verified = <a class="code hl_function" href="namespaceurllib3_1_1connection.html#a6f36dd1064df360d188ef2b068e8dccd">_ssl_wrap_socket_and_match_hostname</a>(</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>                sock=sock,</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>                cert_reqs=self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#add3f483d73b4b60c67fedab8795bc4d1">cert_reqs</a>,</div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>                ssl_version=self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a19c6efeea9be3c87766c4b0942d36a6a">ssl_version</a>,</div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>                ssl_minimum_version=self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#adf77d09ba71f57838286ca64301bd946">ssl_minimum_version</a>,</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>                ssl_maximum_version=self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a3528a881ba475a0b1593e1dd32aff5a7">ssl_maximum_version</a>,</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>                ca_certs=self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#aeb4a9277c12bb430d6a2504b9ab1c822">ca_certs</a>,</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>                ca_cert_dir=self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a54f24ddaa6311a05729a5066e77b7b00">ca_cert_dir</a>,</div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>                ca_cert_data=self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a05e53643dca0211bdd2f0f2f35c77554">ca_cert_data</a>,</div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>                cert_file=self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a1eb8acbbacf35a8323c6162d28501648">cert_file</a>,</div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>                key_file=self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a0fd6e807c951cff8718e3b7aebeeda31">key_file</a>,</div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>                key_password=self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#aa28e57e29bfaf55f8b2798254d460570">key_password</a>,</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span>                server_hostname=server_hostname_rm_dot,</div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>                ssl_context=self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a063459be701ada39a64e8309952d0926">ssl_context</a>,</div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span>                tls_in_tls=tls_in_tls,</div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span>                assert_hostname=self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#ab2abebc8793ba8716ea74c365ad190fd">assert_hostname</a>,</div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>                assert_fingerprint=self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#ac890c82a1e9d64b0afe710c12baf6c3f">assert_fingerprint</a>,</div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span>            )</div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>            self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a4f2571c7c5aa18b267286ee62e4ea9b2">sock</a> = sock_and_verified.socket</div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span> </div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span>        <span class="comment"># If an error occurs during connection/handshake we may need to release</span></div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>        <span class="comment"># our lock so another connection can probe the origin.</span></div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>        <span class="keywordflow">except</span> BaseException:</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>            <span class="keywordflow">if</span> self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a92c4b32af723e61bc06c01dd00942965">_connect_callback</a> <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>                self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a92c4b32af723e61bc06c01dd00942965">_connect_callback</a>(</div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>                    <span class="stringliteral">&quot;after connect failure&quot;</span>,</div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>                    thread_id=threading.get_ident(),</div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>                    target_supports_http2=target_supports_http2,</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>                )</div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span> </div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>            <span class="keywordflow">if</span> target_supports_http2 <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span>                http2_probe.set_and_release(</div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>                    host=probe_http2_host, port=probe_http2_port, supports_http2=<span class="keywordtype">None</span></div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>                )</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>            <span class="keywordflow">raise</span></div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span> </div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span>        <span class="comment"># If this connection doesn&#39;t know if the origin supports HTTP/2</span></div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span>        <span class="comment"># we report back to the HTTP/2 probe our result.</span></div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>        <span class="keywordflow">if</span> target_supports_http2 <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>            supports_http2 = sock_and_verified.socket.selected_alpn_protocol() == <span class="stringliteral">&quot;h2&quot;</span></div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>            http2_probe.set_and_release(</div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>                host=probe_http2_host,</div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span>                port=probe_http2_port,</div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span>                supports_http2=supports_http2,</div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>            )</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span> </div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>        <span class="comment"># Forwarding proxies can never have a verified target since</span></div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>        <span class="comment"># the proxy is the one doing the verification. Should instead</span></div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>        <span class="comment"># use a CONNECT tunnel in order to verify the target.</span></div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>        <span class="comment"># See: https://github.com/urllib3/urllib3/issues/3267.</span></div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html">  780</a></span>        <span class="keywordflow">if</span> self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html">proxy_is_forwarding</a>:</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html">  781</a></span>            self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#ab2024bc528bed4d7ad133e14942968e7">is_verified</a> = <span class="keyword">False</span></div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>            self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#ab2024bc528bed4d7ad133e14942968e7">is_verified</a> = sock_and_verified.is_verified</div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span> </div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span>        <span class="comment"># If there&#39;s a proxy to be connected to we are fully connected.</span></div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span>        <span class="comment"># This is set twice (once above and here) due to forwarding proxies</span></div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>        <span class="comment"># not using tunnelling.</span></div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a3577c782aacf3b5ec02fe3a3e33be7cf">_has_connected_to_proxy</a> = bool(self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a138f40e175e42ae521bbe2d0f6d9d9c6">proxy</a>)</div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span> </div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>        <span class="comment"># Set `self.proxy_is_verified` unless it&#39;s already set while</span></div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>        <span class="comment"># establishing a tunnel.</span></div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>        <span class="keywordflow">if</span> self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a3577c782aacf3b5ec02fe3a3e33be7cf">_has_connected_to_proxy</a> <span class="keywordflow">and</span> self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#ad67213dfc08ca8483cf0ca6c553f673c">proxy_is_verified</a> <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>            self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#ad67213dfc08ca8483cf0ca6c553f673c">proxy_is_verified</a> = sock_and_verified.is_verified</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span> </div>
</div>
<div class="foldopen" id="foldopen00795" data-start="" data-end="">
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a9ad5d26186dcf8c5317edc1b383a6201">  795</a></span>    <span class="keyword">def </span><a class="code hl_function" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a9ad5d26186dcf8c5317edc1b383a6201">_connect_tls_proxy</a>(self, hostname: str, sock: socket.socket) -&gt; ssl.SSLSocket:</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span><span class="stringliteral">        Establish a TLS connection to the proxy using the provided SSL context.</span></div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>        <span class="comment"># `_connect_tls_proxy` is called when self._tunnel_host is truthy.</span></div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span>        proxy_config = typing.cast(ProxyConfig, self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#acb69d5766717630021f67595c141178d">proxy_config</a>)</div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span>        ssl_context = proxy_config.ssl_context</div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span>        sock_and_verified = <a class="code hl_function" href="namespaceurllib3_1_1connection.html#a6f36dd1064df360d188ef2b068e8dccd">_ssl_wrap_socket_and_match_hostname</a>(</div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span>            sock,</div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>            cert_reqs=self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#add3f483d73b4b60c67fedab8795bc4d1">cert_reqs</a>,</div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span>            ssl_version=self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a19c6efeea9be3c87766c4b0942d36a6a">ssl_version</a>,</div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span>            ssl_minimum_version=self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#adf77d09ba71f57838286ca64301bd946">ssl_minimum_version</a>,</div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span>            ssl_maximum_version=self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a3528a881ba475a0b1593e1dd32aff5a7">ssl_maximum_version</a>,</div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span>            ca_certs=self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#aeb4a9277c12bb430d6a2504b9ab1c822">ca_certs</a>,</div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span>            ca_cert_dir=self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a54f24ddaa6311a05729a5066e77b7b00">ca_cert_dir</a>,</div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span>            ca_cert_data=self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a05e53643dca0211bdd2f0f2f35c77554">ca_cert_data</a>,</div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span>            server_hostname=hostname,</div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span>            ssl_context=ssl_context,</div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span>            assert_hostname=proxy_config.assert_hostname,</div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span>            assert_fingerprint=proxy_config.assert_fingerprint,</div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span>            <span class="comment"># Features that aren&#39;t implemented for proxies yet:</span></div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span>            cert_file=<span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>            key_file=<span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span>            key_password=<span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span>            tls_in_tls=<span class="keyword">False</span>,</div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>        )</div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span>        self.<a class="code hl_variable" href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#ad67213dfc08ca8483cf0ca6c553f673c">proxy_is_verified</a> = sock_and_verified.is_verified</div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span>        <span class="keywordflow">return</span> sock_and_verified.socket  <span class="comment"># type: ignore[return-value]</span></div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span> </div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span> </div>
</div>
</div>
<div class="foldopen" id="foldopen00825" data-start="" data-end="">
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1___wrapped_and_verified_socket.html">  825</a></span><span class="keyword">class </span><a class="code hl_class" href="classurllib3_1_1connection_1_1___wrapped_and_verified_socket.html">_WrappedAndVerifiedSocket</a>(typing.NamedTuple):</div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span><span class="stringliteral">    Wrapped socket and whether the connection is</span></div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span><span class="stringliteral">    verified after the TLS handshake</span></div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span> </div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1___wrapped_and_verified_socket.html#ade4362a1f1fc92de399d530bbfcc45fd">  831</a></span>    socket: ssl.SSLSocket | SSLTransport</div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span>    is_verified: bool</div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span> </div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span> </div>
</div>
<div class="foldopen" id="foldopen00835" data-start="" data-end="">
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno"><a class="line" href="namespaceurllib3_1_1connection.html#a6f36dd1064df360d188ef2b068e8dccd">  835</a></span><span class="keyword">def </span><a class="code hl_function" href="namespaceurllib3_1_1connection.html#a6f36dd1064df360d188ef2b068e8dccd">_ssl_wrap_socket_and_match_hostname</a>(</div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span>    sock: socket.socket,</div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span>    *,</div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span>    cert_reqs: <span class="keywordtype">None</span> | str | int,</div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span>    ssl_version: <span class="keywordtype">None</span> | str | int,</div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span>    ssl_minimum_version: int | <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>    ssl_maximum_version: int | <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span>    cert_file: str | <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>    key_file: str | <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span>    key_password: str | <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span>    ca_certs: str | <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>    ca_cert_dir: str | <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>    ca_cert_data: <span class="keywordtype">None</span> | str | bytes,</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>    assert_hostname: <span class="keywordtype">None</span> | str | typing.Literal[<span class="keyword">False</span>],</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>    assert_fingerprint: str | <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>    server_hostname: str | <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>    ssl_context: ssl.SSLContext | <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>    tls_in_tls: bool = <span class="keyword">False</span>,</div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span>) -&gt; _WrappedAndVerifiedSocket:</div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>    <span class="stringliteral">&quot;&quot;&quot;Logic for constructing an SSLContext from all TLS parameters, passing</span></div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span><span class="stringliteral">    that down into ssl_wrap_socket, and then doing certificate verification</span></div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span><span class="stringliteral">    either via hostname or fingerprint. This function exists to guarantee</span></div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span><span class="stringliteral">    that both proxies and targets have the same behavior when connecting via TLS.</span></div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span>    default_ssl_context = <span class="keyword">False</span></div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span>    <span class="keywordflow">if</span> ssl_context <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span>        default_ssl_context = <span class="keyword">True</span></div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span>        context = create_urllib3_context(</div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span>            ssl_version=resolve_ssl_version(ssl_version),</div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span>            ssl_minimum_version=ssl_minimum_version,</div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span>            ssl_maximum_version=ssl_maximum_version,</div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>            cert_reqs=resolve_cert_reqs(cert_reqs),</div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span>        )</div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span>        context = ssl_context</div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span> </div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span>    context.verify_mode = resolve_cert_reqs(cert_reqs)</div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span> </div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span>    <span class="comment"># In some cases, we want to verify hostnames ourselves</span></div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>    <span class="keywordflow">if</span> (</div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span>        <span class="comment"># `ssl` can&#39;t verify fingerprints or alternate hostnames</span></div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span>        assert_fingerprint</div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span>        <span class="keywordflow">or</span> assert_hostname</div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>        <span class="comment"># assert_hostname can be set to False to disable hostname checking</span></div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span>        <span class="keywordflow">or</span> assert_hostname <span class="keywordflow">is</span> <span class="keyword">False</span></div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span>        <span class="comment"># We still support OpenSSL 1.0.2, which prevents us from verifying</span></div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span>        <span class="comment"># hostnames easily: https://github.com/pyca/pyopenssl/pull/933</span></div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span>        <span class="keywordflow">or</span> ssl_.IS_PYOPENSSL</div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span>        <span class="keywordflow">or</span> <span class="keywordflow">not</span> ssl_.HAS_NEVER_CHECK_COMMON_NAME</div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span>    ):</div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span>        context.check_hostname = <span class="keyword">False</span></div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span> </div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span>    <span class="comment"># Try to load OS default certs if none are given. We need to do the hasattr() check</span></div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span>    <span class="comment"># for custom pyOpenSSL SSLContext objects because they don&#39;t support</span></div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span>    <span class="comment"># load_default_certs().</span></div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span>    <span class="keywordflow">if</span> (</div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span>        <span class="keywordflow">not</span> ca_certs</div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span>        <span class="keywordflow">and</span> <span class="keywordflow">not</span> ca_cert_dir</div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span>        <span class="keywordflow">and</span> <span class="keywordflow">not</span> ca_cert_data</div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span>        <span class="keywordflow">and</span> default_ssl_context</div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>        <span class="keywordflow">and</span> hasattr(context, <span class="stringliteral">&quot;load_default_certs&quot;</span>)</div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>    ):</div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>        context.load_default_certs()</div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span> </div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span>    <span class="comment"># Ensure that IPv6 addresses are in the proper format and don&#39;t have a</span></div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>    <span class="comment"># scope ID. Python&#39;s SSL module fails to recognize scoped IPv6 addresses</span></div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span>    <span class="comment"># and interprets them as DNS hostnames.</span></div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>    <span class="keywordflow">if</span> server_hostname <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>        normalized = server_hostname.strip(<span class="stringliteral">&quot;[]&quot;</span>)</div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span>        <span class="keywordflow">if</span> <span class="stringliteral">&quot;%&quot;</span> <span class="keywordflow">in</span> normalized:</div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span>            normalized = normalized[: normalized.rfind(<span class="stringliteral">&quot;%&quot;</span>)]</div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span>        <span class="keywordflow">if</span> is_ipaddress(normalized):</div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>            server_hostname = normalized</div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span> </div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span>    ssl_sock = ssl_wrap_socket(</div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>        sock=sock,</div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>        keyfile=key_file,</div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span>        certfile=cert_file,</div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span>        key_password=key_password,</div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span>        ca_certs=ca_certs,</div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span>        ca_cert_dir=ca_cert_dir,</div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span>        ca_cert_data=ca_cert_data,</div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span>        server_hostname=server_hostname,</div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span>        ssl_context=context,</div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>        tls_in_tls=tls_in_tls,</div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span>    )</div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span> </div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span>        <span class="keywordflow">if</span> assert_fingerprint:</div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span>            _assert_fingerprint(</div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span>                ssl_sock.getpeercert(binary_form=<span class="keyword">True</span>), assert_fingerprint</div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span>            )</div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span>        <span class="keywordflow">elif</span> (</div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span>            context.verify_mode != ssl.CERT_NONE</div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span>            <span class="keywordflow">and</span> <span class="keywordflow">not</span> context.check_hostname</div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span>            <span class="keywordflow">and</span> assert_hostname <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keyword">False</span></div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span>        ):</div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span>            cert: _TYPE_PEER_CERT_RET_DICT = ssl_sock.getpeercert()  <span class="comment"># type: ignore[assignment]</span></div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span> </div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span>            <span class="comment"># Need to signal to our match_hostname whether to use &#39;commonName&#39; or not.</span></div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span>            <span class="comment"># If we&#39;re using our own constructed SSLContext we explicitly set &#39;False&#39;</span></div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span>            <span class="comment"># because PyPy hard-codes &#39;True&#39; from SSLContext.hostname_checks_common_name.</span></div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span>            <span class="keywordflow">if</span> default_ssl_context:</div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span>                hostname_checks_common_name = <span class="keyword">False</span></div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span>                hostname_checks_common_name = (</div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span>                    getattr(context, <span class="stringliteral">&quot;hostname_checks_common_name&quot;</span>, <span class="keyword">False</span>) <span class="keywordflow">or</span> <span class="keyword">False</span></div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span>                )</div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span> </div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span>            <a class="code hl_function" href="namespaceurllib3_1_1connection.html#a3bdd44d44d738e24351cfa8d48901081">_match_hostname</a>(</div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span>                cert,</div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span>                assert_hostname <span class="keywordflow">or</span> server_hostname,  <span class="comment"># type: ignore[arg-type]</span></div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span>                hostname_checks_common_name,</div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span>            )</div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span> </div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="classurllib3_1_1connection_1_1___wrapped_and_verified_socket.html">_WrappedAndVerifiedSocket</a>(</div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>            socket=ssl_sock,</div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>            is_verified=context.verify_mode == ssl.CERT_REQUIRED</div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>            <span class="keywordflow">or</span> bool(assert_fingerprint),</div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span>        )</div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span>    <span class="keywordflow">except</span> BaseException:</div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span>        ssl_sock.close()</div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span>        <span class="keywordflow">raise</span></div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span> </div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span> </div>
</div>
<div class="foldopen" id="foldopen00960" data-start="" data-end="">
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno"><a class="line" href="namespaceurllib3_1_1connection.html#a3bdd44d44d738e24351cfa8d48901081">  960</a></span><span class="keyword">def </span><a class="code hl_function" href="namespaceurllib3_1_1connection.html#a3bdd44d44d738e24351cfa8d48901081">_match_hostname</a>(</div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span>    cert: _TYPE_PEER_CERT_RET_DICT | <span class="keywordtype">None</span>,</div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span>    asserted_hostname: str,</div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span>    hostname_checks_common_name: bool = <span class="keyword">False</span>,</div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span>) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span>    <span class="comment"># Our upstream implementation of ssl.match_hostname()</span></div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span>    <span class="comment"># only applies this normalization to IP addresses so it doesn&#39;t</span></div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span>    <span class="comment"># match DNS SANs so we do the same thing!</span></div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span>    stripped_hostname = asserted_hostname.strip(<span class="stringliteral">&quot;[]&quot;</span>)</div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span>    <span class="keywordflow">if</span> is_ipaddress(stripped_hostname):</div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span>        asserted_hostname = stripped_hostname</div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span> </div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span>        match_hostname(cert, asserted_hostname, hostname_checks_common_name)</div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span>    <span class="keywordflow">except</span> CertificateError <span class="keyword">as</span> e:</div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span>        log.warning(</div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span>            <span class="stringliteral">&quot;Certificate did not match expected hostname: %s. Certificate: %s&quot;</span>,</div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span>            asserted_hostname,</div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span>            cert,</div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span>        )</div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span>        <span class="comment"># Add cert to exception and reraise so client code can inspect</span></div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span>        <span class="comment"># the cert when catching the exception, if they want to</span></div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span>        e._peer_cert = cert  <span class="comment"># type: ignore[attr-defined]</span></div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span>        <span class="keywordflow">raise</span></div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span> </div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span> </div>
</div>
<div class="foldopen" id="foldopen00986" data-start="" data-end="">
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno"><a class="line" href="namespaceurllib3_1_1connection.html#a7576fccbbdf735473a403b4ee7981332">  986</a></span><span class="keyword">def </span><a class="code hl_function" href="namespaceurllib3_1_1connection.html#a7576fccbbdf735473a403b4ee7981332">_wrap_proxy_error</a>(err: Exception, proxy_scheme: str | <span class="keywordtype">None</span>) -&gt; ProxyError:</div>
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno">  987</span>    <span class="comment"># Look for the phrase &#39;wrong version number&#39;, if found</span></div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno">  988</span>    <span class="comment"># then we should warn the user that we&#39;re very sure that</span></div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span>    <span class="comment"># this proxy is HTTP-only and they have a configuration issue.</span></div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span>    error_normalized = <span class="stringliteral">&quot; &quot;</span>.join(re.split(<span class="stringliteral">&quot;[^a-z]&quot;</span>, str(err).lower()))</div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span>    is_likely_http_proxy = (</div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span>        <span class="stringliteral">&quot;wrong version number&quot;</span> <span class="keywordflow">in</span> error_normalized</div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span>        <span class="keywordflow">or</span> <span class="stringliteral">&quot;unknown protocol&quot;</span> <span class="keywordflow">in</span> error_normalized</div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span>        <span class="keywordflow">or</span> <span class="stringliteral">&quot;record layer failure&quot;</span> <span class="keywordflow">in</span> error_normalized</div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span>    )</div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span>    http_proxy_warning = (</div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span>        <span class="stringliteral">&quot;. Your proxy appears to only use HTTP and not HTTPS, &quot;</span></div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span>        <span class="stringliteral">&quot;try changing your proxy URL to be HTTP. See: &quot;</span></div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span>        <span class="stringliteral">&quot;https://urllib3.readthedocs.io/en/latest/advanced-usage.html&quot;</span></div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span>        <span class="stringliteral">&quot;#https-proxy-error-http-proxy&quot;</span></div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span>    )</div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span>    new_err = <a class="code hl_class" href="classurllib3_1_1exceptions_1_1_proxy_error.html">ProxyError</a>(</div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span>        f<span class="stringliteral">&quot;Unable to connect to proxy&quot;</span></div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span>        f<span class="stringliteral">&quot;{http_proxy_warning if is_likely_http_proxy and proxy_scheme == &#39;https&#39; else &#39;&#39;}&quot;</span>,</div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span>        err,</div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span>    )</div>
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"> 1007</span>    new_err.__cause__ = err</div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"> 1008</span>    <span class="keywordflow">return</span> new_err</div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span> </div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span> </div>
</div>
<div class="foldopen" id="foldopen01011" data-start="" data-end="">
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"><a class="line" href="namespaceurllib3_1_1connection.html#ad4284a84a783e20d70d6a91d7ea9c8fc"> 1011</a></span><span class="keyword">def </span><a class="code hl_function" href="namespaceurllib3_1_1connection.html#ad4284a84a783e20d70d6a91d7ea9c8fc">_get_default_user_agent</a>() -&gt; str:</div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span>    <span class="keywordflow">return</span> f<span class="stringliteral">&quot;python-urllib3/{__version__}&quot;</span></div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span> </div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span> </div>
</div>
<div class="foldopen" id="foldopen01015" data-start="" data-end="">
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"><a class="line" href="classurllib3_1_1connection_1_1_dummy_connection.html"> 1015</a></span><span class="keyword">class </span><a class="code hl_class" href="classurllib3_1_1connection_1_1_dummy_connection.html">DummyConnection</a>:</div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span>    <span class="stringliteral">&quot;&quot;&quot;Used to detect a failed ConnectionCls import.&quot;&quot;&quot;</span></div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"> 1017</span> </div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span> </div>
</div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span><span class="keywordflow">if</span> <span class="keywordflow">not</span> ssl:</div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"><a class="line" href="namespaceurllib3_1_1connection.html#a4dc6b0da8b6cd21438f08bae0dd2ee4d"> 1020</a></span>    HTTPSConnection = DummyConnection  <span class="comment"># type: ignore[misc, assignment] # noqa: F811</span></div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span> </div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span> </div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"><a class="line" href="namespaceurllib3_1_1connection.html#a491c6f84b91cb7be696c071e8fc60a3c"> 1023</a></span>VerifiedHTTPSConnection = HTTPSConnection</div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span> </div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span> </div>
<div class="foldopen" id="foldopen01026" data-start="" data-end="">
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"><a class="line" href="namespaceurllib3_1_1connection.html#ac17669b97da01f7bd786677ac7fcbe12"> 1026</a></span><span class="keyword">def </span><a class="code hl_function" href="namespaceurllib3_1_1connection.html#ac17669b97da01f7bd786677ac7fcbe12">_url_from_connection</a>(</div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span>    conn: HTTPConnection | HTTPSConnection, path: str | <span class="keywordtype">None</span> = <span class="keywordtype">None</span></div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span>) -&gt; str:</div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span>    <span class="stringliteral">&quot;&quot;&quot;Returns the URL from a given connection. This is mainly used for testing and logging.&quot;&quot;&quot;</span></div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span> </div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span>    scheme = <span class="stringliteral">&quot;https&quot;</span> <span class="keywordflow">if</span> isinstance(conn, HTTPSConnection) <span class="keywordflow">else</span> <span class="stringliteral">&quot;http&quot;</span></div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span> </div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span>    <span class="keywordflow">return</span> <a class="code hl_class" href="classurllib3_1_1util_1_1url_1_1_url.html">Url</a>(scheme=scheme, host=conn.host, port=conn.port, path=path).url</div>
</div>
<div class="ttc" id="aclassurllib3_1_1__base__connection_1_1___response_options_html"><div class="ttname"><a href="classurllib3_1_1__base__connection_1_1___response_options.html">urllib3._base_connection._ResponseOptions</a></div><div class="ttdef"><b>Definition</b> <a href="__base__connection_8py_source.html#l00019">_base_connection.py:19</a></div></div>
<div class="ttc" id="aclassurllib3_1_1__collections_1_1_h_t_t_p_header_dict_html"><div class="ttname"><a href="classurllib3_1_1__collections_1_1_h_t_t_p_header_dict.html">urllib3._collections.HTTPHeaderDict</a></div><div class="ttdef"><b>Definition</b> <a href="urllib3_2__collections_8py_source.html#l00206">_collections.py:206</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1___wrapped_and_verified_socket_html"><div class="ttname"><a href="classurllib3_1_1connection_1_1___wrapped_and_verified_socket.html">urllib3.connection._WrappedAndVerifiedSocket</a></div><div class="ttdef"><b>Definition</b> <a href="#l00825">connection.py:825</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_base_s_s_l_error_html"><div class="ttname"><a href="classurllib3_1_1connection_1_1_base_s_s_l_error.html">urllib3.connection.BaseSSLError</a></div><div class="ttdef"><b>Definition</b> <a href="#l00037">connection.py:37</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_dummy_connection_html"><div class="ttname"><a href="classurllib3_1_1connection_1_1_dummy_connection.html">urllib3.connection.DummyConnection</a></div><div class="ttdef"><b>Definition</b> <a href="#l01015">connection.py:1015</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_connection_html"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html">urllib3.connection.HTTPConnection</a></div><div class="ttdef"><b>Definition</b> <a href="#l00084">connection.py:84</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_connection_html_a0178a01a73acfe8bf8cf472ace861b06"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a0178a01a73acfe8bf8cf472ace861b06">urllib3.connection.HTTPConnection.getresponse</a></div><div class="ttdeci">HTTPResponse getresponse(self)</div><div class="ttdef"><b>Definition</b> <a href="#l00481">connection.py:483</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_connection_html_a069610759fc064f1c752d6db69505bf9"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a069610759fc064f1c752d6db69505bf9">urllib3.connection.HTTPConnection.socket_options</a></div><div class="ttdeci">connection socket_options</div><div class="ttdef"><b>Definition</b> <a href="#l00126">connection.py:126</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_connection_html_a09dc1873bf231d71d622071c6af6e732"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a09dc1873bf231d71d622071c6af6e732">urllib3.connection.HTTPConnection._dns_host</a></div><div class="ttdeci">_dns_host</div><div class="ttdef"><b>Definition</b> <a href="#l00191">connection.py:191</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_connection_html_a138f40e175e42ae521bbe2d0f6d9d9c6"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a138f40e175e42ae521bbe2d0f6d9d9c6">urllib3.connection.HTTPConnection.proxy</a></div><div class="ttdeci">proxy</div><div class="ttdef"><b>Definition</b> <a href="#l00155">connection.py:155</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_connection_html_a1e21d360e7fde5d6f011030107c0448d"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a1e21d360e7fde5d6f011030107c0448d">urllib3.connection.HTTPConnection.has_connected_to_proxy</a></div><div class="ttdeci">bool has_connected_to_proxy(self)</div><div class="ttdef"><b>Definition</b> <a href="#l00306">connection.py:306</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_connection_html_a224c389ef32f81a56aa7a6c9f67ed118"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a224c389ef32f81a56aa7a6c9f67ed118">urllib3.connection.HTTPConnection.putrequest</a></div><div class="ttdeci">None putrequest(self, str method, str url, bool skip_host=False, bool skip_accept_encoding=False)</div><div class="ttdef"><b>Definition</b> <a href="#l00331">connection.py:337</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_connection_html_a225e4b3774685481ebe57be464057f13"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a225e4b3774685481ebe57be464057f13">urllib3.connection.HTTPConnection.timeout</a></div><div class="ttdeci">timeout</div><div class="ttdef"><b>Definition</b> <a href="#l00380">connection.py:380</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_connection_html_a245ae940942ab94d5887f5b7ca979d4a"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a245ae940942ab94d5887f5b7ca979d4a">urllib3.connection.HTTPConnection.is_closed</a></div><div class="ttdeci">bool is_closed(self)</div><div class="ttdef"><b>Definition</b> <a href="#l00296">connection.py:296</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_connection_html_a2e8722fd073695e4dad1517f95059d4c"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a2e8722fd073695e4dad1517f95059d4c">urllib3.connection.HTTPConnection.connect</a></div><div class="ttdeci">None connect(self)</div><div class="ttdef"><b>Definition</b> <a href="#l00278">connection.py:278</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_connection_html_a32ff1302772ff6496fad96dfdeb9b2e2"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a32ff1302772ff6496fad96dfdeb9b2e2">urllib3.connection.HTTPConnection._response_options</a></div><div class="ttdeci">_ResponseOptions _response_options</div><div class="ttdef"><b>Definition</b> <a href="#l00129">connection.py:129</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_connection_html_a33d5752e3a0c43884cd55119c3e86319"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a33d5752e3a0c43884cd55119c3e86319">urllib3.connection.HTTPConnection.source_address</a></div><div class="ttdeci">tuple source_address</div><div class="ttdef"><b>Definition</b> <a href="#l00125">connection.py:125</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_connection_html_a3577c782aacf3b5ec02fe3a3e33be7cf"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a3577c782aacf3b5ec02fe3a3e33be7cf">urllib3.connection.HTTPConnection._has_connected_to_proxy</a></div><div class="ttdeci">bool _has_connected_to_proxy</div><div class="ttdef"><b>Definition</b> <a href="#l00158">connection.py:158</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_connection_html_a38b88879b22e03a1a7c4eda5c786e660"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a38b88879b22e03a1a7c4eda5c786e660">urllib3.connection.HTTPConnection.request_chunked</a></div><div class="ttdeci">None request_chunked(self, str method, str url, _TYPE_BODY|None body=None, typing.Mapping[str, str]|None headers=None)</div><div class="ttdef"><b>Definition</b> <a href="#l00462">connection.py:468</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_connection_html_a4ae38e1d4616fbebdd79638d84be469f"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a4ae38e1d4616fbebdd79638d84be469f">urllib3.connection.HTTPConnection._tunnel_scheme</a></div><div class="ttdeci">str _tunnel_scheme</div><div class="ttdef"><b>Definition</b> <a href="#l00132">connection.py:132</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_connection_html_a4f2571c7c5aa18b267286ee62e4ea9b2"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a4f2571c7c5aa18b267286ee62e4ea9b2">urllib3.connection.HTTPConnection.sock</a></div><div class="ttdeci">socket.socket sock</div><div class="ttdef"><b>Definition</b> <a href="#l00279">connection.py:279</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_connection_html_a5ea5daaf7a800e00ec6a9898ce5e8c5d"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a5ea5daaf7a800e00ec6a9898ce5e8c5d">urllib3.connection.HTTPConnection.request</a></div><div class="ttdeci">None request(self, str method, str url, _TYPE_BODY|None body=None, typing.Mapping[str, str]|None headers=None, *, bool chunked=False, bool preload_content=True, bool decode_content=True, bool enforce_content_length=True)</div><div class="ttdef"><b>Definition</b> <a href="#l00365">connection.py:376</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_connection_html_a67806327cbd2db96731f201ab7548f41"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a67806327cbd2db96731f201ab7548f41">urllib3.connection.HTTPConnection.port</a></div><div class="ttdeci">port</div><div class="ttdef"><b>Definition</b> <a href="#l00220">connection.py:220</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_connection_html_a6adcc2d915be7a8b571ee3f40198c00d"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a6adcc2d915be7a8b571ee3f40198c00d">urllib3.connection.HTTPConnection.host</a></div><div class="ttdeci">host</div><div class="ttdef"><b>Definition</b> <a href="#l00206">connection.py:206</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_connection_html_a70a25a4b5bb68d6fe038a6b563efe3fd"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a70a25a4b5bb68d6fe038a6b563efe3fd">urllib3.connection.HTTPConnection._tunnel_port</a></div><div class="ttdeci">int _tunnel_port</div><div class="ttdef"><b>Definition</b> <a href="#l00131">connection.py:131</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_connection_html_a70b6501eb42eaf279d09e82cdfb73f70"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a70b6501eb42eaf279d09e82cdfb73f70">urllib3.connection.HTTPConnection.proxy_is_forwarding</a></div><div class="ttdeci">bool proxy_is_forwarding(self)</div><div class="ttdef"><b>Definition</b> <a href="#l00310">connection.py:310</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_connection_html_a7a2bf829d9093cda2fe52c53d5d7dde0"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a7a2bf829d9093cda2fe52c53d5d7dde0">urllib3.connection.HTTPConnection.set_tunnel</a></div><div class="ttdeci">None set_tunnel(self, str host, int|None port=None, typing.Mapping[str, str]|None headers=None, str scheme=&quot;http&quot;)</div><div class="ttdef"><b>Definition</b> <a href="#l00224">connection.py:230</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_connection_html_a7e68cf0c3c3b86ab4437c16cd477072b"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a7e68cf0c3c3b86ab4437c16cd477072b">urllib3.connection.HTTPConnection.putheader</a></div><div class="ttdeci">None putheader(self, str header, *str values)</div><div class="ttdef"><b>Definition</b> <a href="#l00351">connection.py:351</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_connection_html_a8e859602d666e43aaa31a256820b5c41"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#a8e859602d666e43aaa31a256820b5c41">urllib3.connection.HTTPConnection.close</a></div><div class="ttdeci">None close(self)</div><div class="ttdef"><b>Definition</b> <a href="#l00316">connection.py:316</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_connection_html_ab2024bc528bed4d7ad133e14942968e7"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#ab2024bc528bed4d7ad133e14942968e7">urllib3.connection.HTTPConnection.is_verified</a></div><div class="ttdeci">bool is_verified</div><div class="ttdef"><b>Definition</b> <a href="#l00118">connection.py:118</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_connection_html_abf44329ead690242cb73c3bb4accbc8e"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#abf44329ead690242cb73c3bb4accbc8e">urllib3.connection.HTTPConnection.__init__</a></div><div class="ttdeci">None __init__(self, str host, int|None port=None, *, _TYPE_TIMEOUT timeout=_DEFAULT_TIMEOUT, tuple[str, int]|None source_address=None, int blocksize=16384, None|(connection._TYPE_SOCKET_OPTIONS) socket_options=default_socket_options, Url|None proxy=None, ProxyConfig|None proxy_config=None)</div><div class="ttdef"><b>Definition</b> <a href="#l00134">connection.py:146</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_connection_html_ac62b9b5e5c739db48b12215dece40edc"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#ac62b9b5e5c739db48b12215dece40edc">urllib3.connection.HTTPConnection._tunnel_host</a></div><div class="ttdeci">str _tunnel_host</div><div class="ttdef"><b>Definition</b> <a href="#l00130">connection.py:130</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_connection_html_acb69d5766717630021f67595c141178d"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#acb69d5766717630021f67595c141178d">urllib3.connection.HTTPConnection.proxy_config</a></div><div class="ttdeci">proxy_config</div><div class="ttdef"><b>Definition</b> <a href="#l00156">connection.py:156</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_connection_html_ad67213dfc08ca8483cf0ca6c553f673c"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#ad67213dfc08ca8483cf0ca6c553f673c">urllib3.connection.HTTPConnection.proxy_is_verified</a></div><div class="ttdeci">bool proxy_is_verified</div><div class="ttdef"><b>Definition</b> <a href="#l00122">connection.py:122</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_connection_html_ad9558b239d5382b6116b120e2ae1aceb"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#ad9558b239d5382b6116b120e2ae1aceb">urllib3.connection.HTTPConnection._tunnel</a></div><div class="ttdeci">None _tunnel(self)</div><div class="ttdef"><b>Definition</b> <a href="#l00240">connection.py:240</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_connection_html_adef2aa29d40b8252a2abc8cdf3b8c33f"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#adef2aa29d40b8252a2abc8cdf3b8c33f">urllib3.connection.HTTPConnection._new_conn</a></div><div class="ttdeci">socket.socket _new_conn(self)</div><div class="ttdef"><b>Definition</b> <a href="#l00193">connection.py:193</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_connection_html_aeff1e87db65d9d62fd7be3b5cc356b76"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_connection.html#aeff1e87db65d9d62fd7be3b5cc356b76">urllib3.connection.HTTPConnection.is_connected</a></div><div class="ttdeci">bool is_connected(self)</div><div class="ttdef"><b>Definition</b> <a href="#l00300">connection.py:300</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_s_connection_html"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html">urllib3.connection.HTTPSConnection</a></div><div class="ttdef"><b>Definition</b> <a href="#l00538">connection.py:538</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_s_connection_html_a05e53643dca0211bdd2f0f2f35c77554"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a05e53643dca0211bdd2f0f2f35c77554">urllib3.connection.HTTPSConnection.ca_cert_data</a></div><div class="ttdeci">None ca_cert_data</div><div class="ttdef"><b>Definition</b> <a href="#l00549">connection.py:549</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_s_connection_html_a063459be701ada39a64e8309952d0926"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a063459be701ada39a64e8309952d0926">urllib3.connection.HTTPSConnection.ssl_context</a></div><div class="ttdeci">ssl_context</div><div class="ttdef"><b>Definition</b> <a href="#l00597">connection.py:597</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_s_connection_html_a0bfa819f75e91b20d04909f2e67c1c43"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a0bfa819f75e91b20d04909f2e67c1c43">urllib3.connection.HTTPSConnection.server_hostname</a></div><div class="ttdeci">server_hostname</div><div class="ttdef"><b>Definition</b> <a href="#l00598">connection.py:598</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_s_connection_html_a0fd6e807c951cff8718e3b7aebeeda31"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a0fd6e807c951cff8718e3b7aebeeda31">urllib3.connection.HTTPSConnection.key_file</a></div><div class="ttdeci">key_file</div><div class="ttdef"><b>Definition</b> <a href="#l00594">connection.py:594</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_s_connection_html_a19c6efeea9be3c87766c4b0942d36a6a"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a19c6efeea9be3c87766c4b0942d36a6a">urllib3.connection.HTTPSConnection.ssl_version</a></div><div class="ttdeci">int ssl_version</div><div class="ttdef"><b>Definition</b> <a href="#l00550">connection.py:550</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_s_connection_html_a1eb8acbbacf35a8323c6162d28501648"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a1eb8acbbacf35a8323c6162d28501648">urllib3.connection.HTTPSConnection.cert_file</a></div><div class="ttdeci">cert_file</div><div class="ttdef"><b>Definition</b> <a href="#l00595">connection.py:595</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_s_connection_html_a3528a881ba475a0b1593e1dd32aff5a7"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a3528a881ba475a0b1593e1dd32aff5a7">urllib3.connection.HTTPSConnection.ssl_maximum_version</a></div><div class="ttdeci">int ssl_maximum_version</div><div class="ttdef"><b>Definition</b> <a href="#l00552">connection.py:552</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_s_connection_html_a54f24ddaa6311a05729a5066e77b7b00"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a54f24ddaa6311a05729a5066e77b7b00">urllib3.connection.HTTPSConnection.ca_cert_dir</a></div><div class="ttdeci">str ca_cert_dir</div><div class="ttdef"><b>Definition</b> <a href="#l00548">connection.py:548</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_s_connection_html_a639ad9c6b5c23bc4d256d9c850472194"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a639ad9c6b5c23bc4d256d9c850472194">urllib3.connection.HTTPSConnection.__init__</a></div><div class="ttdeci">None __init__(self, str host, int|None port=None, *, _TYPE_TIMEOUT timeout=_DEFAULT_TIMEOUT, tuple[str, int]|None source_address=None, int blocksize=16384, None|(connection._TYPE_SOCKET_OPTIONS) socket_options=HTTPConnection.default_socket_options, Url|None proxy=None, ProxyConfig|None proxy_config=None, int|str|None cert_reqs=None, None|str|typing.Literal[False] assert_hostname=None, str|None assert_fingerprint=None, str|None server_hostname=None, ssl.SSLContext|None ssl_context=None, str|None ca_certs=None, str|None ca_cert_dir=None, None|str|bytes ca_cert_data=None, int|None ssl_minimum_version=None, int|None ssl_maximum_version=None, int|str|None ssl_version=None, str|None cert_file=None, str|None key_file=None, str|None key_password=None)</div><div class="ttdef"><b>Definition</b> <a href="#l00556">connection.py:582</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_s_connection_html_a9259b90e935c71c0088f2d09f7058153"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a9259b90e935c71c0088f2d09f7058153">urllib3.connection.HTTPSConnection.connect</a></div><div class="ttdeci">None connect(self)</div><div class="ttdef"><b>Definition</b> <a href="#l00658">connection.py:658</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_s_connection_html_a92c4b32af723e61bc06c01dd00942965"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a92c4b32af723e61bc06c01dd00942965">urllib3.connection.HTTPSConnection._connect_callback</a></div><div class="ttdeci">typing _connect_callback</div><div class="ttdef"><b>Definition</b> <a href="#l00554">connection.py:554</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_s_connection_html_a9ad5d26186dcf8c5317edc1b383a6201"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#a9ad5d26186dcf8c5317edc1b383a6201">urllib3.connection.HTTPSConnection._connect_tls_proxy</a></div><div class="ttdeci">ssl.SSLSocket _connect_tls_proxy(self, str hostname, socket.socket sock)</div><div class="ttdef"><b>Definition</b> <a href="#l00795">connection.py:795</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_s_connection_html_aa28e57e29bfaf55f8b2798254d460570"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#aa28e57e29bfaf55f8b2798254d460570">urllib3.connection.HTTPSConnection.key_password</a></div><div class="ttdeci">key_password</div><div class="ttdef"><b>Definition</b> <a href="#l00596">connection.py:596</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_s_connection_html_aacc3f9aa60e688cce4ad39c9bb34c8b2"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#aacc3f9aa60e688cce4ad39c9bb34c8b2">urllib3.connection.HTTPSConnection.set_cert</a></div><div class="ttdeci">None set_cert(self, str|None key_file=None, str|None cert_file=None, int|str|None cert_reqs=None, str|None key_password=None, str|None ca_certs=None, None|str|typing.Literal[False] assert_hostname=None, str|None assert_fingerprint=None, str|None ca_cert_dir=None, None|str|bytes ca_cert_data=None)</div><div class="ttdef"><b>Definition</b> <a href="#l00617">connection.py:628</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_s_connection_html_ab2abebc8793ba8716ea74c365ad190fd"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#ab2abebc8793ba8716ea74c365ad190fd">urllib3.connection.HTTPSConnection.assert_hostname</a></div><div class="ttdeci">assert_hostname</div><div class="ttdef"><b>Definition</b> <a href="#l00599">connection.py:599</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_s_connection_html_ac890c82a1e9d64b0afe710c12baf6c3f"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#ac890c82a1e9d64b0afe710c12baf6c3f">urllib3.connection.HTTPSConnection.assert_fingerprint</a></div><div class="ttdeci">str assert_fingerprint</div><div class="ttdef"><b>Definition</b> <a href="#l00553">connection.py:553</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_s_connection_html_add3f483d73b4b60c67fedab8795bc4d1"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#add3f483d73b4b60c67fedab8795bc4d1">urllib3.connection.HTTPSConnection.cert_reqs</a></div><div class="ttdeci">int cert_reqs</div><div class="ttdef"><b>Definition</b> <a href="#l00546">connection.py:546</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_s_connection_html_adf77d09ba71f57838286ca64301bd946"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#adf77d09ba71f57838286ca64301bd946">urllib3.connection.HTTPSConnection.ssl_minimum_version</a></div><div class="ttdeci">int ssl_minimum_version</div><div class="ttdef"><b>Definition</b> <a href="#l00551">connection.py:551</a></div></div>
<div class="ttc" id="aclassurllib3_1_1connection_1_1_h_t_t_p_s_connection_html_aeb4a9277c12bb430d6a2504b9ab1c822"><div class="ttname"><a href="classurllib3_1_1connection_1_1_h_t_t_p_s_connection.html#aeb4a9277c12bb430d6a2504b9ab1c822">urllib3.connection.HTTPSConnection.ca_certs</a></div><div class="ttdeci">str ca_certs</div><div class="ttdef"><b>Definition</b> <a href="#l00547">connection.py:547</a></div></div>
<div class="ttc" id="aclassurllib3_1_1exceptions_1_1_connect_timeout_error_html"><div class="ttname"><a href="classurllib3_1_1exceptions_1_1_connect_timeout_error.html">urllib3.exceptions.ConnectTimeoutError</a></div><div class="ttdef"><b>Definition</b> <a href="urllib3_2exceptions_8py_source.html#l00135">exceptions.py:135</a></div></div>
<div class="ttc" id="aclassurllib3_1_1exceptions_1_1_name_resolution_error_html"><div class="ttname"><a href="classurllib3_1_1exceptions_1_1_name_resolution_error.html">urllib3.exceptions.NameResolutionError</a></div><div class="ttdef"><b>Definition</b> <a href="urllib3_2exceptions_8py_source.html#l00158">exceptions.py:158</a></div></div>
<div class="ttc" id="aclassurllib3_1_1exceptions_1_1_new_connection_error_html"><div class="ttname"><a href="classurllib3_1_1exceptions_1_1_new_connection_error.html">urllib3.exceptions.NewConnectionError</a></div><div class="ttdef"><b>Definition</b> <a href="urllib3_2exceptions_8py_source.html#l00139">exceptions.py:139</a></div></div>
<div class="ttc" id="aclassurllib3_1_1exceptions_1_1_proxy_error_html"><div class="ttname"><a href="classurllib3_1_1exceptions_1_1_proxy_error.html">urllib3.exceptions.ProxyError</a></div><div class="ttdef"><b>Definition</b> <a href="urllib3_2exceptions_8py_source.html#l00059">exceptions.py:59</a></div></div>
<div class="ttc" id="aclassurllib3_1_1response_1_1_h_t_t_p_response_html"><div class="ttname"><a href="classurllib3_1_1response_1_1_h_t_t_p_response.html">urllib3.response.HTTPResponse</a></div><div class="ttdef"><b>Definition</b> <a href="urllib3_2response_8py_source.html#l00540">response.py:540</a></div></div>
<div class="ttc" id="aclassurllib3_1_1util_1_1url_1_1_url_html"><div class="ttname"><a href="classurllib3_1_1util_1_1url_1_1_url.html">urllib3.util.url.Url</a></div><div class="ttdef"><b>Definition</b> <a href="urllib3_2util_2url_8py_source.html#l00080">url.py:93</a></div></div>
<div class="ttc" id="anamespaceurllib3_1_1connection_html_a3bdd44d44d738e24351cfa8d48901081"><div class="ttname"><a href="namespaceurllib3_1_1connection.html#a3bdd44d44d738e24351cfa8d48901081">urllib3.connection._match_hostname</a></div><div class="ttdeci">None _match_hostname(_TYPE_PEER_CERT_RET_DICT|None cert, str asserted_hostname, bool hostname_checks_common_name=False)</div><div class="ttdef"><b>Definition</b> <a href="#l00960">connection.py:964</a></div></div>
<div class="ttc" id="anamespaceurllib3_1_1connection_html_a6f36dd1064df360d188ef2b068e8dccd"><div class="ttname"><a href="namespaceurllib3_1_1connection.html#a6f36dd1064df360d188ef2b068e8dccd">urllib3.connection._ssl_wrap_socket_and_match_hostname</a></div><div class="ttdeci">_WrappedAndVerifiedSocket _ssl_wrap_socket_and_match_hostname(socket.socket sock, *, None|str|int cert_reqs, None|str|int ssl_version, int|None ssl_minimum_version, int|None ssl_maximum_version, str|None cert_file, str|None key_file, str|None key_password, str|None ca_certs, str|None ca_cert_dir, None|str|bytes ca_cert_data, None|str|typing.Literal[False] assert_hostname, str|None assert_fingerprint, str|None server_hostname, ssl.SSLContext|None ssl_context, bool tls_in_tls=False)</div><div class="ttdef"><b>Definition</b> <a href="#l00835">connection.py:853</a></div></div>
<div class="ttc" id="anamespaceurllib3_1_1connection_html_a7576fccbbdf735473a403b4ee7981332"><div class="ttname"><a href="namespaceurllib3_1_1connection.html#a7576fccbbdf735473a403b4ee7981332">urllib3.connection._wrap_proxy_error</a></div><div class="ttdeci">ProxyError _wrap_proxy_error(Exception err, str|None proxy_scheme)</div><div class="ttdef"><b>Definition</b> <a href="#l00986">connection.py:986</a></div></div>
<div class="ttc" id="anamespaceurllib3_1_1connection_html_ac17669b97da01f7bd786677ac7fcbe12"><div class="ttname"><a href="namespaceurllib3_1_1connection.html#ac17669b97da01f7bd786677ac7fcbe12">urllib3.connection._url_from_connection</a></div><div class="ttdeci">str _url_from_connection(HTTPConnection|HTTPSConnection conn, str|None path=None)</div><div class="ttdef"><b>Definition</b> <a href="#l01026">connection.py:1028</a></div></div>
<div class="ttc" id="anamespaceurllib3_1_1connection_html_ad4284a84a783e20d70d6a91d7ea9c8fc"><div class="ttname"><a href="namespaceurllib3_1_1connection.html#ad4284a84a783e20d70d6a91d7ea9c8fc">urllib3.connection._get_default_user_agent</a></div><div class="ttdeci">str _get_default_user_agent()</div><div class="ttdef"><b>Definition</b> <a href="#l01011">connection.py:1011</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_167790342fb55959539d550b874be046.html">project</a></li><li class="navelem"><a class="el" href="dir_59fdcf44228cb822b00c619a396d68f7.html">ENV</a></li><li class="navelem"><a class="el" href="dir_520aac5fbc9a8b16296dae40e20b5e22.html">Lib</a></li><li class="navelem"><a class="el" href="dir_7b145570b4e3d85b87e6bae4587a32f9.html">site-packages</a></li><li class="navelem"><a class="el" href="dir_8cb7a5b5f8503614f95dcca8121121d2.html">urllib3</a></li><li class="navelem"><a class="el" href="urllib3_2connection_8py.html">connection.py</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
