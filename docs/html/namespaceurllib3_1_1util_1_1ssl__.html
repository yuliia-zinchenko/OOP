<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Read&amp;Watch: urllib3.util.ssl_ Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Read&amp;Watch<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('namespaceurllib3_1_1util_1_1ssl__.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">urllib3.util.ssl_ Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classurllib3_1_1util_1_1ssl___1_1___t_y_p_e___p_e_e_r___c_e_r_t___r_e_t___d_i_c_t.html">_TYPE_PEER_CERT_RET_DICT</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a21a231443975cdc94a2c1db7f3e1111e" id="r_a21a231443975cdc94a2c1db7f3e1111e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a21a231443975cdc94a2c1db7f3e1111e">_is_bpo_43522_fixed</a> (str implementation_name, <a class="el" href="#ae4018d3af25aa05b53c4f890edfb9ec6">_TYPE_VERSION_INFO</a> version_info, <a class="el" href="#ae4018d3af25aa05b53c4f890edfb9ec6">_TYPE_VERSION_INFO</a>|None pypy_version_info)</td></tr>
<tr class="separator:a21a231443975cdc94a2c1db7f3e1111e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58c3f60f3a875e2e17a4dde62679a7d1" id="r_a58c3f60f3a875e2e17a4dde62679a7d1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a58c3f60f3a875e2e17a4dde62679a7d1">_is_has_never_check_common_name_reliable</a> (str openssl_version, int openssl_version_number, str implementation_name, <a class="el" href="#ae4018d3af25aa05b53c4f890edfb9ec6">_TYPE_VERSION_INFO</a> version_info, <a class="el" href="#ae4018d3af25aa05b53c4f890edfb9ec6">_TYPE_VERSION_INFO</a>|None pypy_version_info)</td></tr>
<tr class="separator:a58c3f60f3a875e2e17a4dde62679a7d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af76c6309b47d7ced0d5d90496b6345bb" id="r_af76c6309b47d7ced0d5d90496b6345bb"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af76c6309b47d7ced0d5d90496b6345bb">assert_fingerprint</a> (bytes|None cert, str fingerprint)</td></tr>
<tr class="separator:af76c6309b47d7ced0d5d90496b6345bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7a8cf22d3515e5ecba535d79eed1db2" id="r_ac7a8cf22d3515e5ecba535d79eed1db2"><td class="memItemLeft" align="right" valign="top">VerifyMode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac7a8cf22d3515e5ecba535d79eed1db2">resolve_cert_reqs</a> (None|int|str candidate)</td></tr>
<tr class="separator:ac7a8cf22d3515e5ecba535d79eed1db2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7aa025f6f0f6a2d226f272c1b9b0275" id="r_af7aa025f6f0f6a2d226f272c1b9b0275"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af7aa025f6f0f6a2d226f272c1b9b0275">resolve_ssl_version</a> (None|int|str candidate)</td></tr>
<tr class="separator:af7aa025f6f0f6a2d226f272c1b9b0275"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab30890555cef87c0d2be6e2d9eb9f405" id="r_ab30890555cef87c0d2be6e2d9eb9f405"><td class="memItemLeft" align="right" valign="top">ssl.SSLContext&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab30890555cef87c0d2be6e2d9eb9f405">create_urllib3_context</a> (int|None ssl_version=None, int|None cert_reqs=None, int|None options=None, str|None ciphers=None, int|None ssl_minimum_version=None, int|None ssl_maximum_version=None)</td></tr>
<tr class="separator:ab30890555cef87c0d2be6e2d9eb9f405"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a874f350ac8544608d4525ea92d2b230a" id="r_a874f350ac8544608d4525ea92d2b230a"><td class="memItemLeft" align="right" valign="top">ssl.SSLSocket&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a874f350ac8544608d4525ea92d2b230a">ssl_wrap_socket</a> (socket.socket sock, str|None keyfile=..., str|None certfile=..., int|None cert_reqs=..., str|None ca_certs=..., str|None server_hostname=..., int|None ssl_version=..., str|None ciphers=..., ssl.SSLContext|None ssl_context=..., str|None ca_cert_dir=..., str|None key_password=..., None|str|bytes ca_cert_data=..., typing.Literal[False] tls_in_tls=...)</td></tr>
<tr class="separator:a874f350ac8544608d4525ea92d2b230a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acce0cb270baf5b8740d6555b7819629e" id="r_acce0cb270baf5b8740d6555b7819629e"><td class="memItemLeft" align="right" valign="top">ssl.SSLSocket|SSLTransportType&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acce0cb270baf5b8740d6555b7819629e">ssl_wrap_socket</a> (socket.socket sock, str|None keyfile=..., str|None certfile=..., int|None cert_reqs=..., str|None ca_certs=..., str|None server_hostname=..., int|None ssl_version=..., str|None ciphers=..., ssl.SSLContext|None ssl_context=..., str|None ca_cert_dir=..., str|None key_password=..., None|str|bytes ca_cert_data=..., bool tls_in_tls=...)</td></tr>
<tr class="separator:acce0cb270baf5b8740d6555b7819629e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07491a621bac463562d4b066084c42d8" id="r_a07491a621bac463562d4b066084c42d8"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a07491a621bac463562d4b066084c42d8">is_ipaddress</a> (str|bytes hostname)</td></tr>
<tr class="separator:a07491a621bac463562d4b066084c42d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3fb89896839204f6ff02749df90ab02" id="r_ae3fb89896839204f6ff02749df90ab02"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae3fb89896839204f6ff02749df90ab02">_is_key_file_encrypted</a> (str key_file)</td></tr>
<tr class="separator:ae3fb89896839204f6ff02749df90ab02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9db0be5c316648421cd38090e105acc" id="r_ae9db0be5c316648421cd38090e105acc"><td class="memItemLeft" align="right" valign="top">ssl.SSLSocket|SSLTransportType&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae9db0be5c316648421cd38090e105acc">_ssl_wrap_socket_impl</a> (socket.socket sock, ssl.SSLContext ssl_context, bool tls_in_tls, str|None server_hostname=None)</td></tr>
<tr class="separator:ae9db0be5c316648421cd38090e105acc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a7a253de14f2b8023a70529697faefa45" id="r_a7a253de14f2b8023a70529697faefa45"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7a253de14f2b8023a70529697faefa45">SSLContext</a> = None</td></tr>
<tr class="separator:a7a253de14f2b8023a70529697faefa45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa410d07f935b7fbf691a75edffab840a" id="r_aa410d07f935b7fbf691a75edffab840a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa410d07f935b7fbf691a75edffab840a">SSLTransport</a> = None</td></tr>
<tr class="separator:aa410d07f935b7fbf691a75edffab840a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4f6cd642aab550092955c5188362b4e" id="r_ab4f6cd642aab550092955c5188362b4e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab4f6cd642aab550092955c5188362b4e">HAS_NEVER_CHECK_COMMON_NAME</a> = False</td></tr>
<tr class="separator:ab4f6cd642aab550092955c5188362b4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0181b63e45ecce7d6421c33795617a6d" id="r_a0181b63e45ecce7d6421c33795617a6d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0181b63e45ecce7d6421c33795617a6d">IS_PYOPENSSL</a> = False</td></tr>
<tr class="separator:a0181b63e45ecce7d6421c33795617a6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80e5166bab0b9d1ceab20dc2ad33f565" id="r_a80e5166bab0b9d1ceab20dc2ad33f565"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a80e5166bab0b9d1ceab20dc2ad33f565">ALPN_PROTOCOLS</a> = [&quot;http/1.1&quot;]</td></tr>
<tr class="separator:a80e5166bab0b9d1ceab20dc2ad33f565"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4018d3af25aa05b53c4f890edfb9ec6" id="r_ae4018d3af25aa05b53c4f890edfb9ec6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae4018d3af25aa05b53c4f890edfb9ec6">_TYPE_VERSION_INFO</a> = typing.Tuple[int, int, int, str, int]</td></tr>
<tr class="separator:ae4018d3af25aa05b53c4f890edfb9ec6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5019f6ad2ab04a28668db2a0d56876a1" id="r_a5019f6ad2ab04a28668db2a0d56876a1"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5019f6ad2ab04a28668db2a0d56876a1">HASHFUNC_MAP</a></td></tr>
<tr class="separator:a5019f6ad2ab04a28668db2a0d56876a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a463088c4f4234cc0ea92aa6b86bec232" id="r_a463088c4f4234cc0ea92aa6b86bec232"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a463088c4f4234cc0ea92aa6b86bec232">PROTOCOL_SSLv23</a> = PROTOCOL_TLS</td></tr>
<tr class="separator:a463088c4f4234cc0ea92aa6b86bec232"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec1224c620f6b839da0a62b504683441" id="r_aec1224c620f6b839da0a62b504683441"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aec1224c620f6b839da0a62b504683441">OP_NO_COMPRESSION</a> = 0x20000</td></tr>
<tr class="separator:aec1224c620f6b839da0a62b504683441"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af41f5e1ea91de40d636270ebbb660f4d" id="r_af41f5e1ea91de40d636270ebbb660f4d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af41f5e1ea91de40d636270ebbb660f4d">OP_NO_TICKET</a> = 0x4000</td></tr>
<tr class="separator:af41f5e1ea91de40d636270ebbb660f4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc46caf66ed7964e720114ce4ca3503a" id="r_adc46caf66ed7964e720114ce4ca3503a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adc46caf66ed7964e720114ce4ca3503a">OP_NO_SSLv2</a> = 0x1000000</td></tr>
<tr class="separator:adc46caf66ed7964e720114ce4ca3503a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d4bffa5c1bc3ca198213da4dc22c6e2" id="r_a4d4bffa5c1bc3ca198213da4dc22c6e2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4d4bffa5c1bc3ca198213da4dc22c6e2">OP_NO_SSLv3</a> = 0x2000000</td></tr>
<tr class="separator:a4d4bffa5c1bc3ca198213da4dc22c6e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5310ffd91418a5c6dcbbf074c2828551" id="r_a5310ffd91418a5c6dcbbf074c2828551"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5310ffd91418a5c6dcbbf074c2828551">PROTOCOL_TLS_CLIENT</a> = 16</td></tr>
<tr class="separator:a5310ffd91418a5c6dcbbf074c2828551"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa05af2713c4ef95c7ec6ba90a0889e97" id="r_aa05af2713c4ef95c7ec6ba90a0889e97"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa05af2713c4ef95c7ec6ba90a0889e97">_TYPE_PEER_CERT_RET</a> = typing.Union[&quot;_TYPE_PEER_CERT_RET_DICT&quot;, bytes, None]</td></tr>
<tr class="separator:aa05af2713c4ef95c7ec6ba90a0889e97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a21a231443975cdc94a2c1db7f3e1111e" name="a21a231443975cdc94a2c1db7f3e1111e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21a231443975cdc94a2c1db7f3e1111e">&#9670;&#160;</a></span>_is_bpo_43522_fixed()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> bool urllib3.util.ssl_._is_bpo_43522_fixed </td>
          <td>(</td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>implementation_name</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#ae4018d3af25aa05b53c4f890edfb9ec6">_TYPE_VERSION_INFO</a></td>          <td class="paramname"><span class="paramname"><em>version_info</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#ae4018d3af25aa05b53c4f890edfb9ec6">_TYPE_VERSION_INFO</a> | None</td>          <td class="paramname"><span class="paramname"><em>pypy_version_info</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Return True for CPython 3.8.9+, 3.9.3+ or 3.10+ and PyPy 7.3.8+ where
setting SSLContext.hostname_checks_common_name to False works.

Outside of CPython and PyPy we don't know which implementations work
or not so we conservatively use our hostname matching as we know that works
on all implementations.

https://github.com/urllib3/urllib3/issues/2192#issuecomment-821832963
https://foss.heptapod.net/pypy/pypy/-/issues/3539
</pre> 
<p class="definition">Definition at line <a class="el" href="urllib3_2util_2ssl___8py_source.html#l00030">30</a> of file <a class="el" href="urllib3_2util_2ssl___8py_source.html">ssl_.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   34</span>) -&gt; bool:</div>
<div class="line"><span class="lineno">   35</span>    <span class="stringliteral">&quot;&quot;&quot;Return True for CPython 3.8.9+, 3.9.3+ or 3.10+ and PyPy 7.3.8+ where</span></div>
<div class="line"><span class="lineno">   36</span><span class="stringliteral">    setting SSLContext.hostname_checks_common_name to False works.</span></div>
<div class="line"><span class="lineno">   37</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   38</span><span class="stringliteral">    Outside of CPython and PyPy we don&#39;t know which implementations work</span></div>
<div class="line"><span class="lineno">   39</span><span class="stringliteral">    or not so we conservatively use our hostname matching as we know that works</span></div>
<div class="line"><span class="lineno">   40</span><span class="stringliteral">    on all implementations.</span></div>
<div class="line"><span class="lineno">   41</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   42</span><span class="stringliteral">    https://github.com/urllib3/urllib3/issues/2192#issuecomment-821832963</span></div>
<div class="line"><span class="lineno">   43</span><span class="stringliteral">    https://foss.heptapod.net/pypy/pypy/-/issues/3539</span></div>
<div class="line"><span class="lineno">   44</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   45</span>    <span class="keywordflow">if</span> implementation_name == <span class="stringliteral">&quot;pypy&quot;</span>:</div>
<div class="line"><span class="lineno">   46</span>        <span class="comment"># https://foss.heptapod.net/pypy/pypy/-/issues/3129</span></div>
<div class="line"><span class="lineno">   47</span>        <span class="keywordflow">return</span> pypy_version_info &gt;= (7, 3, 8)  <span class="comment"># type: ignore[operator]</span></div>
<div class="line"><span class="lineno">   48</span>    <span class="keywordflow">elif</span> implementation_name == <span class="stringliteral">&quot;cpython&quot;</span>:</div>
<div class="line"><span class="lineno">   49</span>        major_minor = version_info[:2]</div>
<div class="line"><span class="lineno">   50</span>        micro = version_info[2]</div>
<div class="line"><span class="lineno">   51</span>        <span class="keywordflow">return</span> (</div>
<div class="line"><span class="lineno">   52</span>            (major_minor == (3, 8) <span class="keywordflow">and</span> micro &gt;= 9)</div>
<div class="line"><span class="lineno">   53</span>            <span class="keywordflow">or</span> (major_minor == (3, 9) <span class="keywordflow">and</span> micro &gt;= 3)</div>
<div class="line"><span class="lineno">   54</span>            <span class="keywordflow">or</span> major_minor &gt;= (3, 10)</div>
<div class="line"><span class="lineno">   55</span>        )</div>
<div class="line"><span class="lineno">   56</span>    <span class="keywordflow">else</span>:  <span class="comment"># Defensive:</span></div>
<div class="line"><span class="lineno">   57</span>        <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><span class="lineno">   58</span> </div>
<div class="line"><span class="lineno">   59</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="urllib3_2util_2ssl___8py_source.html#l00066">_is_has_never_check_common_name_reliable()</a>.</p>

</div>
</div>
<a id="a58c3f60f3a875e2e17a4dde62679a7d1" name="a58c3f60f3a875e2e17a4dde62679a7d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58c3f60f3a875e2e17a4dde62679a7d1">&#9670;&#160;</a></span>_is_has_never_check_common_name_reliable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> bool urllib3.util.ssl_._is_has_never_check_common_name_reliable </td>
          <td>(</td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>openssl_version</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>openssl_version_number</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>implementation_name</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#ae4018d3af25aa05b53c4f890edfb9ec6">_TYPE_VERSION_INFO</a></td>          <td class="paramname"><span class="paramname"><em>version_info</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#ae4018d3af25aa05b53c4f890edfb9ec6">_TYPE_VERSION_INFO</a> | None</td>          <td class="paramname"><span class="paramname"><em>pypy_version_info</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="urllib3_2util_2ssl___8py_source.html#l00060">60</a> of file <a class="el" href="urllib3_2util_2ssl___8py_source.html">ssl_.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   66</span>) -&gt; bool:</div>
<div class="line"><span class="lineno">   67</span>    <span class="comment"># As of May 2023, all released versions of LibreSSL fail to reject certificates with</span></div>
<div class="line"><span class="lineno">   68</span>    <span class="comment"># only common names, see https://github.com/urllib3/urllib3/pull/3024</span></div>
<div class="line"><span class="lineno">   69</span>    is_openssl = openssl_version.startswith(<span class="stringliteral">&quot;OpenSSL &quot;</span>)</div>
<div class="line"><span class="lineno">   70</span>    <span class="comment"># Before fixing OpenSSL issue #14579, the SSL_new() API was not copying hostflags</span></div>
<div class="line"><span class="lineno">   71</span>    <span class="comment"># like X509_CHECK_FLAG_NEVER_CHECK_SUBJECT, which tripped up CPython.</span></div>
<div class="line"><span class="lineno">   72</span>    <span class="comment"># https://github.com/openssl/openssl/issues/14579</span></div>
<div class="line"><span class="lineno">   73</span>    <span class="comment"># This was released in OpenSSL 1.1.1l+ (&gt;=0x101010cf)</span></div>
<div class="line"><span class="lineno">   74</span>    is_openssl_issue_14579_fixed = openssl_version_number &gt;= 0x101010CF</div>
<div class="line"><span class="lineno">   75</span> </div>
<div class="line"><span class="lineno">   76</span>    <span class="keywordflow">return</span> is_openssl <span class="keywordflow">and</span> (</div>
<div class="line"><span class="lineno">   77</span>        is_openssl_issue_14579_fixed</div>
<div class="line"><span class="lineno">   78</span>        <span class="keywordflow">or</span> _is_bpo_43522_fixed(implementation_name, version_info, pypy_version_info)</div>
<div class="line"><span class="lineno">   79</span>    )</div>
<div class="line"><span class="lineno">   80</span> </div>
<div class="line"><span class="lineno">   81</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="urllib3_2util_2ssl___8py_source.html#l00034">_is_bpo_43522_fixed()</a>.</p>

</div>
</div>
<a id="ae3fb89896839204f6ff02749df90ab02" name="ae3fb89896839204f6ff02749df90ab02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3fb89896839204f6ff02749df90ab02">&#9670;&#160;</a></span>_is_key_file_encrypted()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> bool urllib3.util.ssl_._is_key_file_encrypted </td>
          <td>(</td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>key_file</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Detects if a key file is encrypted or not.</pre> 
<p class="definition">Definition at line <a class="el" href="urllib3_2util_2ssl___8py_source.html#l00486">486</a> of file <a class="el" href="urllib3_2util_2ssl___8py_source.html">ssl_.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  486</span><span class="keyword">def </span>_is_key_file_encrypted(key_file: str) -&gt; bool:</div>
<div class="line"><span class="lineno">  487</span>    <span class="stringliteral">&quot;&quot;&quot;Detects if a key file is encrypted or not.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  488</span>    <span class="keyword">with</span> open(key_file) <span class="keyword">as</span> f:</div>
<div class="line"><span class="lineno">  489</span>        <span class="keywordflow">for</span> line <span class="keywordflow">in</span> f:</div>
<div class="line"><span class="lineno">  490</span>            <span class="comment"># Look for Proc-Type: 4,ENCRYPTED</span></div>
<div class="line"><span class="lineno">  491</span>            <span class="keywordflow">if</span> <span class="stringliteral">&quot;ENCRYPTED&quot;</span> <span class="keywordflow">in</span> line:</div>
<div class="line"><span class="lineno">  492</span>                <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  493</span> </div>
<div class="line"><span class="lineno">  494</span>    <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  495</span> </div>
<div class="line"><span class="lineno">  496</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="urllib3_2util_2ssl___8py_source.html#l00395">ssl_wrap_socket()</a>.</p>

</div>
</div>
<a id="ae9db0be5c316648421cd38090e105acc" name="ae9db0be5c316648421cd38090e105acc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9db0be5c316648421cd38090e105acc">&#9670;&#160;</a></span>_ssl_wrap_socket_impl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> ssl.SSLSocket | SSLTransportType urllib3.util.ssl_._ssl_wrap_socket_impl </td>
          <td>(</td>
          <td class="paramtype">socket.socket</td>          <td class="paramname"><span class="paramname"><em>sock</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ssl.SSLContext</td>          <td class="paramname"><span class="paramname"><em>ssl_context</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>tls_in_tls</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str | None </td>          <td class="paramname"><span class="paramname"><em>server_hostname</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="urllib3_2util_2ssl___8py_source.html#l00497">497</a> of file <a class="el" href="urllib3_2util_2ssl___8py_source.html">ssl_.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  502</span>) -&gt; ssl.SSLSocket | SSLTransportType:</div>
<div class="line"><span class="lineno">  503</span>    <span class="keywordflow">if</span> tls_in_tls:</div>
<div class="line"><span class="lineno">  504</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> SSLTransport:</div>
<div class="line"><span class="lineno">  505</span>            <span class="comment"># Import error, ssl is not available.</span></div>
<div class="line"><span class="lineno">  506</span>            <span class="keywordflow">raise</span> ProxySchemeUnsupported(</div>
<div class="line"><span class="lineno">  507</span>                <span class="stringliteral">&quot;TLS in TLS requires support for the &#39;ssl&#39; module&quot;</span></div>
<div class="line"><span class="lineno">  508</span>            )</div>
<div class="line"><span class="lineno">  509</span> </div>
<div class="line"><span class="lineno">  510</span>        SSLTransport._validate_ssl_context_for_tls_in_tls(ssl_context)</div>
<div class="line"><span class="lineno">  511</span>        <span class="keywordflow">return</span> SSLTransport(sock, ssl_context, server_hostname)</div>
<div class="line"><span class="lineno">  512</span> </div>
<div class="line"><span class="lineno">  513</span>    <span class="keywordflow">return</span> ssl_context.wrap_socket(sock, server_hostname=server_hostname)</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="urllib3_2util_2ssl___8py_source.html#l00395">ssl_wrap_socket()</a>.</p>

</div>
</div>
<a id="af76c6309b47d7ced0d5d90496b6345bb" name="af76c6309b47d7ced0d5d90496b6345bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af76c6309b47d7ced0d5d90496b6345bb">&#9670;&#160;</a></span>assert_fingerprint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None urllib3.util.ssl_.assert_fingerprint </td>
          <td>(</td>
          <td class="paramtype">bytes | None</td>          <td class="paramname"><span class="paramname"><em>cert</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str</td>          <td class="paramname"><span class="paramname"><em>fingerprint</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Checks if given fingerprint matches the supplied certificate.

:param cert:
    Certificate as bytes object.
:param fingerprint:
    Fingerprint as string of hexdigits, can be interspersed by colons.
</pre> 
<p class="definition">Definition at line <a class="el" href="urllib3_2util_2ssl___8py_source.html#l00150">150</a> of file <a class="el" href="urllib3_2util_2ssl___8py_source.html">ssl_.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  150</span><span class="keyword">def </span>assert_fingerprint(cert: bytes | <span class="keywordtype">None</span>, fingerprint: str) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  151</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  152</span><span class="stringliteral">    Checks if given fingerprint matches the supplied certificate.</span></div>
<div class="line"><span class="lineno">  153</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  154</span><span class="stringliteral">    :param cert:</span></div>
<div class="line"><span class="lineno">  155</span><span class="stringliteral">        Certificate as bytes object.</span></div>
<div class="line"><span class="lineno">  156</span><span class="stringliteral">    :param fingerprint:</span></div>
<div class="line"><span class="lineno">  157</span><span class="stringliteral">        Fingerprint as string of hexdigits, can be interspersed by colons.</span></div>
<div class="line"><span class="lineno">  158</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  159</span> </div>
<div class="line"><span class="lineno">  160</span>    <span class="keywordflow">if</span> cert <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  161</span>        <span class="keywordflow">raise</span> SSLError(<span class="stringliteral">&quot;No certificate for the peer.&quot;</span>)</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>    fingerprint = fingerprint.replace(<span class="stringliteral">&quot;:&quot;</span>, <span class="stringliteral">&quot;&quot;</span>).lower()</div>
<div class="line"><span class="lineno">  164</span>    digest_length = len(fingerprint)</div>
<div class="line"><span class="lineno">  165</span>    <span class="keywordflow">if</span> digest_length <span class="keywordflow">not</span> <span class="keywordflow">in</span> HASHFUNC_MAP:</div>
<div class="line"><span class="lineno">  166</span>        <span class="keywordflow">raise</span> SSLError(f<span class="stringliteral">&quot;Fingerprint of invalid length: {fingerprint}&quot;</span>)</div>
<div class="line"><span class="lineno">  167</span>    hashfunc = HASHFUNC_MAP.get(digest_length)</div>
<div class="line"><span class="lineno">  168</span>    <span class="keywordflow">if</span> hashfunc <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  169</span>        <span class="keywordflow">raise</span> SSLError(</div>
<div class="line"><span class="lineno">  170</span>            f<span class="stringliteral">&quot;Hash function implementation unavailable for fingerprint length: {digest_length}&quot;</span></div>
<div class="line"><span class="lineno">  171</span>        )</div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>    <span class="comment"># We need encode() here for py32; works on py2 and p33.</span></div>
<div class="line"><span class="lineno">  174</span>    fingerprint_bytes = unhexlify(fingerprint.encode())</div>
<div class="line"><span class="lineno">  175</span> </div>
<div class="line"><span class="lineno">  176</span>    cert_digest = hashfunc(cert).digest()</div>
<div class="line"><span class="lineno">  177</span> </div>
<div class="line"><span class="lineno">  178</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> hmac.compare_digest(cert_digest, fingerprint_bytes):</div>
<div class="line"><span class="lineno">  179</span>        <span class="keywordflow">raise</span> SSLError(</div>
<div class="line"><span class="lineno">  180</span>            f<span class="stringliteral">&#39;Fingerprints did not match. Expected &quot;{fingerprint}&quot;, got &quot;{cert_digest.hex()}&quot;&#39;</span></div>
<div class="line"><span class="lineno">  181</span>        )</div>
<div class="line"><span class="lineno">  182</span> </div>
<div class="line"><span class="lineno">  183</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab30890555cef87c0d2be6e2d9eb9f405" name="ab30890555cef87c0d2be6e2d9eb9f405"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab30890555cef87c0d2be6e2d9eb9f405">&#9670;&#160;</a></span>create_urllib3_context()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> ssl.SSLContext urllib3.util.ssl_.create_urllib3_context </td>
          <td>(</td>
          <td class="paramtype">int | None </td>          <td class="paramname"><span class="paramname"><em>ssl_version</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int | None </td>          <td class="paramname"><span class="paramname"><em>cert_reqs</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int | None </td>          <td class="paramname"><span class="paramname"><em>options</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str | None </td>          <td class="paramname"><span class="paramname"><em>ciphers</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int | None </td>          <td class="paramname"><span class="paramname"><em>ssl_minimum_version</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int | None </td>          <td class="paramname"><span class="paramname"><em>ssl_maximum_version</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Creates and configures an :class:`ssl.SSLContext` instance for use with urllib3.

:param ssl_version:
    The desired protocol version to use. This will default to
    PROTOCOL_SSLv23 which will negotiate the highest protocol that both
    the server and your installation of OpenSSL support.

    This parameter is deprecated instead use 'ssl_minimum_version'.
:param ssl_minimum_version:
    The minimum version of TLS to be used. Use the 'ssl.TLSVersion' enum for specifying the value.
:param ssl_maximum_version:
    The maximum version of TLS to be used. Use the 'ssl.TLSVersion' enum for specifying the value.
    Not recommended to set to anything other than 'ssl.TLSVersion.MAXIMUM_SUPPORTED' which is the
    default value.
:param cert_reqs:
    Whether to require the certificate verification. This defaults to
    ``ssl.CERT_REQUIRED``.
:param options:
    Specific OpenSSL options. These default to ``ssl.OP_NO_SSLv2``,
    ``ssl.OP_NO_SSLv3``, ``ssl.OP_NO_COMPRESSION``, and ``ssl.OP_NO_TICKET``.
:param ciphers:
    Which cipher suites to allow the server to select. Defaults to either system configured
    ciphers if OpenSSL 1.1.1+, otherwise uses a secure default set of ciphers.
:returns:
    Constructed SSLContext object with specified options
:rtype: SSLContext
</pre> 
<p class="definition">Definition at line <a class="el" href="urllib3_2util_2ssl___8py_source.html#l00223">223</a> of file <a class="el" href="urllib3_2util_2ssl___8py_source.html">ssl_.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  230</span>) -&gt; ssl.SSLContext:</div>
<div class="line"><span class="lineno">  231</span>    <span class="stringliteral">&quot;&quot;&quot;Creates and configures an :class:`ssl.SSLContext` instance for use with urllib3.</span></div>
<div class="line"><span class="lineno">  232</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  233</span><span class="stringliteral">    :param ssl_version:</span></div>
<div class="line"><span class="lineno">  234</span><span class="stringliteral">        The desired protocol version to use. This will default to</span></div>
<div class="line"><span class="lineno">  235</span><span class="stringliteral">        PROTOCOL_SSLv23 which will negotiate the highest protocol that both</span></div>
<div class="line"><span class="lineno">  236</span><span class="stringliteral">        the server and your installation of OpenSSL support.</span></div>
<div class="line"><span class="lineno">  237</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  238</span><span class="stringliteral">        This parameter is deprecated instead use &#39;ssl_minimum_version&#39;.</span></div>
<div class="line"><span class="lineno">  239</span><span class="stringliteral">    :param ssl_minimum_version:</span></div>
<div class="line"><span class="lineno">  240</span><span class="stringliteral">        The minimum version of TLS to be used. Use the &#39;ssl.TLSVersion&#39; enum for specifying the value.</span></div>
<div class="line"><span class="lineno">  241</span><span class="stringliteral">    :param ssl_maximum_version:</span></div>
<div class="line"><span class="lineno">  242</span><span class="stringliteral">        The maximum version of TLS to be used. Use the &#39;ssl.TLSVersion&#39; enum for specifying the value.</span></div>
<div class="line"><span class="lineno">  243</span><span class="stringliteral">        Not recommended to set to anything other than &#39;ssl.TLSVersion.MAXIMUM_SUPPORTED&#39; which is the</span></div>
<div class="line"><span class="lineno">  244</span><span class="stringliteral">        default value.</span></div>
<div class="line"><span class="lineno">  245</span><span class="stringliteral">    :param cert_reqs:</span></div>
<div class="line"><span class="lineno">  246</span><span class="stringliteral">        Whether to require the certificate verification. This defaults to</span></div>
<div class="line"><span class="lineno">  247</span><span class="stringliteral">        ``ssl.CERT_REQUIRED``.</span></div>
<div class="line"><span class="lineno">  248</span><span class="stringliteral">    :param options:</span></div>
<div class="line"><span class="lineno">  249</span><span class="stringliteral">        Specific OpenSSL options. These default to ``ssl.OP_NO_SSLv2``,</span></div>
<div class="line"><span class="lineno">  250</span><span class="stringliteral">        ``ssl.OP_NO_SSLv3``, ``ssl.OP_NO_COMPRESSION``, and ``ssl.OP_NO_TICKET``.</span></div>
<div class="line"><span class="lineno">  251</span><span class="stringliteral">    :param ciphers:</span></div>
<div class="line"><span class="lineno">  252</span><span class="stringliteral">        Which cipher suites to allow the server to select. Defaults to either system configured</span></div>
<div class="line"><span class="lineno">  253</span><span class="stringliteral">        ciphers if OpenSSL 1.1.1+, otherwise uses a secure default set of ciphers.</span></div>
<div class="line"><span class="lineno">  254</span><span class="stringliteral">    :returns:</span></div>
<div class="line"><span class="lineno">  255</span><span class="stringliteral">        Constructed SSLContext object with specified options</span></div>
<div class="line"><span class="lineno">  256</span><span class="stringliteral">    :rtype: SSLContext</span></div>
<div class="line"><span class="lineno">  257</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  258</span>    <span class="keywordflow">if</span> SSLContext <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  259</span>        <span class="keywordflow">raise</span> TypeError(<span class="stringliteral">&quot;Can&#39;t create an SSLContext object without an ssl module&quot;</span>)</div>
<div class="line"><span class="lineno">  260</span> </div>
<div class="line"><span class="lineno">  261</span>    <span class="comment"># This means &#39;ssl_version&#39; was specified as an exact value.</span></div>
<div class="line"><span class="lineno">  262</span>    <span class="keywordflow">if</span> ssl_version <span class="keywordflow">not</span> <span class="keywordflow">in</span> (<span class="keywordtype">None</span>, PROTOCOL_TLS, PROTOCOL_TLS_CLIENT):</div>
<div class="line"><span class="lineno">  263</span>        <span class="comment"># Disallow setting &#39;ssl_version&#39; and &#39;ssl_minimum|maximum_version&#39;</span></div>
<div class="line"><span class="lineno">  264</span>        <span class="comment"># to avoid conflicts.</span></div>
<div class="line"><span class="lineno">  265</span>        <span class="keywordflow">if</span> ssl_minimum_version <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">or</span> ssl_maximum_version <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  266</span>            <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  267</span>                <span class="stringliteral">&quot;Can&#39;t specify both &#39;ssl_version&#39; and either &quot;</span></div>
<div class="line"><span class="lineno">  268</span>                <span class="stringliteral">&quot;&#39;ssl_minimum_version&#39; or &#39;ssl_maximum_version&#39;&quot;</span></div>
<div class="line"><span class="lineno">  269</span>            )</div>
<div class="line"><span class="lineno">  270</span> </div>
<div class="line"><span class="lineno">  271</span>        <span class="comment"># &#39;ssl_version&#39; is deprecated and will be removed in the future.</span></div>
<div class="line"><span class="lineno">  272</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  273</span>            <span class="comment"># Use &#39;ssl_minimum_version&#39; and &#39;ssl_maximum_version&#39; instead.</span></div>
<div class="line"><span class="lineno">  274</span>            ssl_minimum_version = _SSL_VERSION_TO_TLS_VERSION.get(</div>
<div class="line"><span class="lineno">  275</span>                ssl_version, TLSVersion.MINIMUM_SUPPORTED</div>
<div class="line"><span class="lineno">  276</span>            )</div>
<div class="line"><span class="lineno">  277</span>            ssl_maximum_version = _SSL_VERSION_TO_TLS_VERSION.get(</div>
<div class="line"><span class="lineno">  278</span>                ssl_version, TLSVersion.MAXIMUM_SUPPORTED</div>
<div class="line"><span class="lineno">  279</span>            )</div>
<div class="line"><span class="lineno">  280</span> </div>
<div class="line"><span class="lineno">  281</span>            <span class="comment"># This warning message is pushing users to use &#39;ssl_minimum_version&#39;</span></div>
<div class="line"><span class="lineno">  282</span>            <span class="comment"># instead of both min/max. Best practice is to only set the minimum version and</span></div>
<div class="line"><span class="lineno">  283</span>            <span class="comment"># keep the maximum version to be it&#39;s default value: &#39;TLSVersion.MAXIMUM_SUPPORTED&#39;</span></div>
<div class="line"><span class="lineno">  284</span>            warnings.warn(</div>
<div class="line"><span class="lineno">  285</span>                <span class="stringliteral">&quot;&#39;ssl_version&#39; option is deprecated and will be &quot;</span></div>
<div class="line"><span class="lineno">  286</span>                <span class="stringliteral">&quot;removed in urllib3 v2.1.0. Instead use &#39;ssl_minimum_version&#39;&quot;</span>,</div>
<div class="line"><span class="lineno">  287</span>                category=DeprecationWarning,</div>
<div class="line"><span class="lineno">  288</span>                stacklevel=2,</div>
<div class="line"><span class="lineno">  289</span>            )</div>
<div class="line"><span class="lineno">  290</span> </div>
<div class="line"><span class="lineno">  291</span>    <span class="comment"># PROTOCOL_TLS is deprecated in Python 3.10 so we always use PROTOCOL_TLS_CLIENT</span></div>
<div class="line"><span class="lineno">  292</span>    context = SSLContext(PROTOCOL_TLS_CLIENT)</div>
<div class="line"><span class="lineno">  293</span> </div>
<div class="line"><span class="lineno">  294</span>    <span class="keywordflow">if</span> ssl_minimum_version <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  295</span>        context.minimum_version = ssl_minimum_version</div>
<div class="line"><span class="lineno">  296</span>    <span class="keywordflow">else</span>:  <span class="comment"># Python &lt;3.10 defaults to &#39;MINIMUM_SUPPORTED&#39; so explicitly set TLSv1.2 here</span></div>
<div class="line"><span class="lineno">  297</span>        context.minimum_version = TLSVersion.TLSv1_2</div>
<div class="line"><span class="lineno">  298</span> </div>
<div class="line"><span class="lineno">  299</span>    <span class="keywordflow">if</span> ssl_maximum_version <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  300</span>        context.maximum_version = ssl_maximum_version</div>
<div class="line"><span class="lineno">  301</span> </div>
<div class="line"><span class="lineno">  302</span>    <span class="comment"># Unless we&#39;re given ciphers defer to either system ciphers in</span></div>
<div class="line"><span class="lineno">  303</span>    <span class="comment"># the case of OpenSSL 1.1.1+ or use our own secure default ciphers.</span></div>
<div class="line"><span class="lineno">  304</span>    <span class="keywordflow">if</span> ciphers:</div>
<div class="line"><span class="lineno">  305</span>        context.set_ciphers(ciphers)</div>
<div class="line"><span class="lineno">  306</span> </div>
<div class="line"><span class="lineno">  307</span>    <span class="comment"># Setting the default here, as we may have no ssl module on import</span></div>
<div class="line"><span class="lineno">  308</span>    cert_reqs = ssl.CERT_REQUIRED <span class="keywordflow">if</span> cert_reqs <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">else</span> cert_reqs</div>
<div class="line"><span class="lineno">  309</span> </div>
<div class="line"><span class="lineno">  310</span>    <span class="keywordflow">if</span> options <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  311</span>        options = 0</div>
<div class="line"><span class="lineno">  312</span>        <span class="comment"># SSLv2 is easily broken and is considered harmful and dangerous</span></div>
<div class="line"><span class="lineno">  313</span>        options |= OP_NO_SSLv2</div>
<div class="line"><span class="lineno">  314</span>        <span class="comment"># SSLv3 has several problems and is now dangerous</span></div>
<div class="line"><span class="lineno">  315</span>        options |= OP_NO_SSLv3</div>
<div class="line"><span class="lineno">  316</span>        <span class="comment"># Disable compression to prevent CRIME attacks for OpenSSL 1.0+</span></div>
<div class="line"><span class="lineno">  317</span>        <span class="comment"># (issue #309)</span></div>
<div class="line"><span class="lineno">  318</span>        options |= OP_NO_COMPRESSION</div>
<div class="line"><span class="lineno">  319</span>        <span class="comment"># TLSv1.2 only. Unless set explicitly, do not request tickets.</span></div>
<div class="line"><span class="lineno">  320</span>        <span class="comment"># This may save some bandwidth on wire, and although the ticket is encrypted,</span></div>
<div class="line"><span class="lineno">  321</span>        <span class="comment"># there is a risk associated with it being on wire,</span></div>
<div class="line"><span class="lineno">  322</span>        <span class="comment"># if the server is not rotating its ticketing keys properly.</span></div>
<div class="line"><span class="lineno">  323</span>        options |= OP_NO_TICKET</div>
<div class="line"><span class="lineno">  324</span> </div>
<div class="line"><span class="lineno">  325</span>    context.options |= options</div>
<div class="line"><span class="lineno">  326</span> </div>
<div class="line"><span class="lineno">  327</span>    <span class="comment"># Enable post-handshake authentication for TLS 1.3, see GH #1634. PHA is</span></div>
<div class="line"><span class="lineno">  328</span>    <span class="comment"># necessary for conditional client cert authentication with TLS 1.3.</span></div>
<div class="line"><span class="lineno">  329</span>    <span class="comment"># The attribute is None for OpenSSL &lt;= 1.1.0 or does not exist when using</span></div>
<div class="line"><span class="lineno">  330</span>    <span class="comment"># an SSLContext created by pyOpenSSL.</span></div>
<div class="line"><span class="lineno">  331</span>    <span class="keywordflow">if</span> getattr(context, <span class="stringliteral">&quot;post_handshake_auth&quot;</span>, <span class="keywordtype">None</span>) <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  332</span>        context.post_handshake_auth = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  333</span> </div>
<div class="line"><span class="lineno">  334</span>    <span class="comment"># The order of the below lines setting verify_mode and check_hostname</span></div>
<div class="line"><span class="lineno">  335</span>    <span class="comment"># matter due to safe-guards SSLContext has to prevent an SSLContext with</span></div>
<div class="line"><span class="lineno">  336</span>    <span class="comment"># check_hostname=True, verify_mode=NONE/OPTIONAL.</span></div>
<div class="line"><span class="lineno">  337</span>    <span class="comment"># We always set &#39;check_hostname=False&#39; for pyOpenSSL so we rely on our own</span></div>
<div class="line"><span class="lineno">  338</span>    <span class="comment"># &#39;ssl.match_hostname()&#39; implementation.</span></div>
<div class="line"><span class="lineno">  339</span>    <span class="keywordflow">if</span> cert_reqs == ssl.CERT_REQUIRED <span class="keywordflow">and</span> <span class="keywordflow">not</span> IS_PYOPENSSL:</div>
<div class="line"><span class="lineno">  340</span>        context.verify_mode = cert_reqs</div>
<div class="line"><span class="lineno">  341</span>        context.check_hostname = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  342</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  343</span>        context.check_hostname = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  344</span>        context.verify_mode = cert_reqs</div>
<div class="line"><span class="lineno">  345</span> </div>
<div class="line"><span class="lineno">  346</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  347</span>        context.hostname_checks_common_name = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  348</span>    <span class="keywordflow">except</span> AttributeError:  <span class="comment"># Defensive: for CPython &lt; 3.8.9 and 3.9.3; for PyPy &lt; 7.3.8</span></div>
<div class="line"><span class="lineno">  349</span>        <span class="keywordflow">pass</span></div>
<div class="line"><span class="lineno">  350</span> </div>
<div class="line"><span class="lineno">  351</span>    <span class="comment"># Enable logging of TLS session keys via defacto standard environment variable</span></div>
<div class="line"><span class="lineno">  352</span>    <span class="comment"># &#39;SSLKEYLOGFILE&#39;, if the feature is available (Python 3.8+). Skip empty values.</span></div>
<div class="line"><span class="lineno">  353</span>    <span class="keywordflow">if</span> hasattr(context, <span class="stringliteral">&quot;keylog_filename&quot;</span>):</div>
<div class="line"><span class="lineno">  354</span>        sslkeylogfile = os.environ.get(<span class="stringliteral">&quot;SSLKEYLOGFILE&quot;</span>)</div>
<div class="line"><span class="lineno">  355</span>        <span class="keywordflow">if</span> sslkeylogfile:</div>
<div class="line"><span class="lineno">  356</span>            context.keylog_filename = sslkeylogfile</div>
<div class="line"><span class="lineno">  357</span> </div>
<div class="line"><span class="lineno">  358</span>    <span class="keywordflow">return</span> context</div>
<div class="line"><span class="lineno">  359</span> </div>
<div class="line"><span class="lineno">  360</span> </div>
<div class="line"><span class="lineno">  361</span><span class="preprocessor">@typing.overload</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="urllib3_2util_2ssl___8py_source.html#l00015">SSLContext</a>.</p>

<p class="reference">Referenced by <a class="el" href="urllib3_2util_2ssl___8py_source.html#l00395">ssl_wrap_socket()</a>.</p>

</div>
</div>
<a id="a07491a621bac463562d4b066084c42d8" name="a07491a621bac463562d4b066084c42d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07491a621bac463562d4b066084c42d8">&#9670;&#160;</a></span>is_ipaddress()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> bool urllib3.util.ssl_.is_ipaddress </td>
          <td>(</td>
          <td class="paramtype">str | bytes</td>          <td class="paramname"><span class="paramname"><em>hostname</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Detects whether the hostname given is an IPv4 or IPv6 address.
Also detects IPv6 addresses with Zone IDs.

:param str hostname: Hostname to examine.
:return: True if the hostname is an IP address, False otherwise.
</pre> 
<p class="definition">Definition at line <a class="el" href="urllib3_2util_2ssl___8py_source.html#l00473">473</a> of file <a class="el" href="urllib3_2util_2ssl___8py_source.html">ssl_.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  473</span><span class="keyword">def </span>is_ipaddress(hostname: str | bytes) -&gt; bool:</div>
<div class="line"><span class="lineno">  474</span>    <span class="stringliteral">&quot;&quot;&quot;Detects whether the hostname given is an IPv4 or IPv6 address.</span></div>
<div class="line"><span class="lineno">  475</span><span class="stringliteral">    Also detects IPv6 addresses with Zone IDs.</span></div>
<div class="line"><span class="lineno">  476</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  477</span><span class="stringliteral">    :param str hostname: Hostname to examine.</span></div>
<div class="line"><span class="lineno">  478</span><span class="stringliteral">    :return: True if the hostname is an IP address, False otherwise.</span></div>
<div class="line"><span class="lineno">  479</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  480</span>    <span class="keywordflow">if</span> isinstance(hostname, bytes):</div>
<div class="line"><span class="lineno">  481</span>        <span class="comment"># IDN A-label bytes are ASCII compatible.</span></div>
<div class="line"><span class="lineno">  482</span>        hostname = hostname.decode(<span class="stringliteral">&quot;ascii&quot;</span>)</div>
<div class="line"><span class="lineno">  483</span>    <span class="keywordflow">return</span> bool(_IPV4_RE.match(hostname) <span class="keywordflow">or</span> _BRACELESS_IPV6_ADDRZ_RE.match(hostname))</div>
<div class="line"><span class="lineno">  484</span> </div>
<div class="line"><span class="lineno">  485</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac7a8cf22d3515e5ecba535d79eed1db2" name="ac7a8cf22d3515e5ecba535d79eed1db2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7a8cf22d3515e5ecba535d79eed1db2">&#9670;&#160;</a></span>resolve_cert_reqs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> VerifyMode urllib3.util.ssl_.resolve_cert_reqs </td>
          <td>(</td>
          <td class="paramtype">None | int | str</td>          <td class="paramname"><span class="paramname"><em>candidate</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Resolves the argument to a numeric constant, which can be passed to
the wrap_socket function/method from the ssl module.
Defaults to :data:`ssl.CERT_REQUIRED`.
If given a string it is assumed to be the name of the constant in the
:mod:`ssl` module or its abbreviation.
(So you can specify `REQUIRED` instead of `CERT_REQUIRED`.
If it's neither `None` nor a string we assume it is already the numeric
constant which can directly be passed to wrap_socket.
</pre> 
<p class="definition">Definition at line <a class="el" href="urllib3_2util_2ssl___8py_source.html#l00184">184</a> of file <a class="el" href="urllib3_2util_2ssl___8py_source.html">ssl_.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  184</span><span class="keyword">def </span>resolve_cert_reqs(candidate: None | int | str) -&gt; VerifyMode:</div>
<div class="line"><span class="lineno">  185</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  186</span><span class="stringliteral">    Resolves the argument to a numeric constant, which can be passed to</span></div>
<div class="line"><span class="lineno">  187</span><span class="stringliteral">    the wrap_socket function/method from the ssl module.</span></div>
<div class="line"><span class="lineno">  188</span><span class="stringliteral">    Defaults to :data:`ssl.CERT_REQUIRED`.</span></div>
<div class="line"><span class="lineno">  189</span><span class="stringliteral">    If given a string it is assumed to be the name of the constant in the</span></div>
<div class="line"><span class="lineno">  190</span><span class="stringliteral">    :mod:`ssl` module or its abbreviation.</span></div>
<div class="line"><span class="lineno">  191</span><span class="stringliteral">    (So you can specify `REQUIRED` instead of `CERT_REQUIRED`.</span></div>
<div class="line"><span class="lineno">  192</span><span class="stringliteral">    If it&#39;s neither `None` nor a string we assume it is already the numeric</span></div>
<div class="line"><span class="lineno">  193</span><span class="stringliteral">    constant which can directly be passed to wrap_socket.</span></div>
<div class="line"><span class="lineno">  194</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  195</span>    <span class="keywordflow">if</span> candidate <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  196</span>        <span class="keywordflow">return</span> CERT_REQUIRED</div>
<div class="line"><span class="lineno">  197</span> </div>
<div class="line"><span class="lineno">  198</span>    <span class="keywordflow">if</span> isinstance(candidate, str):</div>
<div class="line"><span class="lineno">  199</span>        res = getattr(ssl, candidate, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  200</span>        <span class="keywordflow">if</span> res <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  201</span>            res = getattr(ssl, <span class="stringliteral">&quot;CERT_&quot;</span> + candidate)</div>
<div class="line"><span class="lineno">  202</span>        <span class="keywordflow">return</span> res  <span class="comment"># type: ignore[no-any-return]</span></div>
<div class="line"><span class="lineno">  203</span> </div>
<div class="line"><span class="lineno">  204</span>    <span class="keywordflow">return</span> candidate  <span class="comment"># type: ignore[return-value]</span></div>
<div class="line"><span class="lineno">  205</span> </div>
<div class="line"><span class="lineno">  206</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af7aa025f6f0f6a2d226f272c1b9b0275" name="af7aa025f6f0f6a2d226f272c1b9b0275"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7aa025f6f0f6a2d226f272c1b9b0275">&#9670;&#160;</a></span>resolve_ssl_version()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> int urllib3.util.ssl_.resolve_ssl_version </td>
          <td>(</td>
          <td class="paramtype">None | int | str</td>          <td class="paramname"><span class="paramname"><em>candidate</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">like resolve_cert_reqs
</pre> 
<p class="definition">Definition at line <a class="el" href="urllib3_2util_2ssl___8py_source.html#l00207">207</a> of file <a class="el" href="urllib3_2util_2ssl___8py_source.html">ssl_.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  207</span><span class="keyword">def </span>resolve_ssl_version(candidate: None | int | str) -&gt; int:</div>
<div class="line"><span class="lineno">  208</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  209</span><span class="stringliteral">    like resolve_cert_reqs</span></div>
<div class="line"><span class="lineno">  210</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  211</span>    <span class="keywordflow">if</span> candidate <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  212</span>        <span class="keywordflow">return</span> PROTOCOL_TLS</div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span>    <span class="keywordflow">if</span> isinstance(candidate, str):</div>
<div class="line"><span class="lineno">  215</span>        res = getattr(ssl, candidate, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  216</span>        <span class="keywordflow">if</span> res <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  217</span>            res = getattr(ssl, <span class="stringliteral">&quot;PROTOCOL_&quot;</span> + candidate)</div>
<div class="line"><span class="lineno">  218</span>        <span class="keywordflow">return</span> typing.cast(int, res)</div>
<div class="line"><span class="lineno">  219</span> </div>
<div class="line"><span class="lineno">  220</span>    <span class="keywordflow">return</span> candidate</div>
<div class="line"><span class="lineno">  221</span> </div>
<div class="line"><span class="lineno">  222</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="acce0cb270baf5b8740d6555b7819629e" name="acce0cb270baf5b8740d6555b7819629e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acce0cb270baf5b8740d6555b7819629e">&#9670;&#160;</a></span>ssl_wrap_socket() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ssl SSLSocket SSLTransportType urllib3.util.ssl_.ssl_wrap_socket </td>
          <td>(</td>
          <td class="paramtype">socket.socket</td>          <td class="paramname"><span class="paramname"><em>sock</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str|None</td>          <td class="paramname"><span class="paramname"><em>keyfile</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str|None</td>          <td class="paramname"><span class="paramname"><em>certfile</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int|None</td>          <td class="paramname"><span class="paramname"><em>cert_reqs</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str|None</td>          <td class="paramname"><span class="paramname"><em>ca_certs</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str|None</td>          <td class="paramname"><span class="paramname"><em>server_hostname</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int|None</td>          <td class="paramname"><span class="paramname"><em>ssl_version</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str|None</td>          <td class="paramname"><span class="paramname"><em>ciphers</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ssl.SSLContext|None</td>          <td class="paramname"><span class="paramname"><em>ssl_context</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str|None</td>          <td class="paramname"><span class="paramname"><em>ca_cert_dir</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str|None</td>          <td class="paramname"><span class="paramname"><em>key_password</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">None|str|bytes</td>          <td class="paramname"><span class="paramname"><em>ca_cert_data</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>tls_in_tls</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">All arguments except for server_hostname, ssl_context, tls_in_tls, ca_cert_data and
ca_cert_dir have the same meaning as they do when using
:func:`ssl.create_default_context`, :meth:`ssl.SSLContext.load_cert_chain`,
:meth:`ssl.SSLContext.set_ciphers` and :meth:`ssl.SSLContext.wrap_socket`.

:param server_hostname:
    When SNI is supported, the expected hostname of the certificate
:param ssl_context:
    A pre-made :class:`SSLContext` object. If none is provided, one will
    be created using :func:`create_urllib3_context`.
:param ciphers:
    A string of ciphers we wish the client to support.
:param ca_cert_dir:
    A directory containing CA certificates in multiple separate files, as
    supported by OpenSSL's -CApath flag or the capath argument to
    SSLContext.load_verify_locations().
:param key_password:
    Optional password if the keyfile is encrypted.
:param ca_cert_data:
    Optional string containing CA certificates in PEM format suitable for
    passing as the cadata parameter to SSLContext.load_verify_locations()
:param tls_in_tls:
    Use SSLTransport to wrap the existing socket.
</pre> 
<p class="definition">Definition at line <a class="el" href="urllib3_2util_2ssl___8py_source.html#l00381">381</a> of file <a class="el" href="urllib3_2util_2ssl___8py_source.html">ssl_.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  395</span>) -&gt; ssl.SSLSocket | SSLTransportType:</div>
<div class="line"><span class="lineno">  396</span>    ...</div>
<div class="line"><span class="lineno">  397</span> </div>
<div class="line"><span class="lineno">  398</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="urllib3_2util_2ssl___8py_source.html#l00486">_is_key_file_encrypted()</a>, <a class="el" href="urllib3_2util_2ssl___8py_source.html#l00502">_ssl_wrap_socket_impl()</a>, and <a class="el" href="urllib3_2util_2ssl___8py_source.html#l00230">create_urllib3_context()</a>.</p>

</div>
</div>
<a id="a874f350ac8544608d4525ea92d2b230a" name="a874f350ac8544608d4525ea92d2b230a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a874f350ac8544608d4525ea92d2b230a">&#9670;&#160;</a></span>ssl_wrap_socket() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> ssl.SSLSocket urllib3.util.ssl_.ssl_wrap_socket </td>
          <td>(</td>
          <td class="paramtype">socket.socket</td>          <td class="paramname"><span class="paramname"><em>sock</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str | None </td>          <td class="paramname"><span class="paramname"><em>keyfile</em></span><span class="paramdefsep"> = </span><span class="paramdefval">...</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str | None </td>          <td class="paramname"><span class="paramname"><em>certfile</em></span><span class="paramdefsep"> = </span><span class="paramdefval">...</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int | None </td>          <td class="paramname"><span class="paramname"><em>cert_reqs</em></span><span class="paramdefsep"> = </span><span class="paramdefval">...</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str | None </td>          <td class="paramname"><span class="paramname"><em>ca_certs</em></span><span class="paramdefsep"> = </span><span class="paramdefval">...</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str | None </td>          <td class="paramname"><span class="paramname"><em>server_hostname</em></span><span class="paramdefsep"> = </span><span class="paramdefval">...</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int | None </td>          <td class="paramname"><span class="paramname"><em>ssl_version</em></span><span class="paramdefsep"> = </span><span class="paramdefval">...</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str | None </td>          <td class="paramname"><span class="paramname"><em>ciphers</em></span><span class="paramdefsep"> = </span><span class="paramdefval">...</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ssl.SSLContext | None </td>          <td class="paramname"><span class="paramname"><em>ssl_context</em></span><span class="paramdefsep"> = </span><span class="paramdefval">...</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str | None </td>          <td class="paramname"><span class="paramname"><em>ca_cert_dir</em></span><span class="paramdefsep"> = </span><span class="paramdefval">...</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str | None </td>          <td class="paramname"><span class="paramname"><em>key_password</em></span><span class="paramdefsep"> = </span><span class="paramdefval">...</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">None | str | bytes </td>          <td class="paramname"><span class="paramname"><em>ca_cert_data</em></span><span class="paramdefsep"> = </span><span class="paramdefval">...</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">typing.Literal[False] </td>          <td class="paramname"><span class="paramname"><em>tls_in_tls</em></span><span class="paramdefsep"> = </span><span class="paramdefval">...</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="urllib3_2util_2ssl___8py_source.html#l00362">362</a> of file <a class="el" href="urllib3_2util_2ssl___8py_source.html">ssl_.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  376</span>) -&gt; ssl.SSLSocket:</div>
<div class="line"><span class="lineno">  377</span>    ...</div>
<div class="line"><span class="lineno">  378</span> </div>
<div class="line"><span class="lineno">  379</span> </div>
<div class="line"><span class="lineno">  380</span><span class="preprocessor">@typing.overload</span></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aa05af2713c4ef95c7ec6ba90a0889e97" name="aa05af2713c4ef95c7ec6ba90a0889e97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa05af2713c4ef95c7ec6ba90a0889e97">&#9670;&#160;</a></span>_TYPE_PEER_CERT_RET</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">urllib3.util.ssl_._TYPE_PEER_CERT_RET = typing.Union[&quot;_TYPE_PEER_CERT_RET_DICT&quot;, bytes, None]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="urllib3_2util_2ssl___8py_source.html#l00147">147</a> of file <a class="el" href="urllib3_2util_2ssl___8py_source.html">ssl_.py</a>.</p>

</div>
</div>
<a id="ae4018d3af25aa05b53c4f890edfb9ec6" name="ae4018d3af25aa05b53c4f890edfb9ec6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4018d3af25aa05b53c4f890edfb9ec6">&#9670;&#160;</a></span>_TYPE_VERSION_INFO</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">urllib3.util.ssl_._TYPE_VERSION_INFO = typing.Tuple[int, int, int, str, int]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="urllib3_2util_2ssl___8py_source.html#l00021">21</a> of file <a class="el" href="urllib3_2util_2ssl___8py_source.html">ssl_.py</a>.</p>

</div>
</div>
<a id="a80e5166bab0b9d1ceab20dc2ad33f565" name="a80e5166bab0b9d1ceab20dc2ad33f565"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80e5166bab0b9d1ceab20dc2ad33f565">&#9670;&#160;</a></span>ALPN_PROTOCOLS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">list urllib3.util.ssl_.ALPN_PROTOCOLS = [&quot;http/1.1&quot;]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="urllib3_2util_2ssl___8py_source.html#l00019">19</a> of file <a class="el" href="urllib3_2util_2ssl___8py_source.html">ssl_.py</a>.</p>

</div>
</div>
<a id="ab4f6cd642aab550092955c5188362b4e" name="ab4f6cd642aab550092955c5188362b4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4f6cd642aab550092955c5188362b4e">&#9670;&#160;</a></span>HAS_NEVER_CHECK_COMMON_NAME</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool urllib3.util.ssl_.HAS_NEVER_CHECK_COMMON_NAME = False</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="urllib3_2util_2ssl___8py_source.html#l00017">17</a> of file <a class="el" href="urllib3_2util_2ssl___8py_source.html">ssl_.py</a>.</p>

</div>
</div>
<a id="a5019f6ad2ab04a28668db2a0d56876a1" name="a5019f6ad2ab04a28668db2a0d56876a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5019f6ad2ab04a28668db2a0d56876a1">&#9670;&#160;</a></span>HASHFUNC_MAP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dict urllib3.util.ssl_.HASHFUNC_MAP</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  {</div>
<div class="line"><span class="lineno">    2</span>    length: getattr(hashlib, algorithm, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">    3</span>    <span class="keywordflow">for</span> length, algorithm <span class="keywordflow">in</span> ((32, <span class="stringliteral">&quot;md5&quot;</span>), (40, <span class="stringliteral">&quot;sha1&quot;</span>), (64, <span class="stringliteral">&quot;sha256&quot;</span>))</div>
<div class="line"><span class="lineno">    4</span>}</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="urllib3_2util_2ssl___8py_source.html#l00024">24</a> of file <a class="el" href="urllib3_2util_2ssl___8py_source.html">ssl_.py</a>.</p>

</div>
</div>
<a id="a0181b63e45ecce7d6421c33795617a6d" name="a0181b63e45ecce7d6421c33795617a6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0181b63e45ecce7d6421c33795617a6d">&#9670;&#160;</a></span>IS_PYOPENSSL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool urllib3.util.ssl_.IS_PYOPENSSL = False</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="urllib3_2util_2ssl___8py_source.html#l00018">18</a> of file <a class="el" href="urllib3_2util_2ssl___8py_source.html">ssl_.py</a>.</p>

</div>
</div>
<a id="aec1224c620f6b839da0a62b504683441" name="aec1224c620f6b839da0a62b504683441"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec1224c620f6b839da0a62b504683441">&#9670;&#160;</a></span>OP_NO_COMPRESSION</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int urllib3.util.ssl_.OP_NO_COMPRESSION = 0x20000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="urllib3_2util_2ssl___8py_source.html#l00139">139</a> of file <a class="el" href="urllib3_2util_2ssl___8py_source.html">ssl_.py</a>.</p>

</div>
</div>
<a id="adc46caf66ed7964e720114ce4ca3503a" name="adc46caf66ed7964e720114ce4ca3503a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc46caf66ed7964e720114ce4ca3503a">&#9670;&#160;</a></span>OP_NO_SSLv2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int urllib3.util.ssl_.OP_NO_SSLv2 = 0x1000000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="urllib3_2util_2ssl___8py_source.html#l00141">141</a> of file <a class="el" href="urllib3_2util_2ssl___8py_source.html">ssl_.py</a>.</p>

</div>
</div>
<a id="a4d4bffa5c1bc3ca198213da4dc22c6e2" name="a4d4bffa5c1bc3ca198213da4dc22c6e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d4bffa5c1bc3ca198213da4dc22c6e2">&#9670;&#160;</a></span>OP_NO_SSLv3</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int urllib3.util.ssl_.OP_NO_SSLv3 = 0x2000000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="urllib3_2util_2ssl___8py_source.html#l00142">142</a> of file <a class="el" href="urllib3_2util_2ssl___8py_source.html">ssl_.py</a>.</p>

</div>
</div>
<a id="af41f5e1ea91de40d636270ebbb660f4d" name="af41f5e1ea91de40d636270ebbb660f4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af41f5e1ea91de40d636270ebbb660f4d">&#9670;&#160;</a></span>OP_NO_TICKET</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int urllib3.util.ssl_.OP_NO_TICKET = 0x4000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="urllib3_2util_2ssl___8py_source.html#l00140">140</a> of file <a class="el" href="urllib3_2util_2ssl___8py_source.html">ssl_.py</a>.</p>

</div>
</div>
<a id="a463088c4f4234cc0ea92aa6b86bec232" name="a463088c4f4234cc0ea92aa6b86bec232"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a463088c4f4234cc0ea92aa6b86bec232">&#9670;&#160;</a></span>PROTOCOL_SSLv23</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int urllib3.util.ssl_.PROTOCOL_SSLv23 = PROTOCOL_TLS</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="urllib3_2util_2ssl___8py_source.html#l00114">114</a> of file <a class="el" href="urllib3_2util_2ssl___8py_source.html">ssl_.py</a>.</p>

</div>
</div>
<a id="a5310ffd91418a5c6dcbbf074c2828551" name="a5310ffd91418a5c6dcbbf074c2828551"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5310ffd91418a5c6dcbbf074c2828551">&#9670;&#160;</a></span>PROTOCOL_TLS_CLIENT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int urllib3.util.ssl_.PROTOCOL_TLS_CLIENT = 16</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="urllib3_2util_2ssl___8py_source.html#l00144">144</a> of file <a class="el" href="urllib3_2util_2ssl___8py_source.html">ssl_.py</a>.</p>

</div>
</div>
<a id="a7a253de14f2b8023a70529697faefa45" name="a7a253de14f2b8023a70529697faefa45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a253de14f2b8023a70529697faefa45">&#9670;&#160;</a></span>SSLContext</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">urllib3.util.ssl_.SSLContext = None</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="urllib3_2util_2ssl___8py_source.html#l00015">15</a> of file <a class="el" href="urllib3_2util_2ssl___8py_source.html">ssl_.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="urllib3_2util_2ssl___8py_source.html#l00230">create_urllib3_context()</a>.</p>

</div>
</div>
<a id="aa410d07f935b7fbf691a75edffab840a" name="aa410d07f935b7fbf691a75edffab840a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa410d07f935b7fbf691a75edffab840a">&#9670;&#160;</a></span>SSLTransport</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classurllib3_1_1util_1_1ssltransport_1_1_s_s_l_transport.html">urllib3.util.ssl_.SSLTransport</a> = None</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="urllib3_2util_2ssl___8py_source.html#l00016">16</a> of file <a class="el" href="urllib3_2util_2ssl___8py_source.html">ssl_.py</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceurllib3.html">urllib3</a></li><li class="navelem"><a class="el" href="namespaceurllib3_1_1util.html">util</a></li><li class="navelem"><a class="el" href="namespaceurllib3_1_1util_1_1ssl__.html">ssl_</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
