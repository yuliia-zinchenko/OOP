<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Read&amp;Watch: django.db.migrations.autodetector.MigrationAutodetector Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Read&amp;Watch<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('classdjango_1_1db_1_1migrations_1_1autodetector_1_1_migration_autodetector.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-static-methods">Static Protected Member Functions</a> &#124;
<a href="classdjango_1_1db_1_1migrations_1_1autodetector_1_1_migration_autodetector-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">django.db.migrations.autodetector.MigrationAutodetector Class Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:af4f8607558027a963f6323c4d2d7045d" id="r_af4f8607558027a963f6323c4d2d7045d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af4f8607558027a963f6323c4d2d7045d">__init__</a> (self, <a class="el" href="#ae3935993133c78ec4bcac747661221c6">from_state</a>, <a class="el" href="#ae481e4bba8448edbffe5eda74a7169bd">to_state</a>, <a class="el" href="#a76aec2ce3dd7c311c1b6c45933c3e81c">questioner</a>=None)</td></tr>
<tr class="separator:af4f8607558027a963f6323c4d2d7045d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4696ea29c1b4635ca86503a8e783daea" id="r_a4696ea29c1b4635ca86503a8e783daea"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4696ea29c1b4635ca86503a8e783daea">changes</a> (self, graph, trim_to_apps=None, convert_apps=None, migration_name=None)</td></tr>
<tr class="separator:a4696ea29c1b4635ca86503a8e783daea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2b9756b837752ed199a9e1173013953" id="r_ad2b9756b837752ed199a9e1173013953"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad2b9756b837752ed199a9e1173013953">deep_deconstruct</a> (self, obj)</td></tr>
<tr class="separator:ad2b9756b837752ed199a9e1173013953"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d06b0d4ccc0bce4efdddacee94f57c2" id="r_a1d06b0d4ccc0bce4efdddacee94f57c2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1d06b0d4ccc0bce4efdddacee94f57c2">only_relation_agnostic_fields</a> (self, fields)</td></tr>
<tr class="separator:a1d06b0d4ccc0bce4efdddacee94f57c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac815919af3b9cbeb745bff957f72a832" id="r_ac815919af3b9cbeb745bff957f72a832"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac815919af3b9cbeb745bff957f72a832">check_dependency</a> (self, operation, dependency)</td></tr>
<tr class="separator:ac815919af3b9cbeb745bff957f72a832"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab850e8f1f5f9c7b2778025c9dfc16d7d" id="r_ab850e8f1f5f9c7b2778025c9dfc16d7d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab850e8f1f5f9c7b2778025c9dfc16d7d">add_operation</a> (self, app_label, operation, dependencies=None, beginning=False)</td></tr>
<tr class="separator:ab850e8f1f5f9c7b2778025c9dfc16d7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa10b4b0cac4ad4a34f83478c2592af4a" id="r_aa10b4b0cac4ad4a34f83478c2592af4a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa10b4b0cac4ad4a34f83478c2592af4a">swappable_first_key</a> (self, item)</td></tr>
<tr class="separator:aa10b4b0cac4ad4a34f83478c2592af4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21e8d95f6652845410c17519744e77fb" id="r_a21e8d95f6652845410c17519744e77fb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a21e8d95f6652845410c17519744e77fb">generate_renamed_models</a> (self)</td></tr>
<tr class="separator:a21e8d95f6652845410c17519744e77fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13e6732c0e8501ff2ab490f71e0ea527" id="r_a13e6732c0e8501ff2ab490f71e0ea527"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a13e6732c0e8501ff2ab490f71e0ea527">generate_created_models</a> (self)</td></tr>
<tr class="separator:a13e6732c0e8501ff2ab490f71e0ea527"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3221ae34e5a26be8a8d61cc9931e02ff" id="r_a3221ae34e5a26be8a8d61cc9931e02ff"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3221ae34e5a26be8a8d61cc9931e02ff">generate_created_proxies</a> (self)</td></tr>
<tr class="separator:a3221ae34e5a26be8a8d61cc9931e02ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cbca66c331add1d0a571aa75126df10" id="r_a5cbca66c331add1d0a571aa75126df10"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5cbca66c331add1d0a571aa75126df10">generate_deleted_models</a> (self)</td></tr>
<tr class="separator:a5cbca66c331add1d0a571aa75126df10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae468ca67a71f52051a2445ff1e6af344" id="r_ae468ca67a71f52051a2445ff1e6af344"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae468ca67a71f52051a2445ff1e6af344">generate_deleted_proxies</a> (self)</td></tr>
<tr class="separator:ae468ca67a71f52051a2445ff1e6af344"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3587aaa027f205a5203c2233d15a523" id="r_ae3587aaa027f205a5203c2233d15a523"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae3587aaa027f205a5203c2233d15a523">create_renamed_fields</a> (self)</td></tr>
<tr class="separator:ae3587aaa027f205a5203c2233d15a523"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadb22b62b82ef0aa2d94eb721f521365" id="r_aadb22b62b82ef0aa2d94eb721f521365"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aadb22b62b82ef0aa2d94eb721f521365">generate_renamed_fields</a> (self)</td></tr>
<tr class="separator:aadb22b62b82ef0aa2d94eb721f521365"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a302d84d2e59111135d429b10f40bb116" id="r_a302d84d2e59111135d429b10f40bb116"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a302d84d2e59111135d429b10f40bb116">generate_added_fields</a> (self)</td></tr>
<tr class="separator:a302d84d2e59111135d429b10f40bb116"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac11651cbda2fdf185635eb7d43b030ef" id="r_ac11651cbda2fdf185635eb7d43b030ef"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac11651cbda2fdf185635eb7d43b030ef">generate_removed_fields</a> (self)</td></tr>
<tr class="separator:ac11651cbda2fdf185635eb7d43b030ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68b05da25c37d259cac6acd0901ee3b8" id="r_a68b05da25c37d259cac6acd0901ee3b8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a68b05da25c37d259cac6acd0901ee3b8">generate_altered_fields</a> (self)</td></tr>
<tr class="separator:a68b05da25c37d259cac6acd0901ee3b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92cb0262ede8e1b9ee8a43b1e02c5b19" id="r_a92cb0262ede8e1b9ee8a43b1e02c5b19"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a92cb0262ede8e1b9ee8a43b1e02c5b19">create_altered_indexes</a> (self)</td></tr>
<tr class="separator:a92cb0262ede8e1b9ee8a43b1e02c5b19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aced4ba08266d4a00fec2cce47180dce1" id="r_aced4ba08266d4a00fec2cce47180dce1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aced4ba08266d4a00fec2cce47180dce1">generate_added_indexes</a> (self)</td></tr>
<tr class="separator:aced4ba08266d4a00fec2cce47180dce1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f8f521964bf110849a7b59f1d1d9757" id="r_a6f8f521964bf110849a7b59f1d1d9757"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6f8f521964bf110849a7b59f1d1d9757">generate_removed_indexes</a> (self)</td></tr>
<tr class="separator:a6f8f521964bf110849a7b59f1d1d9757"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bdde89b9f00807bff9bb4dcf26974d3" id="r_a6bdde89b9f00807bff9bb4dcf26974d3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6bdde89b9f00807bff9bb4dcf26974d3">generate_renamed_indexes</a> (self)</td></tr>
<tr class="separator:a6bdde89b9f00807bff9bb4dcf26974d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accebcade56b0cdd94ad2f13658d94a01" id="r_accebcade56b0cdd94ad2f13658d94a01"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#accebcade56b0cdd94ad2f13658d94a01">create_altered_constraints</a> (self)</td></tr>
<tr class="separator:accebcade56b0cdd94ad2f13658d94a01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36432e3a53fb7898e4d6aa8d93ad8138" id="r_a36432e3a53fb7898e4d6aa8d93ad8138"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a36432e3a53fb7898e4d6aa8d93ad8138">generate_added_constraints</a> (self)</td></tr>
<tr class="separator:a36432e3a53fb7898e4d6aa8d93ad8138"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51bafeed131e7021ef4ef1b5fb0426ea" id="r_a51bafeed131e7021ef4ef1b5fb0426ea"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a51bafeed131e7021ef4ef1b5fb0426ea">generate_removed_constraints</a> (self)</td></tr>
<tr class="separator:a51bafeed131e7021ef4ef1b5fb0426ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3f64632734cb26b5afafb67c1ad4aaa" id="r_ab3f64632734cb26b5afafb67c1ad4aaa"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab3f64632734cb26b5afafb67c1ad4aaa">generate_removed_altered_unique_together</a> (self)</td></tr>
<tr class="separator:ab3f64632734cb26b5afafb67c1ad4aaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9526d41d7e0f7b573e329bda9c5cb75d" id="r_a9526d41d7e0f7b573e329bda9c5cb75d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9526d41d7e0f7b573e329bda9c5cb75d">generate_altered_unique_together</a> (self)</td></tr>
<tr class="separator:a9526d41d7e0f7b573e329bda9c5cb75d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ea941633830129d9fe71e57d9aec5d5" id="r_a6ea941633830129d9fe71e57d9aec5d5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6ea941633830129d9fe71e57d9aec5d5">generate_altered_db_table</a> (self)</td></tr>
<tr class="separator:a6ea941633830129d9fe71e57d9aec5d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a01de641473d7c1342d5f7336cfb598" id="r_a5a01de641473d7c1342d5f7336cfb598"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5a01de641473d7c1342d5f7336cfb598">generate_altered_db_table_comment</a> (self)</td></tr>
<tr class="separator:a5a01de641473d7c1342d5f7336cfb598"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8b0b29606d2f848c9de8e284aa9c288" id="r_ae8b0b29606d2f848c9de8e284aa9c288"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae8b0b29606d2f848c9de8e284aa9c288">generate_altered_options</a> (self)</td></tr>
<tr class="separator:ae8b0b29606d2f848c9de8e284aa9c288"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbaaa4665aafce84671990dd6cfa570c" id="r_afbaaa4665aafce84671990dd6cfa570c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afbaaa4665aafce84671990dd6cfa570c">generate_altered_order_with_respect_to</a> (self)</td></tr>
<tr class="separator:afbaaa4665aafce84671990dd6cfa570c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61d033562bb5b6f174e5c686fdc9a228" id="r_a61d033562bb5b6f174e5c686fdc9a228"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a61d033562bb5b6f174e5c686fdc9a228">generate_altered_managers</a> (self)</td></tr>
<tr class="separator:a61d033562bb5b6f174e5c686fdc9a228"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3852d6daf5512e9f448cd023a824a7ef" id="r_a3852d6daf5512e9f448cd023a824a7ef"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3852d6daf5512e9f448cd023a824a7ef">arrange_for_graph</a> (self, <a class="el" href="#a4696ea29c1b4635ca86503a8e783daea">changes</a>, graph, migration_name=None)</td></tr>
<tr class="separator:a3852d6daf5512e9f448cd023a824a7ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a1dae6fc864c1f8fc65f77538e9267d" id="r_a4a1dae6fc864c1f8fc65f77538e9267d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4a1dae6fc864c1f8fc65f77538e9267d">parse_number</a> (cls, name)</td></tr>
<tr class="separator:a4a1dae6fc864c1f8fc65f77538e9267d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:ae3935993133c78ec4bcac747661221c6" id="r_ae3935993133c78ec4bcac747661221c6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae3935993133c78ec4bcac747661221c6">from_state</a> = from_state</td></tr>
<tr class="separator:ae3935993133c78ec4bcac747661221c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae481e4bba8448edbffe5eda74a7169bd" id="r_ae481e4bba8448edbffe5eda74a7169bd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae481e4bba8448edbffe5eda74a7169bd">to_state</a> = to_state</td></tr>
<tr class="separator:ae481e4bba8448edbffe5eda74a7169bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76aec2ce3dd7c311c1b6c45933c3e81c" id="r_a76aec2ce3dd7c311c1b6c45933c3e81c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a76aec2ce3dd7c311c1b6c45933c3e81c">questioner</a> = questioner or <a class="el" href="classdjango_1_1db_1_1migrations_1_1questioner_1_1_migration_questioner.html">MigrationQuestioner</a>()</td></tr>
<tr class="separator:a76aec2ce3dd7c311c1b6c45933c3e81c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae567bfab90e6fa7354a80b80f828bad5" id="r_ae567bfab90e6fa7354a80b80f828bad5"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae567bfab90e6fa7354a80b80f828bad5">existing_apps</a> = {app for app, model in from_state.models}</td></tr>
<tr class="separator:ae567bfab90e6fa7354a80b80f828bad5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae064abf9d094023a19f4afcaa8e83bd6" id="r_ae064abf9d094023a19f4afcaa8e83bd6"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae064abf9d094023a19f4afcaa8e83bd6">generated_operations</a> = {}</td></tr>
<tr class="separator:ae064abf9d094023a19f4afcaa8e83bd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b0c1f89f9c779cd0191d30f1633b5f3" id="r_a2b0c1f89f9c779cd0191d30f1633b5f3"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2b0c1f89f9c779cd0191d30f1633b5f3">altered_indexes</a> = {}</td></tr>
<tr class="separator:a2b0c1f89f9c779cd0191d30f1633b5f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b156d6f6452ffc33f685217ce32870a" id="r_a5b156d6f6452ffc33f685217ce32870a"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5b156d6f6452ffc33f685217ce32870a">altered_constraints</a> = {}</td></tr>
<tr class="separator:a5b156d6f6452ffc33f685217ce32870a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afddac3c1d0bf574757c8baada184a75b" id="r_afddac3c1d0bf574757c8baada184a75b"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afddac3c1d0bf574757c8baada184a75b">renamed_fields</a> = {}</td></tr>
<tr class="separator:afddac3c1d0bf574757c8baada184a75b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27fc3da1c7714b60fc3ddd078e9eaf7b" id="r_a27fc3da1c7714b60fc3ddd078e9eaf7b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a27fc3da1c7714b60fc3ddd078e9eaf7b">old_model_keys</a> = set()</td></tr>
<tr class="separator:a27fc3da1c7714b60fc3ddd078e9eaf7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65fe03dbaad2fc1a6f9687c9d394819e" id="r_a65fe03dbaad2fc1a6f9687c9d394819e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a65fe03dbaad2fc1a6f9687c9d394819e">old_proxy_keys</a> = set()</td></tr>
<tr class="separator:a65fe03dbaad2fc1a6f9687c9d394819e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a475932761b0856d91b3bd5cd6f4e29d9" id="r_a475932761b0856d91b3bd5cd6f4e29d9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a475932761b0856d91b3bd5cd6f4e29d9">old_unmanaged_keys</a> = set()</td></tr>
<tr class="separator:a475932761b0856d91b3bd5cd6f4e29d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca782281b2c8f16702d8a7cfa97e6a04" id="r_aca782281b2c8f16702d8a7cfa97e6a04"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aca782281b2c8f16702d8a7cfa97e6a04">new_model_keys</a> = set()</td></tr>
<tr class="separator:aca782281b2c8f16702d8a7cfa97e6a04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac813b271465b35a1ab0f7e0176e169d8" id="r_ac813b271465b35a1ab0f7e0176e169d8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac813b271465b35a1ab0f7e0176e169d8">new_proxy_keys</a> = set()</td></tr>
<tr class="separator:ac813b271465b35a1ab0f7e0176e169d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4119d514d649df84612160f721638c00" id="r_a4119d514d649df84612160f721638c00"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4119d514d649df84612160f721638c00">new_unmanaged_keys</a> = set()</td></tr>
<tr class="separator:a4119d514d649df84612160f721638c00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ff0aef9e237d17156720d41d2b674e7" id="r_a9ff0aef9e237d17156720d41d2b674e7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9ff0aef9e237d17156720d41d2b674e7">kept_model_keys</a> = self.old_model_keys &amp; self.new_model_keys</td></tr>
<tr class="separator:a9ff0aef9e237d17156720d41d2b674e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a303f64576427a2fa5166fb13aacaa696" id="r_a303f64576427a2fa5166fb13aacaa696"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a303f64576427a2fa5166fb13aacaa696">kept_proxy_keys</a> = self.old_proxy_keys &amp; self.new_proxy_keys</td></tr>
<tr class="separator:a303f64576427a2fa5166fb13aacaa696"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f95191e638375e25599d9b4e5adff5d" id="r_a1f95191e638375e25599d9b4e5adff5d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1f95191e638375e25599d9b4e5adff5d">kept_unmanaged_keys</a> = self.old_unmanaged_keys &amp; self.new_unmanaged_keys</td></tr>
<tr class="separator:a1f95191e638375e25599d9b4e5adff5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac99ba9cb443efb4f6cb55f1dc8e0782b" id="r_ac99ba9cb443efb4f6cb55f1dc8e0782b"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac99ba9cb443efb4f6cb55f1dc8e0782b">through_users</a> = {}</td></tr>
<tr class="separator:ac99ba9cb443efb4f6cb55f1dc8e0782b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bd81319931b2d3d1f9082073a4fe1a4" id="r_a7bd81319931b2d3d1f9082073a4fe1a4"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7bd81319931b2d3d1f9082073a4fe1a4">old_field_keys</a></td></tr>
<tr class="separator:a7bd81319931b2d3d1f9082073a4fe1a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa115c366a5aaf355cc6af5992fa1636c" id="r_aa115c366a5aaf355cc6af5992fa1636c"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa115c366a5aaf355cc6af5992fa1636c">new_field_keys</a></td></tr>
<tr class="separator:aa115c366a5aaf355cc6af5992fa1636c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af008e8fdb39f73d34d831c6872079d48" id="r_af008e8fdb39f73d34d831c6872079d48"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af008e8fdb39f73d34d831c6872079d48">migrations</a> = {}</td></tr>
<tr class="separator:af008e8fdb39f73d34d831c6872079d48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf7c12b831f5771f0d1b69882c1e310e" id="r_acf7c12b831f5771f0d1b69882c1e310e"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acf7c12b831f5771f0d1b69882c1e310e">renamed_models</a> = {}</td></tr>
<tr class="separator:acf7c12b831f5771f0d1b69882c1e310e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a346b69907bdc87ee21f61b4e31a23392" id="r_a346b69907bdc87ee21f61b4e31a23392"><td class="memItemLeft" align="right" valign="top">dict&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a346b69907bdc87ee21f61b4e31a23392">renamed_models_rel</a> = {}</td></tr>
<tr class="separator:a346b69907bdc87ee21f61b4e31a23392"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf862f92cdb4ae7784c197ab87569383" id="r_adf862f92cdb4ae7784c197ab87569383"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adf862f92cdb4ae7784c197ab87569383">renamed_operations</a> = []</td></tr>
<tr class="separator:adf862f92cdb4ae7784c197ab87569383"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69d602dfd71c9a08b938c8ceadcf59ec" id="r_a69d602dfd71c9a08b938c8ceadcf59ec"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a69d602dfd71c9a08b938c8ceadcf59ec">renamed_index_together_values</a> = defaultdict(list)</td></tr>
<tr class="separator:a69d602dfd71c9a08b938c8ceadcf59ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a0a496118f7886c478ba712d9f09207c4" id="r_a0a496118f7886c478ba712d9f09207c4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0a496118f7886c478ba712d9f09207c4">_detect_changes</a> (self, convert_apps=None, graph=None)</td></tr>
<tr class="separator:a0a496118f7886c478ba712d9f09207c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb723c91a61c6bd693bc564ec7700094" id="r_aeb723c91a61c6bd693bc564ec7700094"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aeb723c91a61c6bd693bc564ec7700094">_prepare_field_lists</a> (self)</td></tr>
<tr class="separator:aeb723c91a61c6bd693bc564ec7700094"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61b58944d9063935cf1799dc0e48b3ca" id="r_a61b58944d9063935cf1799dc0e48b3ca"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a61b58944d9063935cf1799dc0e48b3ca">_generate_through_model_map</a> (self)</td></tr>
<tr class="separator:a61b58944d9063935cf1799dc0e48b3ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ba31d77a1d6d194684586f67e94dd5f" id="r_a6ba31d77a1d6d194684586f67e94dd5f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6ba31d77a1d6d194684586f67e94dd5f">_build_migration_list</a> (self, graph=None)</td></tr>
<tr class="separator:a6ba31d77a1d6d194684586f67e94dd5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadbf9eff5b651a399ac12160ec87268d" id="r_aadbf9eff5b651a399ac12160ec87268d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aadbf9eff5b651a399ac12160ec87268d">_sort_migrations</a> (self)</td></tr>
<tr class="separator:aadbf9eff5b651a399ac12160ec87268d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed2332394c41ad52b612ce1fba030203" id="r_aed2332394c41ad52b612ce1fba030203"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aed2332394c41ad52b612ce1fba030203">_optimize_migrations</a> (self)</td></tr>
<tr class="separator:aed2332394c41ad52b612ce1fba030203"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f11eab1f17f29ea3a22d0bec9a8f817" id="r_a9f11eab1f17f29ea3a22d0bec9a8f817"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9f11eab1f17f29ea3a22d0bec9a8f817">_generate_added_field</a> (self, app_label, model_name, field_name)</td></tr>
<tr class="separator:a9f11eab1f17f29ea3a22d0bec9a8f817"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb5562b23c4212e6b63842b7807c9930" id="r_aeb5562b23c4212e6b63842b7807c9930"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aeb5562b23c4212e6b63842b7807c9930">_generate_removed_field</a> (self, app_label, model_name, field_name)</td></tr>
<tr class="separator:aeb5562b23c4212e6b63842b7807c9930"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe541446ed73d613d58e5abe17cd26a4" id="r_afe541446ed73d613d58e5abe17cd26a4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afe541446ed73d613d58e5abe17cd26a4">_get_dependencies_for_generated_field</a> (self, field)</td></tr>
<tr class="separator:afe541446ed73d613d58e5abe17cd26a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab770f9239b4d6781119f4f63aaf0f3e6" id="r_ab770f9239b4d6781119f4f63aaf0f3e6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab770f9239b4d6781119f4f63aaf0f3e6">_get_dependencies_for_model</a> (self, app_label, model_name)</td></tr>
<tr class="separator:ab770f9239b4d6781119f4f63aaf0f3e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74614c75f069e8a50707e09571ffd0f1" id="r_a74614c75f069e8a50707e09571ffd0f1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a74614c75f069e8a50707e09571ffd0f1">_get_altered_foo_together_operations</a> (self, option_name)</td></tr>
<tr class="separator:a74614c75f069e8a50707e09571ffd0f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7481f9bb2437a66cbfb3e5c9bb32d894" id="r_a7481f9bb2437a66cbfb3e5c9bb32d894"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7481f9bb2437a66cbfb3e5c9bb32d894">_generate_removed_altered_foo_together</a> (self, operation)</td></tr>
<tr class="separator:a7481f9bb2437a66cbfb3e5c9bb32d894"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e8404d91c4858887de003a3e505867e" id="r_a4e8404d91c4858887de003a3e505867e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4e8404d91c4858887de003a3e505867e">_generate_altered_foo_together</a> (self, operation)</td></tr>
<tr class="separator:a4e8404d91c4858887de003a3e505867e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0cbb037c36507a24606be2034089d212" id="r_a0cbb037c36507a24606be2034089d212"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0cbb037c36507a24606be2034089d212">_trim_to_apps</a> (self, <a class="el" href="#a4696ea29c1b4635ca86503a8e783daea">changes</a>, app_labels)</td></tr>
<tr class="separator:a0cbb037c36507a24606be2034089d212"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-static-methods" name="pro-static-methods"></a>
Static Protected Member Functions</h2></td></tr>
<tr class="memitem:acc8b2e0c968b56ed2e12115feaececcb" id="r_acc8b2e0c968b56ed2e12115feaececcb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acc8b2e0c968b56ed2e12115feaececcb">_resolve_dependency</a> (dependency)</td></tr>
<tr class="separator:acc8b2e0c968b56ed2e12115feaececcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a349c6610cd9e186a0b21fa556c4fb52d" id="r_a349c6610cd9e186a0b21fa556c4fb52d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a349c6610cd9e186a0b21fa556c4fb52d">_get_dependencies_for_foreign_key</a> (app_label, model_name, field, project_state)</td></tr>
<tr class="separator:a349c6610cd9e186a0b21fa556c4fb52d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Take a pair of ProjectStates and compare them to see what the first would
need doing to make it match the second (the second usually being the
project's current state).

Note that this naturally operates on entire projects at a time,
as it's likely that changes interact (for example, you can't
add a ForeignKey without having a migration to add the table it
depends on first). A user interface may offer single-app usage
if it wishes, with the caveat that it may not always be possible.
</pre> 
<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00042">42</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="af4f8607558027a963f6323c4d2d7045d" name="af4f8607558027a963f6323c4d2d7045d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4f8607558027a963f6323c4d2d7045d">&#9670;&#160;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.__init__ </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>from_state</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>to_state</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>questioner</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00055">55</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   55</span>    <span class="keyword">def </span>__init__(self, from_state, to_state, questioner=None):</div>
<div class="line"><span class="lineno">   56</span>        self.from_state = from_state</div>
<div class="line"><span class="lineno">   57</span>        self.to_state = to_state</div>
<div class="line"><span class="lineno">   58</span>        self.questioner = questioner <span class="keywordflow">or</span> MigrationQuestioner()</div>
<div class="line"><span class="lineno">   59</span>        self.existing_apps = {app <span class="keywordflow">for</span> app, model <span class="keywordflow">in</span> from_state.models}</div>
<div class="line"><span class="lineno">   60</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="typing__extensions_8py_source.html#l02793">pip._vendor.typing_extensions.deprecated.__call__()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a6ba31d77a1d6d194684586f67e94dd5f" name="a6ba31d77a1d6d194684586f67e94dd5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ba31d77a1d6d194684586f67e94dd5f">&#9670;&#160;</a></span>_build_migration_list()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector._build_migration_list </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>graph</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Chop the lists of operations up into migrations with dependencies on
each other. Do this by going through an app's list of operations until
one is found that has an outgoing dependency that isn't in another
app's migration yet (hasn't been chopped off its list). Then chop off
the operations before it into a migration and move onto the next app.
If the loops completes without doing anything, there's a circular
dependency (which _should_ be impossible as the operations are
all split at this point so they can't depend and be depended on).
</pre> 
<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00294">294</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  294</span>    <span class="keyword">def </span>_build_migration_list(self, graph=None):</div>
<div class="line"><span class="lineno">  295</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  296</span><span class="stringliteral">        Chop the lists of operations up into migrations with dependencies on</span></div>
<div class="line"><span class="lineno">  297</span><span class="stringliteral">        each other. Do this by going through an app&#39;s list of operations until</span></div>
<div class="line"><span class="lineno">  298</span><span class="stringliteral">        one is found that has an outgoing dependency that isn&#39;t in another</span></div>
<div class="line"><span class="lineno">  299</span><span class="stringliteral">        app&#39;s migration yet (hasn&#39;t been chopped off its list). Then chop off</span></div>
<div class="line"><span class="lineno">  300</span><span class="stringliteral">        the operations before it into a migration and move onto the next app.</span></div>
<div class="line"><span class="lineno">  301</span><span class="stringliteral">        If the loops completes without doing anything, there&#39;s a circular</span></div>
<div class="line"><span class="lineno">  302</span><span class="stringliteral">        dependency (which _should_ be impossible as the operations are</span></div>
<div class="line"><span class="lineno">  303</span><span class="stringliteral">        all split at this point so they can&#39;t depend and be depended on).</span></div>
<div class="line"><span class="lineno">  304</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  305</span>        self.migrations = {}</div>
<div class="line"><span class="lineno">  306</span>        num_ops = sum(len(x) <span class="keywordflow">for</span> x <span class="keywordflow">in</span> self.generated_operations.values())</div>
<div class="line"><span class="lineno">  307</span>        chop_mode = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  308</span>        <span class="keywordflow">while</span> num_ops:</div>
<div class="line"><span class="lineno">  309</span>            <span class="comment"># On every iteration, we step through all the apps and see if there</span></div>
<div class="line"><span class="lineno">  310</span>            <span class="comment"># is a completed set of operations.</span></div>
<div class="line"><span class="lineno">  311</span>            <span class="comment"># If we find that a subset of the operations are complete we can</span></div>
<div class="line"><span class="lineno">  312</span>            <span class="comment"># try to chop it off from the rest and continue, but we only</span></div>
<div class="line"><span class="lineno">  313</span>            <span class="comment"># do this if we&#39;ve already been through the list once before</span></div>
<div class="line"><span class="lineno">  314</span>            <span class="comment"># without any chopping and nothing has changed.</span></div>
<div class="line"><span class="lineno">  315</span>            <span class="keywordflow">for</span> app_label <span class="keywordflow">in</span> sorted(self.generated_operations):</div>
<div class="line"><span class="lineno">  316</span>                chopped = []</div>
<div class="line"><span class="lineno">  317</span>                dependencies = set()</div>
<div class="line"><span class="lineno">  318</span>                <span class="keywordflow">for</span> operation <span class="keywordflow">in</span> list(self.generated_operations[app_label]):</div>
<div class="line"><span class="lineno">  319</span>                    deps_satisfied = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  320</span>                    operation_dependencies = set()</div>
<div class="line"><span class="lineno">  321</span>                    <span class="keywordflow">for</span> dep <span class="keywordflow">in</span> operation._auto_deps:</div>
<div class="line"><span class="lineno">  322</span>                        <span class="comment"># Temporarily resolve the swappable dependency to</span></div>
<div class="line"><span class="lineno">  323</span>                        <span class="comment"># prevent circular references. While keeping the</span></div>
<div class="line"><span class="lineno">  324</span>                        <span class="comment"># dependency checks on the resolved model, add the</span></div>
<div class="line"><span class="lineno">  325</span>                        <span class="comment"># swappable dependencies.</span></div>
<div class="line"><span class="lineno">  326</span>                        original_dep = dep</div>
<div class="line"><span class="lineno">  327</span>                        dep, is_swappable_dep = self._resolve_dependency(dep)</div>
<div class="line"><span class="lineno">  328</span>                        <span class="keywordflow">if</span> dep.app_label != app_label:</div>
<div class="line"><span class="lineno">  329</span>                            <span class="comment"># External app dependency. See if it&#39;s not yet</span></div>
<div class="line"><span class="lineno">  330</span>                            <span class="comment"># satisfied.</span></div>
<div class="line"><span class="lineno">  331</span>                            <span class="keywordflow">for</span> other_operation <span class="keywordflow">in</span> self.generated_operations.get(</div>
<div class="line"><span class="lineno">  332</span>                                dep.app_label, []</div>
<div class="line"><span class="lineno">  333</span>                            ):</div>
<div class="line"><span class="lineno">  334</span>                                <span class="keywordflow">if</span> self.check_dependency(other_operation, dep):</div>
<div class="line"><span class="lineno">  335</span>                                    deps_satisfied = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  336</span>                                    <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  337</span>                            <span class="keywordflow">if</span> <span class="keywordflow">not</span> deps_satisfied:</div>
<div class="line"><span class="lineno">  338</span>                                <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  339</span>                            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  340</span>                                <span class="keywordflow">if</span> is_swappable_dep:</div>
<div class="line"><span class="lineno">  341</span>                                    operation_dependencies.add(</div>
<div class="line"><span class="lineno">  342</span>                                        (</div>
<div class="line"><span class="lineno">  343</span>                                            original_dep.app_label,</div>
<div class="line"><span class="lineno">  344</span>                                            original_dep.model_name,</div>
<div class="line"><span class="lineno">  345</span>                                        )</div>
<div class="line"><span class="lineno">  346</span>                                    )</div>
<div class="line"><span class="lineno">  347</span>                                <span class="keywordflow">elif</span> dep.app_label <span class="keywordflow">in</span> self.migrations:</div>
<div class="line"><span class="lineno">  348</span>                                    operation_dependencies.add(</div>
<div class="line"><span class="lineno">  349</span>                                        (</div>
<div class="line"><span class="lineno">  350</span>                                            dep.app_label,</div>
<div class="line"><span class="lineno">  351</span>                                            self.migrations[dep.app_label][-1].name,</div>
<div class="line"><span class="lineno">  352</span>                                        )</div>
<div class="line"><span class="lineno">  353</span>                                    )</div>
<div class="line"><span class="lineno">  354</span>                                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  355</span>                                    <span class="comment"># If we can&#39;t find the other app, we add a</span></div>
<div class="line"><span class="lineno">  356</span>                                    <span class="comment"># first/last dependency, but only if we&#39;ve</span></div>
<div class="line"><span class="lineno">  357</span>                                    <span class="comment"># already been through once and checked</span></div>
<div class="line"><span class="lineno">  358</span>                                    <span class="comment"># everything.</span></div>
<div class="line"><span class="lineno">  359</span>                                    <span class="keywordflow">if</span> chop_mode:</div>
<div class="line"><span class="lineno">  360</span>                                        <span class="comment"># If the app already exists, we add a</span></div>
<div class="line"><span class="lineno">  361</span>                                        <span class="comment"># dependency on the last migration, as</span></div>
<div class="line"><span class="lineno">  362</span>                                        <span class="comment"># we don&#39;t know which migration</span></div>
<div class="line"><span class="lineno">  363</span>                                        <span class="comment"># contains the target field. If it&#39;s</span></div>
<div class="line"><span class="lineno">  364</span>                                        <span class="comment"># not yet migrated or has no</span></div>
<div class="line"><span class="lineno">  365</span>                                        <span class="comment"># migrations, we use __first__.</span></div>
<div class="line"><span class="lineno">  366</span>                                        <span class="keywordflow">if</span> graph <span class="keywordflow">and</span> graph.leaf_nodes(dep.app_label):</div>
<div class="line"><span class="lineno">  367</span>                                            operation_dependencies.add(</div>
<div class="line"><span class="lineno">  368</span>                                                graph.leaf_nodes(dep.app_label)[0]</div>
<div class="line"><span class="lineno">  369</span>                                            )</div>
<div class="line"><span class="lineno">  370</span>                                        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  371</span>                                            operation_dependencies.add(</div>
<div class="line"><span class="lineno">  372</span>                                                (dep.app_label, <span class="stringliteral">&quot;__first__&quot;</span>)</div>
<div class="line"><span class="lineno">  373</span>                                            )</div>
<div class="line"><span class="lineno">  374</span>                                    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  375</span>                                        deps_satisfied = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  376</span>                    <span class="keywordflow">if</span> deps_satisfied:</div>
<div class="line"><span class="lineno">  377</span>                        chopped.append(operation)</div>
<div class="line"><span class="lineno">  378</span>                        dependencies.update(operation_dependencies)</div>
<div class="line"><span class="lineno">  379</span>                        del self.generated_operations[app_label][0]</div>
<div class="line"><span class="lineno">  380</span>                    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  381</span>                        <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  382</span>                <span class="comment"># Make a migration! Well, only if there&#39;s stuff to put in it</span></div>
<div class="line"><span class="lineno">  383</span>                <span class="keywordflow">if</span> dependencies <span class="keywordflow">or</span> chopped:</div>
<div class="line"><span class="lineno">  384</span>                    <span class="keywordflow">if</span> <span class="keywordflow">not</span> self.generated_operations[app_label] <span class="keywordflow">or</span> chop_mode:</div>
<div class="line"><span class="lineno">  385</span>                        subclass = type(</div>
<div class="line"><span class="lineno">  386</span>                            <span class="stringliteral">&quot;Migration&quot;</span>,</div>
<div class="line"><span class="lineno">  387</span>                            (Migration,),</div>
<div class="line"><span class="lineno">  388</span>                            {<span class="stringliteral">&quot;operations&quot;</span>: [], <span class="stringliteral">&quot;dependencies&quot;</span>: []},</div>
<div class="line"><span class="lineno">  389</span>                        )</div>
<div class="line"><span class="lineno">  390</span>                        instance = subclass(</div>
<div class="line"><span class="lineno">  391</span>                            <span class="stringliteral">&quot;auto_%i&quot;</span> % (len(self.migrations.get(app_label, [])) + 1),</div>
<div class="line"><span class="lineno">  392</span>                            app_label,</div>
<div class="line"><span class="lineno">  393</span>                        )</div>
<div class="line"><span class="lineno">  394</span>                        instance.dependencies = list(dependencies)</div>
<div class="line"><span class="lineno">  395</span>                        instance.operations = chopped</div>
<div class="line"><span class="lineno">  396</span>                        instance.initial = app_label <span class="keywordflow">not</span> <span class="keywordflow">in</span> self.existing_apps</div>
<div class="line"><span class="lineno">  397</span>                        self.migrations.setdefault(app_label, []).append(instance)</div>
<div class="line"><span class="lineno">  398</span>                        chop_mode = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  399</span>                    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  400</span>                        self.generated_operations[app_label] = (</div>
<div class="line"><span class="lineno">  401</span>                            chopped + self.generated_operations[app_label]</div>
<div class="line"><span class="lineno">  402</span>                        )</div>
<div class="line"><span class="lineno">  403</span>            new_num_ops = sum(len(x) <span class="keywordflow">for</span> x <span class="keywordflow">in</span> self.generated_operations.values())</div>
<div class="line"><span class="lineno">  404</span>            <span class="keywordflow">if</span> new_num_ops == num_ops:</div>
<div class="line"><span class="lineno">  405</span>                <span class="keywordflow">if</span> <span class="keywordflow">not</span> chop_mode:</div>
<div class="line"><span class="lineno">  406</span>                    chop_mode = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  407</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  408</span>                    <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  409</span>                        <span class="stringliteral">&quot;Cannot resolve operation dependencies: %r&quot;</span></div>
<div class="line"><span class="lineno">  410</span>                        % self.generated_operations</div>
<div class="line"><span class="lineno">  411</span>                    )</div>
<div class="line"><span class="lineno">  412</span>            num_ops = new_num_ops</div>
<div class="line"><span class="lineno">  413</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a0a496118f7886c478ba712d9f09207c4" name="a0a496118f7886c478ba712d9f09207c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a496118f7886c478ba712d9f09207c4">&#9670;&#160;</a></span>_detect_changes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector._detect_changes </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>convert_apps</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>graph</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Return a dict of migration plans which will achieve the
change from from_state to to_state. The dict has app labels
as keys and a list of migrations as values.

The resulting migrations aren't specially named, but the names
do matter for dependencies inside the set.

convert_apps is the list of apps to convert to use migrations
(i.e. to make initial migrations for, in the usual case)

graph is an optional argument that, if provided, can help improve
dependency generation and avoid potential circular dependencies.
</pre> 
<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00125">125</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  125</span>    <span class="keyword">def </span>_detect_changes(self, convert_apps=None, graph=None):</div>
<div class="line"><span class="lineno">  126</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  127</span><span class="stringliteral">        Return a dict of migration plans which will achieve the</span></div>
<div class="line"><span class="lineno">  128</span><span class="stringliteral">        change from from_state to to_state. The dict has app labels</span></div>
<div class="line"><span class="lineno">  129</span><span class="stringliteral">        as keys and a list of migrations as values.</span></div>
<div class="line"><span class="lineno">  130</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  131</span><span class="stringliteral">        The resulting migrations aren&#39;t specially named, but the names</span></div>
<div class="line"><span class="lineno">  132</span><span class="stringliteral">        do matter for dependencies inside the set.</span></div>
<div class="line"><span class="lineno">  133</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  134</span><span class="stringliteral">        convert_apps is the list of apps to convert to use migrations</span></div>
<div class="line"><span class="lineno">  135</span><span class="stringliteral">        (i.e. to make initial migrations for, in the usual case)</span></div>
<div class="line"><span class="lineno">  136</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  137</span><span class="stringliteral">        graph is an optional argument that, if provided, can help improve</span></div>
<div class="line"><span class="lineno">  138</span><span class="stringliteral">        dependency generation and avoid potential circular dependencies.</span></div>
<div class="line"><span class="lineno">  139</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  140</span>        <span class="comment"># The first phase is generating all the operations for each app</span></div>
<div class="line"><span class="lineno">  141</span>        <span class="comment"># and gathering them into a big per-app list.</span></div>
<div class="line"><span class="lineno">  142</span>        <span class="comment"># Then go through that list, order it, and split into migrations to</span></div>
<div class="line"><span class="lineno">  143</span>        <span class="comment"># resolve dependencies caused by M2Ms and FKs.</span></div>
<div class="line"><span class="lineno">  144</span>        self.generated_operations = {}</div>
<div class="line"><span class="lineno">  145</span>        self.altered_indexes = {}</div>
<div class="line"><span class="lineno">  146</span>        self.altered_constraints = {}</div>
<div class="line"><span class="lineno">  147</span>        self.renamed_fields = {}</div>
<div class="line"><span class="lineno">  148</span> </div>
<div class="line"><span class="lineno">  149</span>        <span class="comment"># Prepare some old/new state and model lists, separating</span></div>
<div class="line"><span class="lineno">  150</span>        <span class="comment"># proxy models and ignoring unmigrated apps.</span></div>
<div class="line"><span class="lineno">  151</span>        self.old_model_keys = set()</div>
<div class="line"><span class="lineno">  152</span>        self.old_proxy_keys = set()</div>
<div class="line"><span class="lineno">  153</span>        self.old_unmanaged_keys = set()</div>
<div class="line"><span class="lineno">  154</span>        self.new_model_keys = set()</div>
<div class="line"><span class="lineno">  155</span>        self.new_proxy_keys = set()</div>
<div class="line"><span class="lineno">  156</span>        self.new_unmanaged_keys = set()</div>
<div class="line"><span class="lineno">  157</span>        <span class="keywordflow">for</span> (app_label, model_name), model_state <span class="keywordflow">in</span> self.from_state.models.items():</div>
<div class="line"><span class="lineno">  158</span>            <span class="keywordflow">if</span> <span class="keywordflow">not</span> model_state.options.get(<span class="stringliteral">&quot;managed&quot;</span>, <span class="keyword">True</span>):</div>
<div class="line"><span class="lineno">  159</span>                self.old_unmanaged_keys.add((app_label, model_name))</div>
<div class="line"><span class="lineno">  160</span>            <span class="keywordflow">elif</span> app_label <span class="keywordflow">not</span> <span class="keywordflow">in</span> self.from_state.real_apps:</div>
<div class="line"><span class="lineno">  161</span>                <span class="keywordflow">if</span> model_state.options.get(<span class="stringliteral">&quot;proxy&quot;</span>):</div>
<div class="line"><span class="lineno">  162</span>                    self.old_proxy_keys.add((app_label, model_name))</div>
<div class="line"><span class="lineno">  163</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  164</span>                    self.old_model_keys.add((app_label, model_name))</div>
<div class="line"><span class="lineno">  165</span> </div>
<div class="line"><span class="lineno">  166</span>        <span class="keywordflow">for</span> (app_label, model_name), model_state <span class="keywordflow">in</span> self.to_state.models.items():</div>
<div class="line"><span class="lineno">  167</span>            <span class="keywordflow">if</span> <span class="keywordflow">not</span> model_state.options.get(<span class="stringliteral">&quot;managed&quot;</span>, <span class="keyword">True</span>):</div>
<div class="line"><span class="lineno">  168</span>                self.new_unmanaged_keys.add((app_label, model_name))</div>
<div class="line"><span class="lineno">  169</span>            <span class="keywordflow">elif</span> app_label <span class="keywordflow">not</span> <span class="keywordflow">in</span> self.from_state.real_apps <span class="keywordflow">or</span> (</div>
<div class="line"><span class="lineno">  170</span>                convert_apps <span class="keywordflow">and</span> app_label <span class="keywordflow">in</span> convert_apps</div>
<div class="line"><span class="lineno">  171</span>            ):</div>
<div class="line"><span class="lineno">  172</span>                <span class="keywordflow">if</span> model_state.options.get(<span class="stringliteral">&quot;proxy&quot;</span>):</div>
<div class="line"><span class="lineno">  173</span>                    self.new_proxy_keys.add((app_label, model_name))</div>
<div class="line"><span class="lineno">  174</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  175</span>                    self.new_model_keys.add((app_label, model_name))</div>
<div class="line"><span class="lineno">  176</span> </div>
<div class="line"><span class="lineno">  177</span>        self.from_state.resolve_fields_and_relations()</div>
<div class="line"><span class="lineno">  178</span>        self.to_state.resolve_fields_and_relations()</div>
<div class="line"><span class="lineno">  179</span> </div>
<div class="line"><span class="lineno">  180</span>        <span class="comment"># Renames have to come first</span></div>
<div class="line"><span class="lineno">  181</span>        self.generate_renamed_models()</div>
<div class="line"><span class="lineno">  182</span> </div>
<div class="line"><span class="lineno">  183</span>        <span class="comment"># Prepare lists of fields and generate through model map</span></div>
<div class="line"><span class="lineno">  184</span>        self._prepare_field_lists()</div>
<div class="line"><span class="lineno">  185</span>        self._generate_through_model_map()</div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span>        <span class="comment"># Generate non-rename model operations</span></div>
<div class="line"><span class="lineno">  188</span>        self.generate_deleted_models()</div>
<div class="line"><span class="lineno">  189</span>        self.generate_created_models()</div>
<div class="line"><span class="lineno">  190</span>        self.generate_deleted_proxies()</div>
<div class="line"><span class="lineno">  191</span>        self.generate_created_proxies()</div>
<div class="line"><span class="lineno">  192</span>        self.generate_altered_options()</div>
<div class="line"><span class="lineno">  193</span>        self.generate_altered_managers()</div>
<div class="line"><span class="lineno">  194</span>        self.generate_altered_db_table_comment()</div>
<div class="line"><span class="lineno">  195</span> </div>
<div class="line"><span class="lineno">  196</span>        <span class="comment"># Create the renamed fields and store them in self.renamed_fields.</span></div>
<div class="line"><span class="lineno">  197</span>        <span class="comment"># They are used by create_altered_indexes(), generate_altered_fields(),</span></div>
<div class="line"><span class="lineno">  198</span>        <span class="comment"># generate_removed_altered_index/unique_together(), and</span></div>
<div class="line"><span class="lineno">  199</span>        <span class="comment"># generate_altered_index/unique_together().</span></div>
<div class="line"><span class="lineno">  200</span>        self.create_renamed_fields()</div>
<div class="line"><span class="lineno">  201</span>        <span class="comment"># Create the altered indexes and store them in self.altered_indexes.</span></div>
<div class="line"><span class="lineno">  202</span>        <span class="comment"># This avoids the same computation in generate_removed_indexes()</span></div>
<div class="line"><span class="lineno">  203</span>        <span class="comment"># and generate_added_indexes().</span></div>
<div class="line"><span class="lineno">  204</span>        self.create_altered_indexes()</div>
<div class="line"><span class="lineno">  205</span>        self.create_altered_constraints()</div>
<div class="line"><span class="lineno">  206</span>        <span class="comment"># Generate index removal operations before field is removed</span></div>
<div class="line"><span class="lineno">  207</span>        self.generate_removed_constraints()</div>
<div class="line"><span class="lineno">  208</span>        self.generate_removed_indexes()</div>
<div class="line"><span class="lineno">  209</span>        <span class="comment"># Generate field renaming operations.</span></div>
<div class="line"><span class="lineno">  210</span>        self.generate_renamed_fields()</div>
<div class="line"><span class="lineno">  211</span>        self.generate_renamed_indexes()</div>
<div class="line"><span class="lineno">  212</span>        <span class="comment"># Generate removal of foo together.</span></div>
<div class="line"><span class="lineno">  213</span>        self.generate_removed_altered_unique_together()</div>
<div class="line"><span class="lineno">  214</span>        <span class="comment"># Generate field operations.</span></div>
<div class="line"><span class="lineno">  215</span>        self.generate_removed_fields()</div>
<div class="line"><span class="lineno">  216</span>        self.generate_added_fields()</div>
<div class="line"><span class="lineno">  217</span>        self.generate_altered_fields()</div>
<div class="line"><span class="lineno">  218</span>        self.generate_altered_order_with_respect_to()</div>
<div class="line"><span class="lineno">  219</span>        self.generate_altered_unique_together()</div>
<div class="line"><span class="lineno">  220</span>        self.generate_added_indexes()</div>
<div class="line"><span class="lineno">  221</span>        self.generate_added_constraints()</div>
<div class="line"><span class="lineno">  222</span>        self.generate_altered_db_table()</div>
<div class="line"><span class="lineno">  223</span> </div>
<div class="line"><span class="lineno">  224</span>        self._sort_migrations()</div>
<div class="line"><span class="lineno">  225</span>        self._build_migration_list(graph)</div>
<div class="line"><span class="lineno">  226</span>        self._optimize_migrations()</div>
<div class="line"><span class="lineno">  227</span> </div>
<div class="line"><span class="lineno">  228</span>        <span class="keywordflow">return</span> self.migrations</div>
<div class="line"><span class="lineno">  229</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l00061">changes()</a>.</p>

</div>
</div>
<a id="a9f11eab1f17f29ea3a22d0bec9a8f817" name="a9f11eab1f17f29ea3a22d0bec9a8f817"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f11eab1f17f29ea3a22d0bec9a8f817">&#9670;&#160;</a></span>_generate_added_field()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector._generate_added_field </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>app_label</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>model_name</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>field_name</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l01111">1111</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1111</span>    <span class="keyword">def </span>_generate_added_field(self, app_label, model_name, field_name):</div>
<div class="line"><span class="lineno"> 1112</span>        field = self.to_state.models[app_label, model_name].get_field(field_name)</div>
<div class="line"><span class="lineno"> 1113</span>        <span class="comment"># Adding a field always depends at least on its removal.</span></div>
<div class="line"><span class="lineno"> 1114</span>        dependencies = [</div>
<div class="line"><span class="lineno"> 1115</span>            OperationDependency(</div>
<div class="line"><span class="lineno"> 1116</span>                app_label, model_name, field_name, OperationDependency.Type.REMOVE</div>
<div class="line"><span class="lineno"> 1117</span>            )</div>
<div class="line"><span class="lineno"> 1118</span>        ]</div>
<div class="line"><span class="lineno"> 1119</span>        <span class="comment"># Fields that are foreignkeys/m2ms depend on stuff.</span></div>
<div class="line"><span class="lineno"> 1120</span>        <span class="keywordflow">if</span> field.remote_field <span class="keywordflow">and</span> field.remote_field.model:</div>
<div class="line"><span class="lineno"> 1121</span>            dependencies.extend(</div>
<div class="line"><span class="lineno"> 1122</span>                self._get_dependencies_for_foreign_key(</div>
<div class="line"><span class="lineno"> 1123</span>                    app_label,</div>
<div class="line"><span class="lineno"> 1124</span>                    model_name,</div>
<div class="line"><span class="lineno"> 1125</span>                    field,</div>
<div class="line"><span class="lineno"> 1126</span>                    self.to_state,</div>
<div class="line"><span class="lineno"> 1127</span>                )</div>
<div class="line"><span class="lineno"> 1128</span>            )</div>
<div class="line"><span class="lineno"> 1129</span>        <span class="keywordflow">if</span> field.generated:</div>
<div class="line"><span class="lineno"> 1130</span>            dependencies.extend(self._get_dependencies_for_generated_field(field))</div>
<div class="line"><span class="lineno"> 1131</span>        <span class="comment"># You can&#39;t just add NOT NULL fields with no default or fields</span></div>
<div class="line"><span class="lineno"> 1132</span>        <span class="comment"># which don&#39;t allow empty strings as default.</span></div>
<div class="line"><span class="lineno"> 1133</span>        time_fields = (models.DateField, models.DateTimeField, models.TimeField)</div>
<div class="line"><span class="lineno"> 1134</span>        preserve_default = (</div>
<div class="line"><span class="lineno"> 1135</span>            field.null</div>
<div class="line"><span class="lineno"> 1136</span>            <span class="keywordflow">or</span> field.has_default()</div>
<div class="line"><span class="lineno"> 1137</span>            <span class="keywordflow">or</span> field.db_default <span class="keywordflow">is</span> <span class="keywordflow">not</span> models.NOT_PROVIDED</div>
<div class="line"><span class="lineno"> 1138</span>            <span class="keywordflow">or</span> field.many_to_many</div>
<div class="line"><span class="lineno"> 1139</span>            <span class="keywordflow">or</span> (field.blank <span class="keywordflow">and</span> field.empty_strings_allowed)</div>
<div class="line"><span class="lineno"> 1140</span>            <span class="keywordflow">or</span> (isinstance(field, time_fields) <span class="keywordflow">and</span> field.auto_now)</div>
<div class="line"><span class="lineno"> 1141</span>        )</div>
<div class="line"><span class="lineno"> 1142</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> preserve_default:</div>
<div class="line"><span class="lineno"> 1143</span>            field = field.clone()</div>
<div class="line"><span class="lineno"> 1144</span>            <span class="keywordflow">if</span> isinstance(field, time_fields) <span class="keywordflow">and</span> field.auto_now_add:</div>
<div class="line"><span class="lineno"> 1145</span>                field.default = self.questioner.ask_auto_now_add_addition(</div>
<div class="line"><span class="lineno"> 1146</span>                    field_name, model_name</div>
<div class="line"><span class="lineno"> 1147</span>                )</div>
<div class="line"><span class="lineno"> 1148</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1149</span>                field.default = self.questioner.ask_not_null_addition(</div>
<div class="line"><span class="lineno"> 1150</span>                    field_name, model_name</div>
<div class="line"><span class="lineno"> 1151</span>                )</div>
<div class="line"><span class="lineno"> 1152</span>        <span class="keywordflow">if</span> (</div>
<div class="line"><span class="lineno"> 1153</span>            field.unique</div>
<div class="line"><span class="lineno"> 1154</span>            <span class="keywordflow">and</span> field.default <span class="keywordflow">is</span> <span class="keywordflow">not</span> models.NOT_PROVIDED</div>
<div class="line"><span class="lineno"> 1155</span>            <span class="keywordflow">and</span> callable(field.default)</div>
<div class="line"><span class="lineno"> 1156</span>        ):</div>
<div class="line"><span class="lineno"> 1157</span>            self.questioner.ask_unique_callable_default_addition(field_name, model_name)</div>
<div class="line"><span class="lineno"> 1158</span>        self.add_operation(</div>
<div class="line"><span class="lineno"> 1159</span>            app_label,</div>
<div class="line"><span class="lineno"> 1160</span>            operations.AddField(</div>
<div class="line"><span class="lineno"> 1161</span>                model_name=model_name,</div>
<div class="line"><span class="lineno"> 1162</span>                name=field_name,</div>
<div class="line"><span class="lineno"> 1163</span>                field=field,</div>
<div class="line"><span class="lineno"> 1164</span>                preserve_default=preserve_default,</div>
<div class="line"><span class="lineno"> 1165</span>            ),</div>
<div class="line"><span class="lineno"> 1166</span>            dependencies=dependencies,</div>
<div class="line"><span class="lineno"> 1167</span>        )</div>
<div class="line"><span class="lineno"> 1168</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l01507">_get_dependencies_for_foreign_key()</a>, <a class="el" href="autodetector_8py_source.html#l01552">_get_dependencies_for_generated_field()</a>, <a class="el" href="autodetector_8py_source.html#l00534">add_operation()</a>, <a class="el" href="autodetector_8py_source.html#l00058">questioner</a>, and <a class="el" href="autodetector_8py_source.html#l00057">to_state</a>.</p>

<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l01104">generate_added_fields()</a>, and <a class="el" href="autodetector_8py_source.html#l01202">generate_altered_fields()</a>.</p>

</div>
</div>
<a id="a4e8404d91c4858887de003a3e505867e" name="a4e8404d91c4858887de003a3e505867e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e8404d91c4858887de003a3e505867e">&#9670;&#160;</a></span>_generate_altered_foo_together()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector._generate_altered_foo_together </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>operation</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l01664">1664</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1664</span>    <span class="keyword">def </span>_generate_altered_foo_together(self, operation):</div>
<div class="line"><span class="lineno"> 1665</span>        <span class="keywordflow">for</span> (</div>
<div class="line"><span class="lineno"> 1666</span>            old_value,</div>
<div class="line"><span class="lineno"> 1667</span>            new_value,</div>
<div class="line"><span class="lineno"> 1668</span>            app_label,</div>
<div class="line"><span class="lineno"> 1669</span>            model_name,</div>
<div class="line"><span class="lineno"> 1670</span>            dependencies,</div>
<div class="line"><span class="lineno"> 1671</span>        ) <span class="keywordflow">in</span> self._get_altered_foo_together_operations(operation.option_name):</div>
<div class="line"><span class="lineno"> 1672</span>            removal_value = new_value.intersection(old_value)</div>
<div class="line"><span class="lineno"> 1673</span>            <span class="keywordflow">if</span> new_value != removal_value:</div>
<div class="line"><span class="lineno"> 1674</span>                self.add_operation(</div>
<div class="line"><span class="lineno"> 1675</span>                    app_label,</div>
<div class="line"><span class="lineno"> 1676</span>                    operation(name=model_name, **{operation.option_name: new_value}),</div>
<div class="line"><span class="lineno"> 1677</span>                    dependencies=dependencies,</div>
<div class="line"><span class="lineno"> 1678</span>                )</div>
<div class="line"><span class="lineno"> 1679</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l01589">_get_altered_foo_together_operations()</a>, and <a class="el" href="autodetector_8py_source.html#l00534">add_operation()</a>.</p>

<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l01680">generate_altered_unique_together()</a>.</p>

</div>
</div>
<a id="a7481f9bb2437a66cbfb3e5c9bb32d894" name="a7481f9bb2437a66cbfb3e5c9bb32d894"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7481f9bb2437a66cbfb3e5c9bb32d894">&#9670;&#160;</a></span>_generate_removed_altered_foo_together()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector._generate_removed_altered_foo_together </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>operation</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l01636">1636</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1636</span>    <span class="keyword">def </span>_generate_removed_altered_foo_together(self, operation):</div>
<div class="line"><span class="lineno"> 1637</span>        <span class="keywordflow">for</span> (</div>
<div class="line"><span class="lineno"> 1638</span>            old_value,</div>
<div class="line"><span class="lineno"> 1639</span>            new_value,</div>
<div class="line"><span class="lineno"> 1640</span>            app_label,</div>
<div class="line"><span class="lineno"> 1641</span>            model_name,</div>
<div class="line"><span class="lineno"> 1642</span>            dependencies,</div>
<div class="line"><span class="lineno"> 1643</span>        ) <span class="keywordflow">in</span> self._get_altered_foo_together_operations(operation.option_name):</div>
<div class="line"><span class="lineno"> 1644</span>            <span class="keywordflow">if</span> operation == operations.AlterIndexTogether:</div>
<div class="line"><span class="lineno"> 1645</span>                old_value = {</div>
<div class="line"><span class="lineno"> 1646</span>                    value</div>
<div class="line"><span class="lineno"> 1647</span>                    <span class="keywordflow">for</span> value <span class="keywordflow">in</span> old_value</div>
<div class="line"><span class="lineno"> 1648</span>                    <span class="keywordflow">if</span> value</div>
<div class="line"><span class="lineno"> 1649</span>                    <span class="keywordflow">not</span> <span class="keywordflow">in</span> self.renamed_index_together_values[app_label, model_name]</div>
<div class="line"><span class="lineno"> 1650</span>                }</div>
<div class="line"><span class="lineno"> 1651</span>            removal_value = new_value.intersection(old_value)</div>
<div class="line"><span class="lineno"> 1652</span>            <span class="keywordflow">if</span> removal_value <span class="keywordflow">or</span> old_value:</div>
<div class="line"><span class="lineno"> 1653</span>                self.add_operation(</div>
<div class="line"><span class="lineno"> 1654</span>                    app_label,</div>
<div class="line"><span class="lineno"> 1655</span>                    operation(</div>
<div class="line"><span class="lineno"> 1656</span>                        name=model_name, **{operation.option_name: removal_value}</div>
<div class="line"><span class="lineno"> 1657</span>                    ),</div>
<div class="line"><span class="lineno"> 1658</span>                    dependencies=dependencies,</div>
<div class="line"><span class="lineno"> 1659</span>                )</div>
<div class="line"><span class="lineno"> 1660</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l01589">_get_altered_foo_together_operations()</a>, <a class="el" href="autodetector_8py_source.html#l00534">add_operation()</a>, and <a class="el" href="autodetector_8py_source.html#l01327">renamed_index_together_values</a>.</p>

<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l01661">generate_removed_altered_unique_together()</a>.</p>

</div>
</div>
<a id="aeb5562b23c4212e6b63842b7807c9930" name="aeb5562b23c4212e6b63842b7807c9930"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb5562b23c4212e6b63842b7807c9930">&#9670;&#160;</a></span>_generate_removed_field()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector._generate_removed_field </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>app_label</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>model_name</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>field_name</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l01176">1176</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1176</span>    <span class="keyword">def </span>_generate_removed_field(self, app_label, model_name, field_name):</div>
<div class="line"><span class="lineno"> 1177</span>        self.add_operation(</div>
<div class="line"><span class="lineno"> 1178</span>            app_label,</div>
<div class="line"><span class="lineno"> 1179</span>            operations.RemoveField(</div>
<div class="line"><span class="lineno"> 1180</span>                model_name=model_name,</div>
<div class="line"><span class="lineno"> 1181</span>                name=field_name,</div>
<div class="line"><span class="lineno"> 1182</span>            ),</div>
<div class="line"><span class="lineno"> 1183</span>            <span class="comment"># We might need to depend on the removal of an</span></div>
<div class="line"><span class="lineno"> 1184</span>            <span class="comment"># order_with_respect_to or index/unique_together operation;</span></div>
<div class="line"><span class="lineno"> 1185</span>            <span class="comment"># this is safely ignored if there isn&#39;t one</span></div>
<div class="line"><span class="lineno"> 1186</span>            dependencies=[</div>
<div class="line"><span class="lineno"> 1187</span>                OperationDependency(</div>
<div class="line"><span class="lineno"> 1188</span>                    app_label,</div>
<div class="line"><span class="lineno"> 1189</span>                    model_name,</div>
<div class="line"><span class="lineno"> 1190</span>                    field_name,</div>
<div class="line"><span class="lineno"> 1191</span>                    OperationDependency.Type.REMOVE_ORDER_WRT,</div>
<div class="line"><span class="lineno"> 1192</span>                ),</div>
<div class="line"><span class="lineno"> 1193</span>                OperationDependency(</div>
<div class="line"><span class="lineno"> 1194</span>                    app_label,</div>
<div class="line"><span class="lineno"> 1195</span>                    model_name,</div>
<div class="line"><span class="lineno"> 1196</span>                    field_name,</div>
<div class="line"><span class="lineno"> 1197</span>                    OperationDependency.Type.ALTER_FOO_TOGETHER,</div>
<div class="line"><span class="lineno"> 1198</span>                ),</div>
<div class="line"><span class="lineno"> 1199</span>            ],</div>
<div class="line"><span class="lineno"> 1200</span>        )</div>
<div class="line"><span class="lineno"> 1201</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l00534">add_operation()</a>.</p>

<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l01202">generate_altered_fields()</a>, and <a class="el" href="autodetector_8py_source.html#l01169">generate_removed_fields()</a>.</p>

</div>
</div>
<a id="a61b58944d9063935cf1799dc0e48b3ca" name="a61b58944d9063935cf1799dc0e48b3ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61b58944d9063935cf1799dc0e48b3ca">&#9670;&#160;</a></span>_generate_through_model_map()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector._generate_through_model_map </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Through model map generation.</pre> 
<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00253">253</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  253</span>    <span class="keyword">def </span>_generate_through_model_map(self):</div>
<div class="line"><span class="lineno">  254</span>        <span class="stringliteral">&quot;&quot;&quot;Through model map generation.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  255</span>        <span class="keywordflow">for</span> app_label, model_name <span class="keywordflow">in</span> sorted(self.old_model_keys):</div>
<div class="line"><span class="lineno">  256</span>            old_model_name = self.renamed_models.get(</div>
<div class="line"><span class="lineno">  257</span>                (app_label, model_name), model_name</div>
<div class="line"><span class="lineno">  258</span>            )</div>
<div class="line"><span class="lineno">  259</span>            old_model_state = self.from_state.models[app_label, old_model_name]</div>
<div class="line"><span class="lineno">  260</span>            <span class="keywordflow">for</span> field_name, field <span class="keywordflow">in</span> old_model_state.fields.items():</div>
<div class="line"><span class="lineno">  261</span>                <span class="keywordflow">if</span> hasattr(field, <span class="stringliteral">&quot;remote_field&quot;</span>) <span class="keywordflow">and</span> getattr(</div>
<div class="line"><span class="lineno">  262</span>                    field.remote_field, <span class="stringliteral">&quot;through&quot;</span>, <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  263</span>                ):</div>
<div class="line"><span class="lineno">  264</span>                    through_key = resolve_relation(</div>
<div class="line"><span class="lineno">  265</span>                        field.remote_field.through, app_label, model_name</div>
<div class="line"><span class="lineno">  266</span>                    )</div>
<div class="line"><span class="lineno">  267</span>                    self.through_users[through_key] = (</div>
<div class="line"><span class="lineno">  268</span>                        app_label,</div>
<div class="line"><span class="lineno">  269</span>                        old_model_name,</div>
<div class="line"><span class="lineno">  270</span>                        field_name,</div>
<div class="line"><span class="lineno">  271</span>                    )</div>
<div class="line"><span class="lineno">  272</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l00056">from_state</a>, <a class="el" href="autodetector_8py_source.html#l00151">old_model_keys</a>, <a class="el" href="autodetector_8py_source.html#l00572">renamed_models</a>, and <a class="el" href="autodetector_8py_source.html#l00239">through_users</a>.</p>

</div>
</div>
<a id="a74614c75f069e8a50707e09571ffd0f1" name="a74614c75f069e8a50707e09571ffd0f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74614c75f069e8a50707e09571ffd0f1">&#9670;&#160;</a></span>_get_altered_foo_together_operations()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector._get_altered_foo_together_operations </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>option_name</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l01589">1589</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1589</span>    <span class="keyword">def </span>_get_altered_foo_together_operations(self, option_name):</div>
<div class="line"><span class="lineno"> 1590</span>        <span class="keywordflow">for</span> app_label, model_name <span class="keywordflow">in</span> sorted(self.kept_model_keys):</div>
<div class="line"><span class="lineno"> 1591</span>            old_model_name = self.renamed_models.get(</div>
<div class="line"><span class="lineno"> 1592</span>                (app_label, model_name), model_name</div>
<div class="line"><span class="lineno"> 1593</span>            )</div>
<div class="line"><span class="lineno"> 1594</span>            old_model_state = self.from_state.models[app_label, old_model_name]</div>
<div class="line"><span class="lineno"> 1595</span>            new_model_state = self.to_state.models[app_label, model_name]</div>
<div class="line"><span class="lineno"> 1596</span> </div>
<div class="line"><span class="lineno"> 1597</span>            <span class="comment"># We run the old version through the field renames to account for those</span></div>
<div class="line"><span class="lineno"> 1598</span>            old_value = old_model_state.options.get(option_name)</div>
<div class="line"><span class="lineno"> 1599</span>            old_value = (</div>
<div class="line"><span class="lineno"> 1600</span>                {</div>
<div class="line"><span class="lineno"> 1601</span>                    tuple(</div>
<div class="line"><span class="lineno"> 1602</span>                        self.renamed_fields.get((app_label, model_name, n), n)</div>
<div class="line"><span class="lineno"> 1603</span>                        <span class="keywordflow">for</span> n <span class="keywordflow">in</span> unique</div>
<div class="line"><span class="lineno"> 1604</span>                    )</div>
<div class="line"><span class="lineno"> 1605</span>                    <span class="keywordflow">for</span> unique <span class="keywordflow">in</span> old_value</div>
<div class="line"><span class="lineno"> 1606</span>                }</div>
<div class="line"><span class="lineno"> 1607</span>                <span class="keywordflow">if</span> old_value</div>
<div class="line"><span class="lineno"> 1608</span>                <span class="keywordflow">else</span> set()</div>
<div class="line"><span class="lineno"> 1609</span>            )</div>
<div class="line"><span class="lineno"> 1610</span> </div>
<div class="line"><span class="lineno"> 1611</span>            new_value = new_model_state.options.get(option_name)</div>
<div class="line"><span class="lineno"> 1612</span>            new_value = set(new_value) <span class="keywordflow">if</span> new_value <span class="keywordflow">else</span> set()</div>
<div class="line"><span class="lineno"> 1613</span> </div>
<div class="line"><span class="lineno"> 1614</span>            <span class="keywordflow">if</span> old_value != new_value:</div>
<div class="line"><span class="lineno"> 1615</span>                dependencies = []</div>
<div class="line"><span class="lineno"> 1616</span>                <span class="keywordflow">for</span> foo_togethers <span class="keywordflow">in</span> new_value:</div>
<div class="line"><span class="lineno"> 1617</span>                    <span class="keywordflow">for</span> field_name <span class="keywordflow">in</span> foo_togethers:</div>
<div class="line"><span class="lineno"> 1618</span>                        field = new_model_state.get_field(field_name)</div>
<div class="line"><span class="lineno"> 1619</span>                        <span class="keywordflow">if</span> field.remote_field <span class="keywordflow">and</span> field.remote_field.model:</div>
<div class="line"><span class="lineno"> 1620</span>                            dependencies.extend(</div>
<div class="line"><span class="lineno"> 1621</span>                                self._get_dependencies_for_foreign_key(</div>
<div class="line"><span class="lineno"> 1622</span>                                    app_label,</div>
<div class="line"><span class="lineno"> 1623</span>                                    model_name,</div>
<div class="line"><span class="lineno"> 1624</span>                                    field,</div>
<div class="line"><span class="lineno"> 1625</span>                                    self.to_state,</div>
<div class="line"><span class="lineno"> 1626</span>                                )</div>
<div class="line"><span class="lineno"> 1627</span>                            )</div>
<div class="line"><span class="lineno"> 1628</span>                <span class="keywordflow">yield</span> (</div>
<div class="line"><span class="lineno"> 1629</span>                    old_value,</div>
<div class="line"><span class="lineno"> 1630</span>                    new_value,</div>
<div class="line"><span class="lineno"> 1631</span>                    app_label,</div>
<div class="line"><span class="lineno"> 1632</span>                    model_name,</div>
<div class="line"><span class="lineno"> 1633</span>                    dependencies,</div>
<div class="line"><span class="lineno"> 1634</span>                )</div>
<div class="line"><span class="lineno"> 1635</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l01507">_get_dependencies_for_foreign_key()</a>, <a class="el" href="autodetector_8py_source.html#l00056">from_state</a>, <a class="el" href="autodetector_8py_source.html#l00236">kept_model_keys</a>, <a class="el" href="autodetector_8py_source.html#l00147">renamed_fields</a>, <a class="el" href="autodetector_8py_source.html#l00572">renamed_models</a>, and <a class="el" href="autodetector_8py_source.html#l00057">to_state</a>.</p>

<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l01664">_generate_altered_foo_together()</a>, and <a class="el" href="autodetector_8py_source.html#l01636">_generate_removed_altered_foo_together()</a>.</p>

</div>
</div>
<a id="a349c6610cd9e186a0b21fa556c4fb52d" name="a349c6610cd9e186a0b21fa556c4fb52d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a349c6610cd9e186a0b21fa556c4fb52d">&#9670;&#160;</a></span>_get_dependencies_for_foreign_key()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector._get_dependencies_for_foreign_key </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>app_label</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>model_name</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>field</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>project_state</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l01507">1507</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1507</span>    <span class="keyword">def </span>_get_dependencies_for_foreign_key(app_label, model_name, field, project_state):</div>
<div class="line"><span class="lineno"> 1508</span>        remote_field_model = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 1509</span>        <span class="keywordflow">if</span> hasattr(field.remote_field, <span class="stringliteral">&quot;model&quot;</span>):</div>
<div class="line"><span class="lineno"> 1510</span>            remote_field_model = field.remote_field.model</div>
<div class="line"><span class="lineno"> 1511</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1512</span>            relations = project_state.relations[app_label, model_name]</div>
<div class="line"><span class="lineno"> 1513</span>            <span class="keywordflow">for</span> (remote_app_label, remote_model_name), fields <span class="keywordflow">in</span> relations.items():</div>
<div class="line"><span class="lineno"> 1514</span>                <span class="keywordflow">if</span> any(</div>
<div class="line"><span class="lineno"> 1515</span>                    field == related_field.remote_field</div>
<div class="line"><span class="lineno"> 1516</span>                    <span class="keywordflow">for</span> related_field <span class="keywordflow">in</span> fields.values()</div>
<div class="line"><span class="lineno"> 1517</span>                ):</div>
<div class="line"><span class="lineno"> 1518</span>                    remote_field_model = f<span class="stringliteral">&quot;{remote_app_label}.{remote_model_name}&quot;</span></div>
<div class="line"><span class="lineno"> 1519</span>                    <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno"> 1520</span>        <span class="comment"># Account for FKs to swappable models</span></div>
<div class="line"><span class="lineno"> 1521</span>        swappable_setting = getattr(field, <span class="stringliteral">&quot;swappable_setting&quot;</span>, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno"> 1522</span>        <span class="keywordflow">if</span> swappable_setting <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1523</span>            dep_app_label = <span class="stringliteral">&quot;__setting__&quot;</span></div>
<div class="line"><span class="lineno"> 1524</span>            dep_object_name = swappable_setting</div>
<div class="line"><span class="lineno"> 1525</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1526</span>            dep_app_label, dep_object_name = resolve_relation(</div>
<div class="line"><span class="lineno"> 1527</span>                remote_field_model,</div>
<div class="line"><span class="lineno"> 1528</span>                app_label,</div>
<div class="line"><span class="lineno"> 1529</span>                model_name,</div>
<div class="line"><span class="lineno"> 1530</span>            )</div>
<div class="line"><span class="lineno"> 1531</span>        dependencies = [</div>
<div class="line"><span class="lineno"> 1532</span>            OperationDependency(</div>
<div class="line"><span class="lineno"> 1533</span>                dep_app_label, dep_object_name, <span class="keywordtype">None</span>, OperationDependency.Type.CREATE</div>
<div class="line"><span class="lineno"> 1534</span>            )</div>
<div class="line"><span class="lineno"> 1535</span>        ]</div>
<div class="line"><span class="lineno"> 1536</span>        <span class="keywordflow">if</span> getattr(field.remote_field, <span class="stringliteral">&quot;through&quot;</span>, <span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 1537</span>            through_app_label, through_object_name = resolve_relation(</div>
<div class="line"><span class="lineno"> 1538</span>                field.remote_field.through,</div>
<div class="line"><span class="lineno"> 1539</span>                app_label,</div>
<div class="line"><span class="lineno"> 1540</span>                model_name,</div>
<div class="line"><span class="lineno"> 1541</span>            )</div>
<div class="line"><span class="lineno"> 1542</span>            dependencies.append(</div>
<div class="line"><span class="lineno"> 1543</span>                OperationDependency(</div>
<div class="line"><span class="lineno"> 1544</span>                    through_app_label,</div>
<div class="line"><span class="lineno"> 1545</span>                    through_object_name,</div>
<div class="line"><span class="lineno"> 1546</span>                    <span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno"> 1547</span>                    OperationDependency.Type.CREATE,</div>
<div class="line"><span class="lineno"> 1548</span>                )</div>
<div class="line"><span class="lineno"> 1549</span>            )</div>
<div class="line"><span class="lineno"> 1550</span>        <span class="keywordflow">return</span> dependencies</div>
<div class="line"><span class="lineno"> 1551</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l01111">_generate_added_field()</a>, <a class="el" href="autodetector_8py_source.html#l01589">_get_altered_foo_together_operations()</a>, <a class="el" href="autodetector_8py_source.html#l01573">_get_dependencies_for_model()</a>, <a class="el" href="autodetector_8py_source.html#l01202">generate_altered_fields()</a>, and <a class="el" href="autodetector_8py_source.html#l00634">generate_created_models()</a>.</p>

</div>
</div>
<a id="afe541446ed73d613d58e5abe17cd26a4" name="afe541446ed73d613d58e5abe17cd26a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe541446ed73d613d58e5abe17cd26a4">&#9670;&#160;</a></span>_get_dependencies_for_generated_field()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector._get_dependencies_for_generated_field </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>field</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l01552">1552</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1552</span>    <span class="keyword">def </span>_get_dependencies_for_generated_field(self, field):</div>
<div class="line"><span class="lineno"> 1553</span>        dependencies = []</div>
<div class="line"><span class="lineno"> 1554</span>        referenced_base_fields = models.Q(field.expression).referenced_base_fields</div>
<div class="line"><span class="lineno"> 1555</span>        newly_added_fields = sorted(self.new_field_keys - self.old_field_keys)</div>
<div class="line"><span class="lineno"> 1556</span>        <span class="keywordflow">for</span> app_label, model_name, added_field_name <span class="keywordflow">in</span> newly_added_fields:</div>
<div class="line"><span class="lineno"> 1557</span>            added_field = self.to_state.models[app_label, model_name].get_field(</div>
<div class="line"><span class="lineno"> 1558</span>                added_field_name</div>
<div class="line"><span class="lineno"> 1559</span>            )</div>
<div class="line"><span class="lineno"> 1560</span>            <span class="keywordflow">if</span> (</div>
<div class="line"><span class="lineno"> 1561</span>                added_field.remote_field <span class="keywordflow">and</span> added_field.remote_field.model</div>
<div class="line"><span class="lineno"> 1562</span>            ) <span class="keywordflow">or</span> added_field.name <span class="keywordflow">in</span> referenced_base_fields:</div>
<div class="line"><span class="lineno"> 1563</span>                dependencies.append(</div>
<div class="line"><span class="lineno"> 1564</span>                    OperationDependency(</div>
<div class="line"><span class="lineno"> 1565</span>                        app_label,</div>
<div class="line"><span class="lineno"> 1566</span>                        model_name,</div>
<div class="line"><span class="lineno"> 1567</span>                        added_field.name,</div>
<div class="line"><span class="lineno"> 1568</span>                        OperationDependency.Type.CREATE,</div>
<div class="line"><span class="lineno"> 1569</span>                    )</div>
<div class="line"><span class="lineno"> 1570</span>                )</div>
<div class="line"><span class="lineno"> 1571</span>        <span class="keywordflow">return</span> dependencies</div>
<div class="line"><span class="lineno"> 1572</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l00247">new_field_keys</a>, <a class="el" href="autodetector_8py_source.html#l00240">old_field_keys</a>, and <a class="el" href="autodetector_8py_source.html#l00057">to_state</a>.</p>

<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l01111">_generate_added_field()</a>.</p>

</div>
</div>
<a id="ab770f9239b4d6781119f4f63aaf0f3e6" name="ab770f9239b4d6781119f4f63aaf0f3e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab770f9239b4d6781119f4f63aaf0f3e6">&#9670;&#160;</a></span>_get_dependencies_for_model()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector._get_dependencies_for_model </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>app_label</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>model_name</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Return foreign key dependencies of the given model.</pre> 
<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l01573">1573</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1573</span>    <span class="keyword">def </span>_get_dependencies_for_model(self, app_label, model_name):</div>
<div class="line"><span class="lineno"> 1574</span>        <span class="stringliteral">&quot;&quot;&quot;Return foreign key dependencies of the given model.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1575</span>        dependencies = []</div>
<div class="line"><span class="lineno"> 1576</span>        model_state = self.to_state.models[app_label, model_name]</div>
<div class="line"><span class="lineno"> 1577</span>        <span class="keywordflow">for</span> field <span class="keywordflow">in</span> model_state.fields.values():</div>
<div class="line"><span class="lineno"> 1578</span>            <span class="keywordflow">if</span> field.is_relation:</div>
<div class="line"><span class="lineno"> 1579</span>                dependencies.extend(</div>
<div class="line"><span class="lineno"> 1580</span>                    self._get_dependencies_for_foreign_key(</div>
<div class="line"><span class="lineno"> 1581</span>                        app_label,</div>
<div class="line"><span class="lineno"> 1582</span>                        model_name,</div>
<div class="line"><span class="lineno"> 1583</span>                        field,</div>
<div class="line"><span class="lineno"> 1584</span>                        self.to_state,</div>
<div class="line"><span class="lineno"> 1585</span>                    )</div>
<div class="line"><span class="lineno"> 1586</span>                )</div>
<div class="line"><span class="lineno"> 1587</span>        <span class="keywordflow">return</span> dependencies</div>
<div class="line"><span class="lineno"> 1588</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l01507">_get_dependencies_for_foreign_key()</a>, and <a class="el" href="autodetector_8py_source.html#l00057">to_state</a>.</p>

<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l01476">generate_added_constraints()</a>, and <a class="el" href="autodetector_8py_source.html#l01414">generate_added_indexes()</a>.</p>

</div>
</div>
<a id="aed2332394c41ad52b612ce1fba030203" name="aed2332394c41ad52b612ce1fba030203"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed2332394c41ad52b612ce1fba030203">&#9670;&#160;</a></span>_optimize_migrations()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector._optimize_migrations </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00432">432</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  432</span>    <span class="keyword">def </span>_optimize_migrations(self):</div>
<div class="line"><span class="lineno">  433</span>        <span class="comment"># Add in internal dependencies among the migrations</span></div>
<div class="line"><span class="lineno">  434</span>        <span class="keywordflow">for</span> app_label, migrations <span class="keywordflow">in</span> self.migrations.items():</div>
<div class="line"><span class="lineno">  435</span>            <span class="keywordflow">for</span> m1, m2 <span class="keywordflow">in</span> zip(migrations, migrations[1:]):</div>
<div class="line"><span class="lineno">  436</span>                m2.dependencies.append((app_label, m1.name))</div>
<div class="line"><span class="lineno">  437</span> </div>
<div class="line"><span class="lineno">  438</span>        <span class="comment"># De-dupe dependencies</span></div>
<div class="line"><span class="lineno">  439</span>        <span class="keywordflow">for</span> migrations <span class="keywordflow">in</span> self.migrations.values():</div>
<div class="line"><span class="lineno">  440</span>            <span class="keywordflow">for</span> migration <span class="keywordflow">in</span> migrations:</div>
<div class="line"><span class="lineno">  441</span>                migration.dependencies = list(set(migration.dependencies))</div>
<div class="line"><span class="lineno">  442</span> </div>
<div class="line"><span class="lineno">  443</span>        <span class="comment"># Optimize migrations</span></div>
<div class="line"><span class="lineno">  444</span>        <span class="keywordflow">for</span> app_label, migrations <span class="keywordflow">in</span> self.migrations.items():</div>
<div class="line"><span class="lineno">  445</span>            <span class="keywordflow">for</span> migration <span class="keywordflow">in</span> migrations:</div>
<div class="line"><span class="lineno">  446</span>                migration.operations = MigrationOptimizer().optimize(</div>
<div class="line"><span class="lineno">  447</span>                    migration.operations, app_label</div>
<div class="line"><span class="lineno">  448</span>                )</div>
<div class="line"><span class="lineno">  449</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l00305">migrations</a>.</p>

</div>
</div>
<a id="aeb723c91a61c6bd693bc564ec7700094" name="aeb723c91a61c6bd693bc564ec7700094"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb723c91a61c6bd693bc564ec7700094">&#9670;&#160;</a></span>_prepare_field_lists()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector._prepare_field_lists </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Prepare field lists and a list of the fields that used through models
in the old state so dependencies can be made from the through model
deletion to the field that uses it.
</pre> 
<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00230">230</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  230</span>    <span class="keyword">def </span>_prepare_field_lists(self):</div>
<div class="line"><span class="lineno">  231</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  232</span><span class="stringliteral">        Prepare field lists and a list of the fields that used through models</span></div>
<div class="line"><span class="lineno">  233</span><span class="stringliteral">        in the old state so dependencies can be made from the through model</span></div>
<div class="line"><span class="lineno">  234</span><span class="stringliteral">        deletion to the field that uses it.</span></div>
<div class="line"><span class="lineno">  235</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  236</span>        self.kept_model_keys = self.old_model_keys &amp; self.new_model_keys</div>
<div class="line"><span class="lineno">  237</span>        self.kept_proxy_keys = self.old_proxy_keys &amp; self.new_proxy_keys</div>
<div class="line"><span class="lineno">  238</span>        self.kept_unmanaged_keys = self.old_unmanaged_keys &amp; self.new_unmanaged_keys</div>
<div class="line"><span class="lineno">  239</span>        self.through_users = {}</div>
<div class="line"><span class="lineno">  240</span>        self.old_field_keys = {</div>
<div class="line"><span class="lineno">  241</span>            (app_label, model_name, field_name)</div>
<div class="line"><span class="lineno">  242</span>            <span class="keywordflow">for</span> app_label, model_name <span class="keywordflow">in</span> self.kept_model_keys</div>
<div class="line"><span class="lineno">  243</span>            <span class="keywordflow">for</span> field_name <span class="keywordflow">in</span> self.from_state.models[</div>
<div class="line"><span class="lineno">  244</span>                app_label, self.renamed_models.get((app_label, model_name), model_name)</div>
<div class="line"><span class="lineno">  245</span>            ].fields</div>
<div class="line"><span class="lineno">  246</span>        }</div>
<div class="line"><span class="lineno">  247</span>        self.new_field_keys = {</div>
<div class="line"><span class="lineno">  248</span>            (app_label, model_name, field_name)</div>
<div class="line"><span class="lineno">  249</span>            <span class="keywordflow">for</span> app_label, model_name <span class="keywordflow">in</span> self.kept_model_keys</div>
<div class="line"><span class="lineno">  250</span>            <span class="keywordflow">for</span> field_name <span class="keywordflow">in</span> self.to_state.models[app_label, model_name].fields</div>
<div class="line"><span class="lineno">  251</span>        }</div>
<div class="line"><span class="lineno">  252</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="acc8b2e0c968b56ed2e12115feaececcb" name="acc8b2e0c968b56ed2e12115feaececcb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc8b2e0c968b56ed2e12115feaececcb">&#9670;&#160;</a></span>_resolve_dependency()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector._resolve_dependency </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>dependency</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Return the resolved dependency and a boolean denoting whether or not
it was swappable.
</pre> 
<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00274">274</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  274</span>    <span class="keyword">def </span>_resolve_dependency(dependency):</div>
<div class="line"><span class="lineno">  275</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  276</span><span class="stringliteral">        Return the resolved dependency and a boolean denoting whether or not</span></div>
<div class="line"><span class="lineno">  277</span><span class="stringliteral">        it was swappable.</span></div>
<div class="line"><span class="lineno">  278</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  279</span>        <span class="keywordflow">if</span> dependency.app_label != <span class="stringliteral">&quot;__setting__&quot;</span>:</div>
<div class="line"><span class="lineno">  280</span>            <span class="keywordflow">return</span> dependency, <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  281</span>        resolved_app_label, resolved_object_name = getattr(</div>
<div class="line"><span class="lineno">  282</span>            settings, dependency.model_name</div>
<div class="line"><span class="lineno">  283</span>        ).split(<span class="stringliteral">&quot;.&quot;</span>)</div>
<div class="line"><span class="lineno">  284</span>        <span class="keywordflow">return</span> (</div>
<div class="line"><span class="lineno">  285</span>            OperationDependency(</div>
<div class="line"><span class="lineno">  286</span>                resolved_app_label,</div>
<div class="line"><span class="lineno">  287</span>                resolved_object_name.lower(),</div>
<div class="line"><span class="lineno">  288</span>                dependency.field_name,</div>
<div class="line"><span class="lineno">  289</span>                dependency.type,</div>
<div class="line"><span class="lineno">  290</span>            ),</div>
<div class="line"><span class="lineno">  291</span>            <span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  292</span>        )</div>
<div class="line"><span class="lineno">  293</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l00414">_sort_migrations()</a>.</p>

</div>
</div>
<a id="aadbf9eff5b651a399ac12160ec87268d" name="aadbf9eff5b651a399ac12160ec87268d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadbf9eff5b651a399ac12160ec87268d">&#9670;&#160;</a></span>_sort_migrations()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector._sort_migrations </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Reorder to make things possible. Reordering may be needed so FKs work
nicely inside the same app.
</pre> 
<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00414">414</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  414</span>    <span class="keyword">def </span>_sort_migrations(self):</div>
<div class="line"><span class="lineno">  415</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  416</span><span class="stringliteral">        Reorder to make things possible. Reordering may be needed so FKs work</span></div>
<div class="line"><span class="lineno">  417</span><span class="stringliteral">        nicely inside the same app.</span></div>
<div class="line"><span class="lineno">  418</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  419</span>        <span class="keywordflow">for</span> app_label, ops <span class="keywordflow">in</span> sorted(self.generated_operations.items()):</div>
<div class="line"><span class="lineno">  420</span>            ts = TopologicalSorter()</div>
<div class="line"><span class="lineno">  421</span>            <span class="keywordflow">for</span> op <span class="keywordflow">in</span> ops:</div>
<div class="line"><span class="lineno">  422</span>                ts.add(op)</div>
<div class="line"><span class="lineno">  423</span>                <span class="keywordflow">for</span> dep <span class="keywordflow">in</span> op._auto_deps:</div>
<div class="line"><span class="lineno">  424</span>                    <span class="comment"># Resolve intra-app dependencies to handle circular</span></div>
<div class="line"><span class="lineno">  425</span>                    <span class="comment"># references involving a swappable model.</span></div>
<div class="line"><span class="lineno">  426</span>                    dep = self._resolve_dependency(dep)[0]</div>
<div class="line"><span class="lineno">  427</span>                    <span class="keywordflow">if</span> dep.app_label != app_label:</div>
<div class="line"><span class="lineno">  428</span>                        <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  429</span>                    ts.add(op, *(x <span class="keywordflow">for</span> x <span class="keywordflow">in</span> ops <span class="keywordflow">if</span> self.check_dependency(x, dep)))</div>
<div class="line"><span class="lineno">  430</span>            self.generated_operations[app_label] = list(ts.static_order())</div>
<div class="line"><span class="lineno">  431</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l00274">_resolve_dependency()</a>, <a class="el" href="autodetector_8py_source.html#l00450">check_dependency()</a>, and <a class="el" href="autodetector_8py_source.html#l00144">generated_operations</a>.</p>

</div>
</div>
<a id="a0cbb037c36507a24606be2034089d212" name="a0cbb037c36507a24606be2034089d212"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cbb037c36507a24606be2034089d212">&#9670;&#160;</a></span>_trim_to_apps()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector._trim_to_apps </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>changes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>app_labels</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel protected">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Take changes from arrange_for_graph() and set of app labels, and return
a modified set of changes which trims out as many migrations that are
not in app_labels as possible. Note that some other migrations may
still be present as they may be required dependencies.
</pre> 
<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l01868">1868</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1868</span>    <span class="keyword">def </span>_trim_to_apps(self, changes, app_labels):</div>
<div class="line"><span class="lineno"> 1869</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1870</span><span class="stringliteral">        Take changes from arrange_for_graph() and set of app labels, and return</span></div>
<div class="line"><span class="lineno"> 1871</span><span class="stringliteral">        a modified set of changes which trims out as many migrations that are</span></div>
<div class="line"><span class="lineno"> 1872</span><span class="stringliteral">        not in app_labels as possible. Note that some other migrations may</span></div>
<div class="line"><span class="lineno"> 1873</span><span class="stringliteral">        still be present as they may be required dependencies.</span></div>
<div class="line"><span class="lineno"> 1874</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1875</span>        <span class="comment"># Gather other app dependencies in a first pass</span></div>
<div class="line"><span class="lineno"> 1876</span>        app_dependencies = {}</div>
<div class="line"><span class="lineno"> 1877</span>        <span class="keywordflow">for</span> app_label, migrations <span class="keywordflow">in</span> changes.items():</div>
<div class="line"><span class="lineno"> 1878</span>            <span class="keywordflow">for</span> migration <span class="keywordflow">in</span> migrations:</div>
<div class="line"><span class="lineno"> 1879</span>                <span class="keywordflow">for</span> dep_app_label, name <span class="keywordflow">in</span> migration.dependencies:</div>
<div class="line"><span class="lineno"> 1880</span>                    app_dependencies.setdefault(app_label, set()).add(dep_app_label)</div>
<div class="line"><span class="lineno"> 1881</span>        required_apps = set(app_labels)</div>
<div class="line"><span class="lineno"> 1882</span>        <span class="comment"># Keep resolving till there&#39;s no change</span></div>
<div class="line"><span class="lineno"> 1883</span>        old_required_apps = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 1884</span>        <span class="keywordflow">while</span> old_required_apps != required_apps:</div>
<div class="line"><span class="lineno"> 1885</span>            old_required_apps = set(required_apps)</div>
<div class="line"><span class="lineno"> 1886</span>            required_apps.update(</div>
<div class="line"><span class="lineno"> 1887</span>                *[app_dependencies.get(app_label, ()) <span class="keywordflow">for</span> app_label <span class="keywordflow">in</span> required_apps]</div>
<div class="line"><span class="lineno"> 1888</span>            )</div>
<div class="line"><span class="lineno"> 1889</span>        <span class="comment"># Remove all migrations that aren&#39;t needed</span></div>
<div class="line"><span class="lineno"> 1890</span>        <span class="keywordflow">for</span> app_label <span class="keywordflow">in</span> list(changes):</div>
<div class="line"><span class="lineno"> 1891</span>            <span class="keywordflow">if</span> app_label <span class="keywordflow">not</span> <span class="keywordflow">in</span> required_apps:</div>
<div class="line"><span class="lineno"> 1892</span>                del changes[app_label]</div>
<div class="line"><span class="lineno"> 1893</span>        <span class="keywordflow">return</span> changes</div>
<div class="line"><span class="lineno"> 1894</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l00061">changes()</a>.</p>

</div>
</div>
<a id="ab850e8f1f5f9c7b2778025c9dfc16d7d" name="ab850e8f1f5f9c7b2778025c9dfc16d7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab850e8f1f5f9c7b2778025c9dfc16d7d">&#9670;&#160;</a></span>add_operation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.add_operation </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>app_label</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>operation</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>dependencies</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>beginning</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00534">534</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  534</span>    <span class="keyword">def </span>add_operation(self, app_label, operation, dependencies=None, beginning=False):</div>
<div class="line"><span class="lineno">  535</span>        <span class="comment"># Dependencies are</span></div>
<div class="line"><span class="lineno">  536</span>        <span class="comment"># (app_label, model_name, field_name, create/delete as True/False)</span></div>
<div class="line"><span class="lineno">  537</span>        operation._auto_deps = dependencies <span class="keywordflow">or</span> []</div>
<div class="line"><span class="lineno">  538</span>        <span class="keywordflow">if</span> beginning:</div>
<div class="line"><span class="lineno">  539</span>            self.generated_operations.setdefault(app_label, []).insert(0, operation)</div>
<div class="line"><span class="lineno">  540</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  541</span>            self.generated_operations.setdefault(app_label, []).append(operation)</div>
<div class="line"><span class="lineno">  542</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l00144">generated_operations</a>.</p>

<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l01111">_generate_added_field()</a>, <a class="el" href="autodetector_8py_source.html#l01664">_generate_altered_foo_together()</a>, <a class="el" href="autodetector_8py_source.html#l01636">_generate_removed_altered_foo_together()</a>, <a class="el" href="autodetector_8py_source.html#l01176">_generate_removed_field()</a>, <a class="el" href="autodetector_8py_source.html#l01476">generate_added_constraints()</a>, <a class="el" href="autodetector_8py_source.html#l01414">generate_added_indexes()</a>, <a class="el" href="autodetector_8py_source.html#l01683">generate_altered_db_table()</a>, <a class="el" href="autodetector_8py_source.html#l01704">generate_altered_db_table_comment()</a>, <a class="el" href="autodetector_8py_source.html#l01202">generate_altered_fields()</a>, <a class="el" href="autodetector_8py_source.html#l01800">generate_altered_managers()</a>, <a class="el" href="autodetector_8py_source.html#l01726">generate_altered_options()</a>, <a class="el" href="autodetector_8py_source.html#l01766">generate_altered_order_with_respect_to()</a>, <a class="el" href="autodetector_8py_source.html#l00634">generate_created_models()</a>, <a class="el" href="autodetector_8py_source.html#l00855">generate_created_proxies()</a>, <a class="el" href="autodetector_8py_source.html#l00897">generate_deleted_models()</a>, <a class="el" href="autodetector_8py_source.html#l00992">generate_deleted_proxies()</a>, <a class="el" href="autodetector_8py_source.html#l01492">generate_removed_constraints()</a>, <a class="el" href="autodetector_8py_source.html#l01427">generate_removed_indexes()</a>, <a class="el" href="autodetector_8py_source.html#l01067">generate_renamed_fields()</a>, and <a class="el" href="autodetector_8py_source.html#l01438">generate_renamed_indexes()</a>.</p>

</div>
</div>
<a id="a3852d6daf5512e9f448cd023a824a7ef" name="a3852d6daf5512e9f448cd023a824a7ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3852d6daf5512e9f448cd023a824a7ef">&#9670;&#160;</a></span>arrange_for_graph()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.arrange_for_graph </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>changes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>graph</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>migration_name</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Take a result from changes() and a MigrationGraph, and fix the names
and dependencies of the changes so they extend the graph from the leaf
nodes for each app.
</pre> 
<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l01816">1816</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1816</span>    <span class="keyword">def </span>arrange_for_graph(self, changes, graph, migration_name=None):</div>
<div class="line"><span class="lineno"> 1817</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1818</span><span class="stringliteral">        Take a result from changes() and a MigrationGraph, and fix the names</span></div>
<div class="line"><span class="lineno"> 1819</span><span class="stringliteral">        and dependencies of the changes so they extend the graph from the leaf</span></div>
<div class="line"><span class="lineno"> 1820</span><span class="stringliteral">        nodes for each app.</span></div>
<div class="line"><span class="lineno"> 1821</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1822</span>        leaves = graph.leaf_nodes()</div>
<div class="line"><span class="lineno"> 1823</span>        name_map = {}</div>
<div class="line"><span class="lineno"> 1824</span>        <span class="keywordflow">for</span> app_label, migrations <span class="keywordflow">in</span> list(changes.items()):</div>
<div class="line"><span class="lineno"> 1825</span>            <span class="keywordflow">if</span> <span class="keywordflow">not</span> migrations:</div>
<div class="line"><span class="lineno"> 1826</span>                <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno"> 1827</span>            <span class="comment"># Find the app label&#39;s current leaf node</span></div>
<div class="line"><span class="lineno"> 1828</span>            app_leaf = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 1829</span>            <span class="keywordflow">for</span> leaf <span class="keywordflow">in</span> leaves:</div>
<div class="line"><span class="lineno"> 1830</span>                <span class="keywordflow">if</span> leaf[0] == app_label:</div>
<div class="line"><span class="lineno"> 1831</span>                    app_leaf = leaf</div>
<div class="line"><span class="lineno"> 1832</span>                    <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno"> 1833</span>            <span class="comment"># Do they want an initial migration for this app?</span></div>
<div class="line"><span class="lineno"> 1834</span>            <span class="keywordflow">if</span> app_leaf <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> <span class="keywordflow">not</span> self.questioner.ask_initial(app_label):</div>
<div class="line"><span class="lineno"> 1835</span>                <span class="comment"># They don&#39;t.</span></div>
<div class="line"><span class="lineno"> 1836</span>                <span class="keywordflow">for</span> migration <span class="keywordflow">in</span> migrations:</div>
<div class="line"><span class="lineno"> 1837</span>                    name_map[(app_label, migration.name)] = (app_label, <span class="stringliteral">&quot;__first__&quot;</span>)</div>
<div class="line"><span class="lineno"> 1838</span>                del changes[app_label]</div>
<div class="line"><span class="lineno"> 1839</span>                <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno"> 1840</span>            <span class="comment"># Work out the next number in the sequence</span></div>
<div class="line"><span class="lineno"> 1841</span>            <span class="keywordflow">if</span> app_leaf <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1842</span>                next_number = 1</div>
<div class="line"><span class="lineno"> 1843</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1844</span>                next_number = (self.parse_number(app_leaf[1]) <span class="keywordflow">or</span> 0) + 1</div>
<div class="line"><span class="lineno"> 1845</span>            <span class="comment"># Name each migration</span></div>
<div class="line"><span class="lineno"> 1846</span>            <span class="keywordflow">for</span> i, migration <span class="keywordflow">in</span> enumerate(migrations):</div>
<div class="line"><span class="lineno"> 1847</span>                <span class="keywordflow">if</span> i == 0 <span class="keywordflow">and</span> app_leaf:</div>
<div class="line"><span class="lineno"> 1848</span>                    migration.dependencies.append(app_leaf)</div>
<div class="line"><span class="lineno"> 1849</span>                new_name_parts = [<span class="stringliteral">&quot;%04i&quot;</span> % next_number]</div>
<div class="line"><span class="lineno"> 1850</span>                <span class="keywordflow">if</span> migration_name:</div>
<div class="line"><span class="lineno"> 1851</span>                    new_name_parts.append(migration_name)</div>
<div class="line"><span class="lineno"> 1852</span>                <span class="keywordflow">elif</span> i == 0 <span class="keywordflow">and</span> <span class="keywordflow">not</span> app_leaf:</div>
<div class="line"><span class="lineno"> 1853</span>                    new_name_parts.append(<span class="stringliteral">&quot;initial&quot;</span>)</div>
<div class="line"><span class="lineno"> 1854</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1855</span>                    new_name_parts.append(migration.suggest_name()[:100])</div>
<div class="line"><span class="lineno"> 1856</span>                new_name = <span class="stringliteral">&quot;_&quot;</span>.join(new_name_parts)</div>
<div class="line"><span class="lineno"> 1857</span>                name_map[(app_label, migration.name)] = (app_label, new_name)</div>
<div class="line"><span class="lineno"> 1858</span>                next_number += 1</div>
<div class="line"><span class="lineno"> 1859</span>                migration.name = new_name</div>
<div class="line"><span class="lineno"> 1860</span>        <span class="comment"># Now fix dependencies</span></div>
<div class="line"><span class="lineno"> 1861</span>        <span class="keywordflow">for</span> migrations <span class="keywordflow">in</span> changes.values():</div>
<div class="line"><span class="lineno"> 1862</span>            <span class="keywordflow">for</span> migration <span class="keywordflow">in</span> migrations:</div>
<div class="line"><span class="lineno"> 1863</span>                migration.dependencies = [</div>
<div class="line"><span class="lineno"> 1864</span>                    name_map.get(d, d) <span class="keywordflow">for</span> d <span class="keywordflow">in</span> migration.dependencies</div>
<div class="line"><span class="lineno"> 1865</span>                ]</div>
<div class="line"><span class="lineno"> 1866</span>        <span class="keywordflow">return</span> changes</div>
<div class="line"><span class="lineno"> 1867</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l01896">parse_number()</a>, and <a class="el" href="autodetector_8py_source.html#l00058">questioner</a>.</p>

<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l00061">changes()</a>.</p>

</div>
</div>
<a id="a4696ea29c1b4635ca86503a8e783daea" name="a4696ea29c1b4635ca86503a8e783daea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4696ea29c1b4635ca86503a8e783daea">&#9670;&#160;</a></span>changes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.changes </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>graph</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>trim_to_apps</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>convert_apps</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>migration_name</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Main entry point to produce a list of applicable changes.
Take a graph to base names on and an optional set of apps
to try and restrict to (restriction is not guaranteed)
</pre> 
<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00061">61</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   61</span>    <span class="keyword">def </span>changes(self, graph, trim_to_apps=None, convert_apps=None, migration_name=None):</div>
<div class="line"><span class="lineno">   62</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   63</span><span class="stringliteral">        Main entry point to produce a list of applicable changes.</span></div>
<div class="line"><span class="lineno">   64</span><span class="stringliteral">        Take a graph to base names on and an optional set of apps</span></div>
<div class="line"><span class="lineno">   65</span><span class="stringliteral">        to try and restrict to (restriction is not guaranteed)</span></div>
<div class="line"><span class="lineno">   66</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   67</span>        changes = self._detect_changes(convert_apps, graph)</div>
<div class="line"><span class="lineno">   68</span>        changes = self.arrange_for_graph(changes, graph, migration_name)</div>
<div class="line"><span class="lineno">   69</span>        <span class="keywordflow">if</span> trim_to_apps:</div>
<div class="line"><span class="lineno">   70</span>            changes = self._trim_to_apps(changes, trim_to_apps)</div>
<div class="line"><span class="lineno">   71</span>        <span class="keywordflow">return</span> changes</div>
<div class="line"><span class="lineno">   72</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l00125">_detect_changes()</a>, <a class="el" href="autodetector_8py_source.html#l01868">_trim_to_apps()</a>, and <a class="el" href="autodetector_8py_source.html#l01816">arrange_for_graph()</a>.</p>

</div>
</div>
<a id="ac815919af3b9cbeb745bff957f72a832" name="ac815919af3b9cbeb745bff957f72a832"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac815919af3b9cbeb745bff957f72a832">&#9670;&#160;</a></span>check_dependency()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.check_dependency </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>operation</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>dependency</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Return True if the given operation depends on the given dependency,
False otherwise.
</pre> 
<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00450">450</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  450</span>    <span class="keyword">def </span>check_dependency(self, operation, dependency):</div>
<div class="line"><span class="lineno">  451</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  452</span><span class="stringliteral">        Return True if the given operation depends on the given dependency,</span></div>
<div class="line"><span class="lineno">  453</span><span class="stringliteral">        False otherwise.</span></div>
<div class="line"><span class="lineno">  454</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  455</span>        <span class="comment"># Created model</span></div>
<div class="line"><span class="lineno">  456</span>        <span class="keywordflow">if</span> (</div>
<div class="line"><span class="lineno">  457</span>            dependency.field_name <span class="keywordflow">is</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  458</span>            <span class="keywordflow">and</span> dependency.type == OperationDependency.Type.CREATE</div>
<div class="line"><span class="lineno">  459</span>        ):</div>
<div class="line"><span class="lineno">  460</span>            <span class="keywordflow">return</span> (</div>
<div class="line"><span class="lineno">  461</span>                isinstance(operation, operations.CreateModel)</div>
<div class="line"><span class="lineno">  462</span>                <span class="keywordflow">and</span> operation.name_lower == dependency.model_name_lower</div>
<div class="line"><span class="lineno">  463</span>            )</div>
<div class="line"><span class="lineno">  464</span>        <span class="comment"># Created field</span></div>
<div class="line"><span class="lineno">  465</span>        <span class="keywordflow">elif</span> (</div>
<div class="line"><span class="lineno">  466</span>            dependency.field_name <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  467</span>            <span class="keywordflow">and</span> dependency.type == OperationDependency.Type.CREATE</div>
<div class="line"><span class="lineno">  468</span>        ):</div>
<div class="line"><span class="lineno">  469</span>            <span class="keywordflow">return</span> (</div>
<div class="line"><span class="lineno">  470</span>                isinstance(operation, operations.CreateModel)</div>
<div class="line"><span class="lineno">  471</span>                <span class="keywordflow">and</span> operation.name_lower == dependency.model_name_lower</div>
<div class="line"><span class="lineno">  472</span>                <span class="keywordflow">and</span> any(dependency.field_name == x <span class="keywordflow">for</span> x, y <span class="keywordflow">in</span> operation.fields)</div>
<div class="line"><span class="lineno">  473</span>            ) <span class="keywordflow">or</span> (</div>
<div class="line"><span class="lineno">  474</span>                isinstance(operation, operations.AddField)</div>
<div class="line"><span class="lineno">  475</span>                <span class="keywordflow">and</span> operation.model_name_lower == dependency.model_name_lower</div>
<div class="line"><span class="lineno">  476</span>                <span class="keywordflow">and</span> operation.name_lower == dependency.field_name_lower</div>
<div class="line"><span class="lineno">  477</span>            )</div>
<div class="line"><span class="lineno">  478</span>        <span class="comment"># Removed field</span></div>
<div class="line"><span class="lineno">  479</span>        <span class="keywordflow">elif</span> (</div>
<div class="line"><span class="lineno">  480</span>            dependency.field_name <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  481</span>            <span class="keywordflow">and</span> dependency.type == OperationDependency.Type.REMOVE</div>
<div class="line"><span class="lineno">  482</span>        ):</div>
<div class="line"><span class="lineno">  483</span>            <span class="keywordflow">return</span> (</div>
<div class="line"><span class="lineno">  484</span>                isinstance(operation, operations.RemoveField)</div>
<div class="line"><span class="lineno">  485</span>                <span class="keywordflow">and</span> operation.model_name_lower == dependency.model_name_lower</div>
<div class="line"><span class="lineno">  486</span>                <span class="keywordflow">and</span> operation.name_lower == dependency.field_name_lower</div>
<div class="line"><span class="lineno">  487</span>            )</div>
<div class="line"><span class="lineno">  488</span>        <span class="comment"># Removed model</span></div>
<div class="line"><span class="lineno">  489</span>        <span class="keywordflow">elif</span> (</div>
<div class="line"><span class="lineno">  490</span>            dependency.field_name <span class="keywordflow">is</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  491</span>            <span class="keywordflow">and</span> dependency.type == OperationDependency.Type.REMOVE</div>
<div class="line"><span class="lineno">  492</span>        ):</div>
<div class="line"><span class="lineno">  493</span>            <span class="keywordflow">return</span> (</div>
<div class="line"><span class="lineno">  494</span>                isinstance(operation, operations.DeleteModel)</div>
<div class="line"><span class="lineno">  495</span>                <span class="keywordflow">and</span> operation.name_lower == dependency.model_name_lower</div>
<div class="line"><span class="lineno">  496</span>            )</div>
<div class="line"><span class="lineno">  497</span>        <span class="comment"># Field being altered</span></div>
<div class="line"><span class="lineno">  498</span>        <span class="keywordflow">elif</span> (</div>
<div class="line"><span class="lineno">  499</span>            dependency.field_name <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  500</span>            <span class="keywordflow">and</span> dependency.type == OperationDependency.Type.ALTER</div>
<div class="line"><span class="lineno">  501</span>        ):</div>
<div class="line"><span class="lineno">  502</span>            <span class="keywordflow">return</span> (</div>
<div class="line"><span class="lineno">  503</span>                isinstance(operation, operations.AlterField)</div>
<div class="line"><span class="lineno">  504</span>                <span class="keywordflow">and</span> operation.model_name_lower == dependency.model_name_lower</div>
<div class="line"><span class="lineno">  505</span>                <span class="keywordflow">and</span> operation.name_lower == dependency.field_name_lower</div>
<div class="line"><span class="lineno">  506</span>            )</div>
<div class="line"><span class="lineno">  507</span>        <span class="comment"># order_with_respect_to being unset for a field</span></div>
<div class="line"><span class="lineno">  508</span>        <span class="keywordflow">elif</span> (</div>
<div class="line"><span class="lineno">  509</span>            dependency.field_name <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  510</span>            <span class="keywordflow">and</span> dependency.type == OperationDependency.Type.REMOVE_ORDER_WRT</div>
<div class="line"><span class="lineno">  511</span>        ):</div>
<div class="line"><span class="lineno">  512</span>            <span class="keywordflow">return</span> (</div>
<div class="line"><span class="lineno">  513</span>                isinstance(operation, operations.AlterOrderWithRespectTo)</div>
<div class="line"><span class="lineno">  514</span>                <span class="keywordflow">and</span> operation.name_lower == dependency.model_name_lower</div>
<div class="line"><span class="lineno">  515</span>                <span class="keywordflow">and</span> (operation.order_with_respect_to <span class="keywordflow">or</span> <span class="stringliteral">&quot;&quot;</span>).lower()</div>
<div class="line"><span class="lineno">  516</span>                != dependency.field_name_lower</div>
<div class="line"><span class="lineno">  517</span>            )</div>
<div class="line"><span class="lineno">  518</span>        <span class="comment"># Field is removed and part of an index/unique_together</span></div>
<div class="line"><span class="lineno">  519</span>        <span class="keywordflow">elif</span> (</div>
<div class="line"><span class="lineno">  520</span>            dependency.field_name <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  521</span>            <span class="keywordflow">and</span> dependency.type == OperationDependency.Type.ALTER_FOO_TOGETHER</div>
<div class="line"><span class="lineno">  522</span>        ):</div>
<div class="line"><span class="lineno">  523</span>            <span class="keywordflow">return</span> (</div>
<div class="line"><span class="lineno">  524</span>                isinstance(</div>
<div class="line"><span class="lineno">  525</span>                    operation,</div>
<div class="line"><span class="lineno">  526</span>                    (operations.AlterUniqueTogether, operations.AlterIndexTogether),</div>
<div class="line"><span class="lineno">  527</span>                )</div>
<div class="line"><span class="lineno">  528</span>                <span class="keywordflow">and</span> operation.name_lower == dependency.model_name_lower</div>
<div class="line"><span class="lineno">  529</span>            )</div>
<div class="line"><span class="lineno">  530</span>        <span class="comment"># Unknown dependency. Raise an error.</span></div>
<div class="line"><span class="lineno">  531</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  532</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Can&#39;t handle dependency %r&quot;</span> % (dependency,))</div>
<div class="line"><span class="lineno">  533</span> </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l00414">_sort_migrations()</a>.</p>

</div>
</div>
<a id="accebcade56b0cdd94ad2f13658d94a01" name="accebcade56b0cdd94ad2f13658d94a01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accebcade56b0cdd94ad2f13658d94a01">&#9670;&#160;</a></span>create_altered_constraints()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.create_altered_constraints </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l01453">1453</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1453</span>    <span class="keyword">def </span>create_altered_constraints(self):</div>
<div class="line"><span class="lineno"> 1454</span>        option_name = operations.AddConstraint.option_name</div>
<div class="line"><span class="lineno"> 1455</span>        <span class="keywordflow">for</span> app_label, model_name <span class="keywordflow">in</span> sorted(self.kept_model_keys):</div>
<div class="line"><span class="lineno"> 1456</span>            old_model_name = self.renamed_models.get(</div>
<div class="line"><span class="lineno"> 1457</span>                (app_label, model_name), model_name</div>
<div class="line"><span class="lineno"> 1458</span>            )</div>
<div class="line"><span class="lineno"> 1459</span>            old_model_state = self.from_state.models[app_label, old_model_name]</div>
<div class="line"><span class="lineno"> 1460</span>            new_model_state = self.to_state.models[app_label, model_name]</div>
<div class="line"><span class="lineno"> 1461</span> </div>
<div class="line"><span class="lineno"> 1462</span>            old_constraints = old_model_state.options[option_name]</div>
<div class="line"><span class="lineno"> 1463</span>            new_constraints = new_model_state.options[option_name]</div>
<div class="line"><span class="lineno"> 1464</span>            add_constraints = [c <span class="keywordflow">for</span> c <span class="keywordflow">in</span> new_constraints <span class="keywordflow">if</span> c <span class="keywordflow">not</span> <span class="keywordflow">in</span> old_constraints]</div>
<div class="line"><span class="lineno"> 1465</span>            rem_constraints = [c <span class="keywordflow">for</span> c <span class="keywordflow">in</span> old_constraints <span class="keywordflow">if</span> c <span class="keywordflow">not</span> <span class="keywordflow">in</span> new_constraints]</div>
<div class="line"><span class="lineno"> 1466</span> </div>
<div class="line"><span class="lineno"> 1467</span>            self.altered_constraints.update(</div>
<div class="line"><span class="lineno"> 1468</span>                {</div>
<div class="line"><span class="lineno"> 1469</span>                    (app_label, model_name): {</div>
<div class="line"><span class="lineno"> 1470</span>                        <span class="stringliteral">&quot;added_constraints&quot;</span>: add_constraints,</div>
<div class="line"><span class="lineno"> 1471</span>                        <span class="stringliteral">&quot;removed_constraints&quot;</span>: rem_constraints,</div>
<div class="line"><span class="lineno"> 1472</span>                    }</div>
<div class="line"><span class="lineno"> 1473</span>                }</div>
<div class="line"><span class="lineno"> 1474</span>            )</div>
<div class="line"><span class="lineno"> 1475</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l00146">altered_constraints</a>, <a class="el" href="autodetector_8py_source.html#l00056">from_state</a>, <a class="el" href="autodetector_8py_source.html#l00236">kept_model_keys</a>, <a class="el" href="autodetector_8py_source.html#l00572">renamed_models</a>, and <a class="el" href="autodetector_8py_source.html#l00057">to_state</a>.</p>

</div>
</div>
<a id="a92cb0262ede8e1b9ee8a43b1e02c5b19" name="a92cb0262ede8e1b9ee8a43b1e02c5b19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92cb0262ede8e1b9ee8a43b1e02c5b19">&#9670;&#160;</a></span>create_altered_indexes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.create_altered_indexes </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l01325">1325</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1325</span>    <span class="keyword">def </span>create_altered_indexes(self):</div>
<div class="line"><span class="lineno"> 1326</span>        option_name = operations.AddIndex.option_name</div>
<div class="line"><span class="lineno"> 1327</span>        self.renamed_index_together_values = defaultdict(list)</div>
<div class="line"><span class="lineno"> 1328</span> </div>
<div class="line"><span class="lineno"> 1329</span>        <span class="keywordflow">for</span> app_label, model_name <span class="keywordflow">in</span> sorted(self.kept_model_keys):</div>
<div class="line"><span class="lineno"> 1330</span>            old_model_name = self.renamed_models.get(</div>
<div class="line"><span class="lineno"> 1331</span>                (app_label, model_name), model_name</div>
<div class="line"><span class="lineno"> 1332</span>            )</div>
<div class="line"><span class="lineno"> 1333</span>            old_model_state = self.from_state.models[app_label, old_model_name]</div>
<div class="line"><span class="lineno"> 1334</span>            new_model_state = self.to_state.models[app_label, model_name]</div>
<div class="line"><span class="lineno"> 1335</span> </div>
<div class="line"><span class="lineno"> 1336</span>            old_indexes = old_model_state.options[option_name]</div>
<div class="line"><span class="lineno"> 1337</span>            new_indexes = new_model_state.options[option_name]</div>
<div class="line"><span class="lineno"> 1338</span>            added_indexes = [idx <span class="keywordflow">for</span> idx <span class="keywordflow">in</span> new_indexes <span class="keywordflow">if</span> idx <span class="keywordflow">not</span> <span class="keywordflow">in</span> old_indexes]</div>
<div class="line"><span class="lineno"> 1339</span>            removed_indexes = [idx <span class="keywordflow">for</span> idx <span class="keywordflow">in</span> old_indexes <span class="keywordflow">if</span> idx <span class="keywordflow">not</span> <span class="keywordflow">in</span> new_indexes]</div>
<div class="line"><span class="lineno"> 1340</span>            renamed_indexes = []</div>
<div class="line"><span class="lineno"> 1341</span>            <span class="comment"># Find renamed indexes.</span></div>
<div class="line"><span class="lineno"> 1342</span>            remove_from_added = []</div>
<div class="line"><span class="lineno"> 1343</span>            remove_from_removed = []</div>
<div class="line"><span class="lineno"> 1344</span>            <span class="keywordflow">for</span> new_index <span class="keywordflow">in</span> added_indexes:</div>
<div class="line"><span class="lineno"> 1345</span>                new_index_dec = new_index.deconstruct()</div>
<div class="line"><span class="lineno"> 1346</span>                new_index_name = new_index_dec[2].pop(<span class="stringliteral">&quot;name&quot;</span>)</div>
<div class="line"><span class="lineno"> 1347</span>                <span class="keywordflow">for</span> old_index <span class="keywordflow">in</span> removed_indexes:</div>
<div class="line"><span class="lineno"> 1348</span>                    old_index_dec = old_index.deconstruct()</div>
<div class="line"><span class="lineno"> 1349</span>                    old_index_name = old_index_dec[2].pop(<span class="stringliteral">&quot;name&quot;</span>)</div>
<div class="line"><span class="lineno"> 1350</span>                    <span class="comment"># Indexes are the same except for the names.</span></div>
<div class="line"><span class="lineno"> 1351</span>                    <span class="keywordflow">if</span> (</div>
<div class="line"><span class="lineno"> 1352</span>                        new_index_dec == old_index_dec</div>
<div class="line"><span class="lineno"> 1353</span>                        <span class="keywordflow">and</span> new_index_name != old_index_name</div>
<div class="line"><span class="lineno"> 1354</span>                    ):</div>
<div class="line"><span class="lineno"> 1355</span>                        renamed_indexes.append((old_index_name, new_index_name, <span class="keywordtype">None</span>))</div>
<div class="line"><span class="lineno"> 1356</span>                        remove_from_added.append(new_index)</div>
<div class="line"><span class="lineno"> 1357</span>                        remove_from_removed.append(old_index)</div>
<div class="line"><span class="lineno"> 1358</span>            <span class="comment"># Find index_together changed to indexes.</span></div>
<div class="line"><span class="lineno"> 1359</span>            <span class="keywordflow">for</span> (</div>
<div class="line"><span class="lineno"> 1360</span>                old_value,</div>
<div class="line"><span class="lineno"> 1361</span>                new_value,</div>
<div class="line"><span class="lineno"> 1362</span>                index_together_app_label,</div>
<div class="line"><span class="lineno"> 1363</span>                index_together_model_name,</div>
<div class="line"><span class="lineno"> 1364</span>                dependencies,</div>
<div class="line"><span class="lineno"> 1365</span>            ) <span class="keywordflow">in</span> self._get_altered_foo_together_operations(</div>
<div class="line"><span class="lineno"> 1366</span>                operations.AlterIndexTogether.option_name</div>
<div class="line"><span class="lineno"> 1367</span>            ):</div>
<div class="line"><span class="lineno"> 1368</span>                <span class="keywordflow">if</span> (</div>
<div class="line"><span class="lineno"> 1369</span>                    app_label != index_together_app_label</div>
<div class="line"><span class="lineno"> 1370</span>                    <span class="keywordflow">or</span> model_name != index_together_model_name</div>
<div class="line"><span class="lineno"> 1371</span>                ):</div>
<div class="line"><span class="lineno"> 1372</span>                    <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno"> 1373</span>                removed_values = old_value.difference(new_value)</div>
<div class="line"><span class="lineno"> 1374</span>                <span class="keywordflow">for</span> removed_index_together <span class="keywordflow">in</span> removed_values:</div>
<div class="line"><span class="lineno"> 1375</span>                    renamed_index_together_indexes = []</div>
<div class="line"><span class="lineno"> 1376</span>                    <span class="keywordflow">for</span> new_index <span class="keywordflow">in</span> added_indexes:</div>
<div class="line"><span class="lineno"> 1377</span>                        _, args, kwargs = new_index.deconstruct()</div>
<div class="line"><span class="lineno"> 1378</span>                        <span class="comment"># Ensure only &#39;fields&#39; are defined in the Index.</span></div>
<div class="line"><span class="lineno"> 1379</span>                        <span class="keywordflow">if</span> (</div>
<div class="line"><span class="lineno"> 1380</span>                            <span class="keywordflow">not</span> args</div>
<div class="line"><span class="lineno"> 1381</span>                            <span class="keywordflow">and</span> new_index.fields == list(removed_index_together)</div>
<div class="line"><span class="lineno"> 1382</span>                            <span class="keywordflow">and</span> set(kwargs) == {<span class="stringliteral">&quot;name&quot;</span>, <span class="stringliteral">&quot;fields&quot;</span>}</div>
<div class="line"><span class="lineno"> 1383</span>                        ):</div>
<div class="line"><span class="lineno"> 1384</span>                            renamed_index_together_indexes.append(new_index)</div>
<div class="line"><span class="lineno"> 1385</span> </div>
<div class="line"><span class="lineno"> 1386</span>                    <span class="keywordflow">if</span> len(renamed_index_together_indexes) == 1:</div>
<div class="line"><span class="lineno"> 1387</span>                        renamed_index = renamed_index_together_indexes[0]</div>
<div class="line"><span class="lineno"> 1388</span>                        remove_from_added.append(renamed_index)</div>
<div class="line"><span class="lineno"> 1389</span>                        renamed_indexes.append(</div>
<div class="line"><span class="lineno"> 1390</span>                            (<span class="keywordtype">None</span>, renamed_index.name, removed_index_together)</div>
<div class="line"><span class="lineno"> 1391</span>                        )</div>
<div class="line"><span class="lineno"> 1392</span>                        self.renamed_index_together_values[</div>
<div class="line"><span class="lineno"> 1393</span>                            index_together_app_label, index_together_model_name</div>
<div class="line"><span class="lineno"> 1394</span>                        ].append(removed_index_together)</div>
<div class="line"><span class="lineno"> 1395</span>            <span class="comment"># Remove renamed indexes from the lists of added and removed</span></div>
<div class="line"><span class="lineno"> 1396</span>            <span class="comment"># indexes.</span></div>
<div class="line"><span class="lineno"> 1397</span>            added_indexes = [</div>
<div class="line"><span class="lineno"> 1398</span>                idx <span class="keywordflow">for</span> idx <span class="keywordflow">in</span> added_indexes <span class="keywordflow">if</span> idx <span class="keywordflow">not</span> <span class="keywordflow">in</span> remove_from_added</div>
<div class="line"><span class="lineno"> 1399</span>            ]</div>
<div class="line"><span class="lineno"> 1400</span>            removed_indexes = [</div>
<div class="line"><span class="lineno"> 1401</span>                idx <span class="keywordflow">for</span> idx <span class="keywordflow">in</span> removed_indexes <span class="keywordflow">if</span> idx <span class="keywordflow">not</span> <span class="keywordflow">in</span> remove_from_removed</div>
<div class="line"><span class="lineno"> 1402</span>            ]</div>
<div class="line"><span class="lineno"> 1403</span> </div>
<div class="line"><span class="lineno"> 1404</span>            self.altered_indexes.update(</div>
<div class="line"><span class="lineno"> 1405</span>                {</div>
<div class="line"><span class="lineno"> 1406</span>                    (app_label, model_name): {</div>
<div class="line"><span class="lineno"> 1407</span>                        <span class="stringliteral">&quot;added_indexes&quot;</span>: added_indexes,</div>
<div class="line"><span class="lineno"> 1408</span>                        <span class="stringliteral">&quot;removed_indexes&quot;</span>: removed_indexes,</div>
<div class="line"><span class="lineno"> 1409</span>                        <span class="stringliteral">&quot;renamed_indexes&quot;</span>: renamed_indexes,</div>
<div class="line"><span class="lineno"> 1410</span>                    }</div>
<div class="line"><span class="lineno"> 1411</span>                }</div>
<div class="line"><span class="lineno"> 1412</span>            )</div>
<div class="line"><span class="lineno"> 1413</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae3587aaa027f205a5203c2233d15a523" name="ae3587aaa027f205a5203c2233d15a523"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3587aaa027f205a5203c2233d15a523">&#9670;&#160;</a></span>create_renamed_fields()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.create_renamed_fields </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Work out renamed fields.</pre> 
<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l01005">1005</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1005</span>    <span class="keyword">def </span>create_renamed_fields(self):</div>
<div class="line"><span class="lineno"> 1006</span>        <span class="stringliteral">&quot;&quot;&quot;Work out renamed fields.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1007</span>        self.renamed_operations = []</div>
<div class="line"><span class="lineno"> 1008</span>        old_field_keys = self.old_field_keys.copy()</div>
<div class="line"><span class="lineno"> 1009</span>        <span class="keywordflow">for</span> app_label, model_name, field_name <span class="keywordflow">in</span> sorted(</div>
<div class="line"><span class="lineno"> 1010</span>            self.new_field_keys - old_field_keys</div>
<div class="line"><span class="lineno"> 1011</span>        ):</div>
<div class="line"><span class="lineno"> 1012</span>            old_model_name = self.renamed_models.get(</div>
<div class="line"><span class="lineno"> 1013</span>                (app_label, model_name), model_name</div>
<div class="line"><span class="lineno"> 1014</span>            )</div>
<div class="line"><span class="lineno"> 1015</span>            old_model_state = self.from_state.models[app_label, old_model_name]</div>
<div class="line"><span class="lineno"> 1016</span>            new_model_state = self.to_state.models[app_label, model_name]</div>
<div class="line"><span class="lineno"> 1017</span>            field = new_model_state.get_field(field_name)</div>
<div class="line"><span class="lineno"> 1018</span>            <span class="comment"># Scan to see if this is actually a rename!</span></div>
<div class="line"><span class="lineno"> 1019</span>            field_dec = self.deep_deconstruct(field)</div>
<div class="line"><span class="lineno"> 1020</span>            <span class="keywordflow">for</span> rem_app_label, rem_model_name, rem_field_name <span class="keywordflow">in</span> sorted(</div>
<div class="line"><span class="lineno"> 1021</span>                old_field_keys - self.new_field_keys</div>
<div class="line"><span class="lineno"> 1022</span>            ):</div>
<div class="line"><span class="lineno"> 1023</span>                <span class="keywordflow">if</span> rem_app_label == app_label <span class="keywordflow">and</span> rem_model_name == model_name:</div>
<div class="line"><span class="lineno"> 1024</span>                    old_field = old_model_state.get_field(rem_field_name)</div>
<div class="line"><span class="lineno"> 1025</span>                    old_field_dec = self.deep_deconstruct(old_field)</div>
<div class="line"><span class="lineno"> 1026</span>                    <span class="keywordflow">if</span> (</div>
<div class="line"><span class="lineno"> 1027</span>                        field.remote_field</div>
<div class="line"><span class="lineno"> 1028</span>                        <span class="keywordflow">and</span> field.remote_field.model</div>
<div class="line"><span class="lineno"> 1029</span>                        <span class="keywordflow">and</span> <span class="stringliteral">&quot;to&quot;</span> <span class="keywordflow">in</span> old_field_dec[2]</div>
<div class="line"><span class="lineno"> 1030</span>                    ):</div>
<div class="line"><span class="lineno"> 1031</span>                        old_rel_to = old_field_dec[2][<span class="stringliteral">&quot;to&quot;</span>]</div>
<div class="line"><span class="lineno"> 1032</span>                        <span class="keywordflow">if</span> old_rel_to <span class="keywordflow">in</span> self.renamed_models_rel:</div>
<div class="line"><span class="lineno"> 1033</span>                            old_field_dec[2][<span class="stringliteral">&quot;to&quot;</span>] = self.renamed_models_rel[old_rel_to]</div>
<div class="line"><span class="lineno"> 1034</span>                    old_field.set_attributes_from_name(rem_field_name)</div>
<div class="line"><span class="lineno"> 1035</span>                    old_db_column = old_field.get_attname_column()[1]</div>
<div class="line"><span class="lineno"> 1036</span>                    <span class="keywordflow">if</span> old_field_dec == field_dec <span class="keywordflow">or</span> (</div>
<div class="line"><span class="lineno"> 1037</span>                        <span class="comment"># Was the field renamed and db_column equal to the</span></div>
<div class="line"><span class="lineno"> 1038</span>                        <span class="comment"># old field&#39;s column added?</span></div>
<div class="line"><span class="lineno"> 1039</span>                        old_field_dec[0:2] == field_dec[0:2]</div>
<div class="line"><span class="lineno"> 1040</span>                        <span class="keywordflow">and</span> dict(old_field_dec[2], db_column=old_db_column)</div>
<div class="line"><span class="lineno"> 1041</span>                        == field_dec[2]</div>
<div class="line"><span class="lineno"> 1042</span>                    ):</div>
<div class="line"><span class="lineno"> 1043</span>                        <span class="keywordflow">if</span> self.questioner.ask_rename(</div>
<div class="line"><span class="lineno"> 1044</span>                            model_name, rem_field_name, field_name, field</div>
<div class="line"><span class="lineno"> 1045</span>                        ):</div>
<div class="line"><span class="lineno"> 1046</span>                            self.renamed_operations.append(</div>
<div class="line"><span class="lineno"> 1047</span>                                (</div>
<div class="line"><span class="lineno"> 1048</span>                                    rem_app_label,</div>
<div class="line"><span class="lineno"> 1049</span>                                    rem_model_name,</div>
<div class="line"><span class="lineno"> 1050</span>                                    old_field.db_column,</div>
<div class="line"><span class="lineno"> 1051</span>                                    rem_field_name,</div>
<div class="line"><span class="lineno"> 1052</span>                                    app_label,</div>
<div class="line"><span class="lineno"> 1053</span>                                    model_name,</div>
<div class="line"><span class="lineno"> 1054</span>                                    field,</div>
<div class="line"><span class="lineno"> 1055</span>                                    field_name,</div>
<div class="line"><span class="lineno"> 1056</span>                                )</div>
<div class="line"><span class="lineno"> 1057</span>                            )</div>
<div class="line"><span class="lineno"> 1058</span>                            old_field_keys.remove(</div>
<div class="line"><span class="lineno"> 1059</span>                                (rem_app_label, rem_model_name, rem_field_name)</div>
<div class="line"><span class="lineno"> 1060</span>                            )</div>
<div class="line"><span class="lineno"> 1061</span>                            old_field_keys.add((app_label, model_name, field_name))</div>
<div class="line"><span class="lineno"> 1062</span>                            self.renamed_fields[app_label, model_name, field_name] = (</div>
<div class="line"><span class="lineno"> 1063</span>                                rem_field_name</div>
<div class="line"><span class="lineno"> 1064</span>                            )</div>
<div class="line"><span class="lineno"> 1065</span>                            <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno"> 1066</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad2b9756b837752ed199a9e1173013953" name="ad2b9756b837752ed199a9e1173013953"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2b9756b837752ed199a9e1173013953">&#9670;&#160;</a></span>deep_deconstruct()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.deep_deconstruct </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>obj</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Recursive deconstruction for a field and its arguments.
Used for full comparison for rename/alter; sometimes a single-level
deconstruction will not compare correctly.
</pre> 
<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00073">73</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   73</span>    <span class="keyword">def </span>deep_deconstruct(self, obj):</div>
<div class="line"><span class="lineno">   74</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   75</span><span class="stringliteral">        Recursive deconstruction for a field and its arguments.</span></div>
<div class="line"><span class="lineno">   76</span><span class="stringliteral">        Used for full comparison for rename/alter; sometimes a single-level</span></div>
<div class="line"><span class="lineno">   77</span><span class="stringliteral">        deconstruction will not compare correctly.</span></div>
<div class="line"><span class="lineno">   78</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   79</span>        <span class="keywordflow">if</span> isinstance(obj, list):</div>
<div class="line"><span class="lineno">   80</span>            <span class="keywordflow">return</span> [self.deep_deconstruct(value) <span class="keywordflow">for</span> value <span class="keywordflow">in</span> obj]</div>
<div class="line"><span class="lineno">   81</span>        <span class="keywordflow">elif</span> isinstance(obj, tuple):</div>
<div class="line"><span class="lineno">   82</span>            <span class="keywordflow">return</span> tuple(self.deep_deconstruct(value) <span class="keywordflow">for</span> value <span class="keywordflow">in</span> obj)</div>
<div class="line"><span class="lineno">   83</span>        <span class="keywordflow">elif</span> isinstance(obj, dict):</div>
<div class="line"><span class="lineno">   84</span>            <span class="keywordflow">return</span> {key: self.deep_deconstruct(value) <span class="keywordflow">for</span> key, value <span class="keywordflow">in</span> obj.items()}</div>
<div class="line"><span class="lineno">   85</span>        <span class="keywordflow">elif</span> isinstance(obj, functools.partial):</div>
<div class="line"><span class="lineno">   86</span>            <span class="keywordflow">return</span> (</div>
<div class="line"><span class="lineno">   87</span>                obj.func,</div>
<div class="line"><span class="lineno">   88</span>                self.deep_deconstruct(obj.args),</div>
<div class="line"><span class="lineno">   89</span>                self.deep_deconstruct(obj.keywords),</div>
<div class="line"><span class="lineno">   90</span>            )</div>
<div class="line"><span class="lineno">   91</span>        <span class="keywordflow">elif</span> isinstance(obj, COMPILED_REGEX_TYPE):</div>
<div class="line"><span class="lineno">   92</span>            <span class="keywordflow">return</span> RegexObject(obj)</div>
<div class="line"><span class="lineno">   93</span>        <span class="keywordflow">elif</span> isinstance(obj, type):</div>
<div class="line"><span class="lineno">   94</span>            <span class="comment"># If this is a type that implements &#39;deconstruct&#39; as an instance method,</span></div>
<div class="line"><span class="lineno">   95</span>            <span class="comment"># avoid treating this as being deconstructible itself - see #22951</span></div>
<div class="line"><span class="lineno">   96</span>            <span class="keywordflow">return</span> obj</div>
<div class="line"><span class="lineno">   97</span>        <span class="keywordflow">elif</span> hasattr(obj, <span class="stringliteral">&quot;deconstruct&quot;</span>):</div>
<div class="line"><span class="lineno">   98</span>            deconstructed = obj.deconstruct()</div>
<div class="line"><span class="lineno">   99</span>            <span class="keywordflow">if</span> isinstance(obj, models.Field):</div>
<div class="line"><span class="lineno">  100</span>                <span class="comment"># we have a field which also returns a name</span></div>
<div class="line"><span class="lineno">  101</span>                deconstructed = deconstructed[1:]</div>
<div class="line"><span class="lineno">  102</span>            path, args, kwargs = deconstructed</div>
<div class="line"><span class="lineno">  103</span>            <span class="keywordflow">return</span> (</div>
<div class="line"><span class="lineno">  104</span>                path,</div>
<div class="line"><span class="lineno">  105</span>                [self.deep_deconstruct(value) <span class="keywordflow">for</span> value <span class="keywordflow">in</span> args],</div>
<div class="line"><span class="lineno">  106</span>                {key: self.deep_deconstruct(value) <span class="keywordflow">for</span> key, value <span class="keywordflow">in</span> kwargs.items()},</div>
<div class="line"><span class="lineno">  107</span>            )</div>
<div class="line"><span class="lineno">  108</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  109</span>            <span class="keywordflow">return</span> obj</div>
<div class="line"><span class="lineno">  110</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l00073">deep_deconstruct()</a>.</p>

<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l00073">deep_deconstruct()</a>, <a class="el" href="autodetector_8py_source.html#l01202">generate_altered_fields()</a>, and <a class="el" href="autodetector_8py_source.html#l00111">only_relation_agnostic_fields()</a>.</p>

</div>
</div>
<a id="a36432e3a53fb7898e4d6aa8d93ad8138" name="a36432e3a53fb7898e4d6aa8d93ad8138"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36432e3a53fb7898e4d6aa8d93ad8138">&#9670;&#160;</a></span>generate_added_constraints()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.generate_added_constraints </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l01476">1476</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1476</span>    <span class="keyword">def </span>generate_added_constraints(self):</div>
<div class="line"><span class="lineno"> 1477</span>        <span class="keywordflow">for</span> (</div>
<div class="line"><span class="lineno"> 1478</span>            app_label,</div>
<div class="line"><span class="lineno"> 1479</span>            model_name,</div>
<div class="line"><span class="lineno"> 1480</span>        ), alt_constraints <span class="keywordflow">in</span> self.altered_constraints.items():</div>
<div class="line"><span class="lineno"> 1481</span>            dependencies = self._get_dependencies_for_model(app_label, model_name)</div>
<div class="line"><span class="lineno"> 1482</span>            <span class="keywordflow">for</span> constraint <span class="keywordflow">in</span> alt_constraints[<span class="stringliteral">&quot;added_constraints&quot;</span>]:</div>
<div class="line"><span class="lineno"> 1483</span>                self.add_operation(</div>
<div class="line"><span class="lineno"> 1484</span>                    app_label,</div>
<div class="line"><span class="lineno"> 1485</span>                    operations.AddConstraint(</div>
<div class="line"><span class="lineno"> 1486</span>                        model_name=model_name,</div>
<div class="line"><span class="lineno"> 1487</span>                        constraint=constraint,</div>
<div class="line"><span class="lineno"> 1488</span>                    ),</div>
<div class="line"><span class="lineno"> 1489</span>                    dependencies=dependencies,</div>
<div class="line"><span class="lineno"> 1490</span>                )</div>
<div class="line"><span class="lineno"> 1491</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l01573">_get_dependencies_for_model()</a>, <a class="el" href="autodetector_8py_source.html#l00534">add_operation()</a>, and <a class="el" href="autodetector_8py_source.html#l00146">altered_constraints</a>.</p>

</div>
</div>
<a id="a302d84d2e59111135d429b10f40bb116" name="a302d84d2e59111135d429b10f40bb116"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a302d84d2e59111135d429b10f40bb116">&#9670;&#160;</a></span>generate_added_fields()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.generate_added_fields </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Make AddField operations.</pre> 
<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l01104">1104</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1104</span>    <span class="keyword">def </span>generate_added_fields(self):</div>
<div class="line"><span class="lineno"> 1105</span>        <span class="stringliteral">&quot;&quot;&quot;Make AddField operations.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1106</span>        <span class="keywordflow">for</span> app_label, model_name, field_name <span class="keywordflow">in</span> sorted(</div>
<div class="line"><span class="lineno"> 1107</span>            self.new_field_keys - self.old_field_keys</div>
<div class="line"><span class="lineno"> 1108</span>        ):</div>
<div class="line"><span class="lineno"> 1109</span>            self._generate_added_field(app_label, model_name, field_name)</div>
<div class="line"><span class="lineno"> 1110</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l01111">_generate_added_field()</a>, <a class="el" href="autodetector_8py_source.html#l00247">new_field_keys</a>, and <a class="el" href="autodetector_8py_source.html#l00240">old_field_keys</a>.</p>

</div>
</div>
<a id="aced4ba08266d4a00fec2cce47180dce1" name="aced4ba08266d4a00fec2cce47180dce1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aced4ba08266d4a00fec2cce47180dce1">&#9670;&#160;</a></span>generate_added_indexes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.generate_added_indexes </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l01414">1414</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1414</span>    <span class="keyword">def </span>generate_added_indexes(self):</div>
<div class="line"><span class="lineno"> 1415</span>        <span class="keywordflow">for</span> (app_label, model_name), alt_indexes <span class="keywordflow">in</span> self.altered_indexes.items():</div>
<div class="line"><span class="lineno"> 1416</span>            dependencies = self._get_dependencies_for_model(app_label, model_name)</div>
<div class="line"><span class="lineno"> 1417</span>            <span class="keywordflow">for</span> index <span class="keywordflow">in</span> alt_indexes[<span class="stringliteral">&quot;added_indexes&quot;</span>]:</div>
<div class="line"><span class="lineno"> 1418</span>                self.add_operation(</div>
<div class="line"><span class="lineno"> 1419</span>                    app_label,</div>
<div class="line"><span class="lineno"> 1420</span>                    operations.AddIndex(</div>
<div class="line"><span class="lineno"> 1421</span>                        model_name=model_name,</div>
<div class="line"><span class="lineno"> 1422</span>                        index=index,</div>
<div class="line"><span class="lineno"> 1423</span>                    ),</div>
<div class="line"><span class="lineno"> 1424</span>                    dependencies=dependencies,</div>
<div class="line"><span class="lineno"> 1425</span>                )</div>
<div class="line"><span class="lineno"> 1426</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l01573">_get_dependencies_for_model()</a>, <a class="el" href="autodetector_8py_source.html#l00534">add_operation()</a>, and <a class="el" href="autodetector_8py_source.html#l00145">altered_indexes</a>.</p>

</div>
</div>
<a id="a6ea941633830129d9fe71e57d9aec5d5" name="a6ea941633830129d9fe71e57d9aec5d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ea941633830129d9fe71e57d9aec5d5">&#9670;&#160;</a></span>generate_altered_db_table()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.generate_altered_db_table </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l01683">1683</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1683</span>    <span class="keyword">def </span>generate_altered_db_table(self):</div>
<div class="line"><span class="lineno"> 1684</span>        models_to_check = self.kept_model_keys.union(</div>
<div class="line"><span class="lineno"> 1685</span>            self.kept_proxy_keys, self.kept_unmanaged_keys</div>
<div class="line"><span class="lineno"> 1686</span>        )</div>
<div class="line"><span class="lineno"> 1687</span>        <span class="keywordflow">for</span> app_label, model_name <span class="keywordflow">in</span> sorted(models_to_check):</div>
<div class="line"><span class="lineno"> 1688</span>            old_model_name = self.renamed_models.get(</div>
<div class="line"><span class="lineno"> 1689</span>                (app_label, model_name), model_name</div>
<div class="line"><span class="lineno"> 1690</span>            )</div>
<div class="line"><span class="lineno"> 1691</span>            old_model_state = self.from_state.models[app_label, old_model_name]</div>
<div class="line"><span class="lineno"> 1692</span>            new_model_state = self.to_state.models[app_label, model_name]</div>
<div class="line"><span class="lineno"> 1693</span>            old_db_table_name = old_model_state.options.get(<span class="stringliteral">&quot;db_table&quot;</span>)</div>
<div class="line"><span class="lineno"> 1694</span>            new_db_table_name = new_model_state.options.get(<span class="stringliteral">&quot;db_table&quot;</span>)</div>
<div class="line"><span class="lineno"> 1695</span>            <span class="keywordflow">if</span> old_db_table_name != new_db_table_name:</div>
<div class="line"><span class="lineno"> 1696</span>                self.add_operation(</div>
<div class="line"><span class="lineno"> 1697</span>                    app_label,</div>
<div class="line"><span class="lineno"> 1698</span>                    operations.AlterModelTable(</div>
<div class="line"><span class="lineno"> 1699</span>                        name=model_name,</div>
<div class="line"><span class="lineno"> 1700</span>                        table=new_db_table_name,</div>
<div class="line"><span class="lineno"> 1701</span>                    ),</div>
<div class="line"><span class="lineno"> 1702</span>                )</div>
<div class="line"><span class="lineno"> 1703</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l00534">add_operation()</a>, <a class="el" href="autodetector_8py_source.html#l00056">from_state</a>, <a class="el" href="autodetector_8py_source.html#l00236">kept_model_keys</a>, <a class="el" href="autodetector_8py_source.html#l00237">kept_proxy_keys</a>, <a class="el" href="autodetector_8py_source.html#l00238">kept_unmanaged_keys</a>, <a class="el" href="autodetector_8py_source.html#l00572">renamed_models</a>, and <a class="el" href="autodetector_8py_source.html#l00057">to_state</a>.</p>

</div>
</div>
<a id="a5a01de641473d7c1342d5f7336cfb598" name="a5a01de641473d7c1342d5f7336cfb598"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a01de641473d7c1342d5f7336cfb598">&#9670;&#160;</a></span>generate_altered_db_table_comment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.generate_altered_db_table_comment </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l01704">1704</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1704</span>    <span class="keyword">def </span>generate_altered_db_table_comment(self):</div>
<div class="line"><span class="lineno"> 1705</span>        models_to_check = self.kept_model_keys.union(</div>
<div class="line"><span class="lineno"> 1706</span>            self.kept_proxy_keys, self.kept_unmanaged_keys</div>
<div class="line"><span class="lineno"> 1707</span>        )</div>
<div class="line"><span class="lineno"> 1708</span>        <span class="keywordflow">for</span> app_label, model_name <span class="keywordflow">in</span> sorted(models_to_check):</div>
<div class="line"><span class="lineno"> 1709</span>            old_model_name = self.renamed_models.get(</div>
<div class="line"><span class="lineno"> 1710</span>                (app_label, model_name), model_name</div>
<div class="line"><span class="lineno"> 1711</span>            )</div>
<div class="line"><span class="lineno"> 1712</span>            old_model_state = self.from_state.models[app_label, old_model_name]</div>
<div class="line"><span class="lineno"> 1713</span>            new_model_state = self.to_state.models[app_label, model_name]</div>
<div class="line"><span class="lineno"> 1714</span> </div>
<div class="line"><span class="lineno"> 1715</span>            old_db_table_comment = old_model_state.options.get(<span class="stringliteral">&quot;db_table_comment&quot;</span>)</div>
<div class="line"><span class="lineno"> 1716</span>            new_db_table_comment = new_model_state.options.get(<span class="stringliteral">&quot;db_table_comment&quot;</span>)</div>
<div class="line"><span class="lineno"> 1717</span>            <span class="keywordflow">if</span> old_db_table_comment != new_db_table_comment:</div>
<div class="line"><span class="lineno"> 1718</span>                self.add_operation(</div>
<div class="line"><span class="lineno"> 1719</span>                    app_label,</div>
<div class="line"><span class="lineno"> 1720</span>                    operations.AlterModelTableComment(</div>
<div class="line"><span class="lineno"> 1721</span>                        name=model_name,</div>
<div class="line"><span class="lineno"> 1722</span>                        table_comment=new_db_table_comment,</div>
<div class="line"><span class="lineno"> 1723</span>                    ),</div>
<div class="line"><span class="lineno"> 1724</span>                )</div>
<div class="line"><span class="lineno"> 1725</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l00534">add_operation()</a>, <a class="el" href="autodetector_8py_source.html#l00056">from_state</a>, <a class="el" href="autodetector_8py_source.html#l00236">kept_model_keys</a>, <a class="el" href="autodetector_8py_source.html#l00237">kept_proxy_keys</a>, <a class="el" href="autodetector_8py_source.html#l00238">kept_unmanaged_keys</a>, <a class="el" href="autodetector_8py_source.html#l00572">renamed_models</a>, and <a class="el" href="autodetector_8py_source.html#l00057">to_state</a>.</p>

</div>
</div>
<a id="a68b05da25c37d259cac6acd0901ee3b8" name="a68b05da25c37d259cac6acd0901ee3b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68b05da25c37d259cac6acd0901ee3b8">&#9670;&#160;</a></span>generate_altered_fields()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.generate_altered_fields </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Make AlterField operations, or possibly RemovedField/AddField if alter
isn't possible.
</pre> 
<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l01202">1202</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1202</span>    <span class="keyword">def </span>generate_altered_fields(self):</div>
<div class="line"><span class="lineno"> 1203</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1204</span><span class="stringliteral">        Make AlterField operations, or possibly RemovedField/AddField if alter</span></div>
<div class="line"><span class="lineno"> 1205</span><span class="stringliteral">        isn&#39;t possible.</span></div>
<div class="line"><span class="lineno"> 1206</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1207</span>        <span class="keywordflow">for</span> app_label, model_name, field_name <span class="keywordflow">in</span> sorted(</div>
<div class="line"><span class="lineno"> 1208</span>            self.old_field_keys &amp; self.new_field_keys</div>
<div class="line"><span class="lineno"> 1209</span>        ):</div>
<div class="line"><span class="lineno"> 1210</span>            <span class="comment"># Did the field change?</span></div>
<div class="line"><span class="lineno"> 1211</span>            old_model_name = self.renamed_models.get(</div>
<div class="line"><span class="lineno"> 1212</span>                (app_label, model_name), model_name</div>
<div class="line"><span class="lineno"> 1213</span>            )</div>
<div class="line"><span class="lineno"> 1214</span>            old_field_name = self.renamed_fields.get(</div>
<div class="line"><span class="lineno"> 1215</span>                (app_label, model_name, field_name), field_name</div>
<div class="line"><span class="lineno"> 1216</span>            )</div>
<div class="line"><span class="lineno"> 1217</span>            old_field = self.from_state.models[app_label, old_model_name].get_field(</div>
<div class="line"><span class="lineno"> 1218</span>                old_field_name</div>
<div class="line"><span class="lineno"> 1219</span>            )</div>
<div class="line"><span class="lineno"> 1220</span>            new_field = self.to_state.models[app_label, model_name].get_field(</div>
<div class="line"><span class="lineno"> 1221</span>                field_name</div>
<div class="line"><span class="lineno"> 1222</span>            )</div>
<div class="line"><span class="lineno"> 1223</span>            dependencies = []</div>
<div class="line"><span class="lineno"> 1224</span>            <span class="comment"># Implement any model renames on relations; these are handled by RenameModel</span></div>
<div class="line"><span class="lineno"> 1225</span>            <span class="comment"># so we need to exclude them from the comparison</span></div>
<div class="line"><span class="lineno"> 1226</span>            <span class="keywordflow">if</span> hasattr(new_field, <span class="stringliteral">&quot;remote_field&quot;</span>) <span class="keywordflow">and</span> getattr(</div>
<div class="line"><span class="lineno"> 1227</span>                new_field.remote_field, <span class="stringliteral">&quot;model&quot;</span>, <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 1228</span>            ):</div>
<div class="line"><span class="lineno"> 1229</span>                rename_key = resolve_relation(</div>
<div class="line"><span class="lineno"> 1230</span>                    new_field.remote_field.model, app_label, model_name</div>
<div class="line"><span class="lineno"> 1231</span>                )</div>
<div class="line"><span class="lineno"> 1232</span>                <span class="keywordflow">if</span> rename_key <span class="keywordflow">in</span> self.renamed_models:</div>
<div class="line"><span class="lineno"> 1233</span>                    new_field.remote_field.model = old_field.remote_field.model</div>
<div class="line"><span class="lineno"> 1234</span>                <span class="comment"># Handle ForeignKey which can only have a single to_field.</span></div>
<div class="line"><span class="lineno"> 1235</span>                remote_field_name = getattr(new_field.remote_field, <span class="stringliteral">&quot;field_name&quot;</span>, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno"> 1236</span>                <span class="keywordflow">if</span> remote_field_name:</div>
<div class="line"><span class="lineno"> 1237</span>                    to_field_rename_key = rename_key + (remote_field_name,)</div>
<div class="line"><span class="lineno"> 1238</span>                    <span class="keywordflow">if</span> to_field_rename_key <span class="keywordflow">in</span> self.renamed_fields:</div>
<div class="line"><span class="lineno"> 1239</span>                        <span class="comment"># Repoint both model and field name because to_field</span></div>
<div class="line"><span class="lineno"> 1240</span>                        <span class="comment"># inclusion in ForeignKey.deconstruct() is based on</span></div>
<div class="line"><span class="lineno"> 1241</span>                        <span class="comment"># both.</span></div>
<div class="line"><span class="lineno"> 1242</span>                        new_field.remote_field.model = old_field.remote_field.model</div>
<div class="line"><span class="lineno"> 1243</span>                        new_field.remote_field.field_name = (</div>
<div class="line"><span class="lineno"> 1244</span>                            old_field.remote_field.field_name</div>
<div class="line"><span class="lineno"> 1245</span>                        )</div>
<div class="line"><span class="lineno"> 1246</span>                <span class="comment"># Handle ForeignObjects which can have multiple from_fields/to_fields.</span></div>
<div class="line"><span class="lineno"> 1247</span>                from_fields = getattr(new_field, <span class="stringliteral">&quot;from_fields&quot;</span>, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno"> 1248</span>                <span class="keywordflow">if</span> from_fields:</div>
<div class="line"><span class="lineno"> 1249</span>                    from_rename_key = (app_label, model_name)</div>
<div class="line"><span class="lineno"> 1250</span>                    new_field.from_fields = tuple(</div>
<div class="line"><span class="lineno"> 1251</span>                        [</div>
<div class="line"><span class="lineno"> 1252</span>                            self.renamed_fields.get(</div>
<div class="line"><span class="lineno"> 1253</span>                                from_rename_key + (from_field,), from_field</div>
<div class="line"><span class="lineno"> 1254</span>                            )</div>
<div class="line"><span class="lineno"> 1255</span>                            <span class="keywordflow">for</span> from_field <span class="keywordflow">in</span> from_fields</div>
<div class="line"><span class="lineno"> 1256</span>                        ]</div>
<div class="line"><span class="lineno"> 1257</span>                    )</div>
<div class="line"><span class="lineno"> 1258</span>                    new_field.to_fields = tuple(</div>
<div class="line"><span class="lineno"> 1259</span>                        [</div>
<div class="line"><span class="lineno"> 1260</span>                            self.renamed_fields.get(rename_key + (to_field,), to_field)</div>
<div class="line"><span class="lineno"> 1261</span>                            <span class="keywordflow">for</span> to_field <span class="keywordflow">in</span> new_field.to_fields</div>
<div class="line"><span class="lineno"> 1262</span>                        ]</div>
<div class="line"><span class="lineno"> 1263</span>                    )</div>
<div class="line"><span class="lineno"> 1264</span>                    <span class="keywordflow">if</span> old_from_fields := getattr(old_field, <span class="stringliteral">&quot;from_fields&quot;</span>, <span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 1265</span>                        old_field.from_fields = tuple(old_from_fields)</div>
<div class="line"><span class="lineno"> 1266</span>                        old_field.to_fields = tuple(old_field.to_fields)</div>
<div class="line"><span class="lineno"> 1267</span>                dependencies.extend(</div>
<div class="line"><span class="lineno"> 1268</span>                    self._get_dependencies_for_foreign_key(</div>
<div class="line"><span class="lineno"> 1269</span>                        app_label,</div>
<div class="line"><span class="lineno"> 1270</span>                        model_name,</div>
<div class="line"><span class="lineno"> 1271</span>                        new_field,</div>
<div class="line"><span class="lineno"> 1272</span>                        self.to_state,</div>
<div class="line"><span class="lineno"> 1273</span>                    )</div>
<div class="line"><span class="lineno"> 1274</span>                )</div>
<div class="line"><span class="lineno"> 1275</span>            <span class="keywordflow">if</span> hasattr(new_field, <span class="stringliteral">&quot;remote_field&quot;</span>) <span class="keywordflow">and</span> getattr(</div>
<div class="line"><span class="lineno"> 1276</span>                new_field.remote_field, <span class="stringliteral">&quot;through&quot;</span>, <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 1277</span>            ):</div>
<div class="line"><span class="lineno"> 1278</span>                rename_key = resolve_relation(</div>
<div class="line"><span class="lineno"> 1279</span>                    new_field.remote_field.through, app_label, model_name</div>
<div class="line"><span class="lineno"> 1280</span>                )</div>
<div class="line"><span class="lineno"> 1281</span>                <span class="keywordflow">if</span> rename_key <span class="keywordflow">in</span> self.renamed_models:</div>
<div class="line"><span class="lineno"> 1282</span>                    new_field.remote_field.through = old_field.remote_field.through</div>
<div class="line"><span class="lineno"> 1283</span>            old_field_dec = self.deep_deconstruct(old_field)</div>
<div class="line"><span class="lineno"> 1284</span>            new_field_dec = self.deep_deconstruct(new_field)</div>
<div class="line"><span class="lineno"> 1285</span>            <span class="comment"># If the field was confirmed to be renamed it means that only</span></div>
<div class="line"><span class="lineno"> 1286</span>            <span class="comment"># db_column was allowed to change which generate_renamed_fields()</span></div>
<div class="line"><span class="lineno"> 1287</span>            <span class="comment"># already accounts for by adding an AlterField operation.</span></div>
<div class="line"><span class="lineno"> 1288</span>            <span class="keywordflow">if</span> old_field_dec != new_field_dec <span class="keywordflow">and</span> old_field_name == field_name:</div>
<div class="line"><span class="lineno"> 1289</span>                both_m2m = old_field.many_to_many <span class="keywordflow">and</span> new_field.many_to_many</div>
<div class="line"><span class="lineno"> 1290</span>                neither_m2m = <span class="keywordflow">not</span> old_field.many_to_many <span class="keywordflow">and</span> <span class="keywordflow">not</span> new_field.many_to_many</div>
<div class="line"><span class="lineno"> 1291</span>                <span class="keywordflow">if</span> both_m2m <span class="keywordflow">or</span> neither_m2m:</div>
<div class="line"><span class="lineno"> 1292</span>                    <span class="comment"># Either both fields are m2m or neither is</span></div>
<div class="line"><span class="lineno"> 1293</span>                    preserve_default = <span class="keyword">True</span></div>
<div class="line"><span class="lineno"> 1294</span>                    <span class="keywordflow">if</span> (</div>
<div class="line"><span class="lineno"> 1295</span>                        old_field.null</div>
<div class="line"><span class="lineno"> 1296</span>                        <span class="keywordflow">and</span> <span class="keywordflow">not</span> new_field.null</div>
<div class="line"><span class="lineno"> 1297</span>                        <span class="keywordflow">and</span> <span class="keywordflow">not</span> new_field.has_default()</div>
<div class="line"><span class="lineno"> 1298</span>                        <span class="keywordflow">and</span> new_field.db_default <span class="keywordflow">is</span> models.NOT_PROVIDED</div>
<div class="line"><span class="lineno"> 1299</span>                        <span class="keywordflow">and</span> <span class="keywordflow">not</span> new_field.many_to_many</div>
<div class="line"><span class="lineno"> 1300</span>                    ):</div>
<div class="line"><span class="lineno"> 1301</span>                        field = new_field.clone()</div>
<div class="line"><span class="lineno"> 1302</span>                        new_default = self.questioner.ask_not_null_alteration(</div>
<div class="line"><span class="lineno"> 1303</span>                            field_name, model_name</div>
<div class="line"><span class="lineno"> 1304</span>                        )</div>
<div class="line"><span class="lineno"> 1305</span>                        <span class="keywordflow">if</span> new_default <span class="keywordflow">is</span> <span class="keywordflow">not</span> models.NOT_PROVIDED:</div>
<div class="line"><span class="lineno"> 1306</span>                            field.default = new_default</div>
<div class="line"><span class="lineno"> 1307</span>                            preserve_default = <span class="keyword">False</span></div>
<div class="line"><span class="lineno"> 1308</span>                    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1309</span>                        field = new_field</div>
<div class="line"><span class="lineno"> 1310</span>                    self.add_operation(</div>
<div class="line"><span class="lineno"> 1311</span>                        app_label,</div>
<div class="line"><span class="lineno"> 1312</span>                        operations.AlterField(</div>
<div class="line"><span class="lineno"> 1313</span>                            model_name=model_name,</div>
<div class="line"><span class="lineno"> 1314</span>                            name=field_name,</div>
<div class="line"><span class="lineno"> 1315</span>                            field=field,</div>
<div class="line"><span class="lineno"> 1316</span>                            preserve_default=preserve_default,</div>
<div class="line"><span class="lineno"> 1317</span>                        ),</div>
<div class="line"><span class="lineno"> 1318</span>                        dependencies=dependencies,</div>
<div class="line"><span class="lineno"> 1319</span>                    )</div>
<div class="line"><span class="lineno"> 1320</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1321</span>                    <span class="comment"># We cannot alter between m2m and concrete fields</span></div>
<div class="line"><span class="lineno"> 1322</span>                    self._generate_removed_field(app_label, model_name, field_name)</div>
<div class="line"><span class="lineno"> 1323</span>                    self._generate_added_field(app_label, model_name, field_name)</div>
<div class="line"><span class="lineno"> 1324</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l01111">_generate_added_field()</a>, <a class="el" href="autodetector_8py_source.html#l01176">_generate_removed_field()</a>, <a class="el" href="autodetector_8py_source.html#l01507">_get_dependencies_for_foreign_key()</a>, <a class="el" href="autodetector_8py_source.html#l00534">add_operation()</a>, <a class="el" href="autodetector_8py_source.html#l00073">deep_deconstruct()</a>, <a class="el" href="autodetector_8py_source.html#l00056">from_state</a>, <a class="el" href="autodetector_8py_source.html#l00247">new_field_keys</a>, <a class="el" href="autodetector_8py_source.html#l00240">old_field_keys</a>, <a class="el" href="autodetector_8py_source.html#l00058">questioner</a>, <a class="el" href="autodetector_8py_source.html#l00147">renamed_fields</a>, <a class="el" href="autodetector_8py_source.html#l00572">renamed_models</a>, and <a class="el" href="autodetector_8py_source.html#l00057">to_state</a>.</p>

</div>
</div>
<a id="a61d033562bb5b6f174e5c686fdc9a228" name="a61d033562bb5b6f174e5c686fdc9a228"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61d033562bb5b6f174e5c686fdc9a228">&#9670;&#160;</a></span>generate_altered_managers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.generate_altered_managers </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l01800">1800</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1800</span>    <span class="keyword">def </span>generate_altered_managers(self):</div>
<div class="line"><span class="lineno"> 1801</span>        <span class="keywordflow">for</span> app_label, model_name <span class="keywordflow">in</span> sorted(self.kept_model_keys):</div>
<div class="line"><span class="lineno"> 1802</span>            old_model_name = self.renamed_models.get(</div>
<div class="line"><span class="lineno"> 1803</span>                (app_label, model_name), model_name</div>
<div class="line"><span class="lineno"> 1804</span>            )</div>
<div class="line"><span class="lineno"> 1805</span>            old_model_state = self.from_state.models[app_label, old_model_name]</div>
<div class="line"><span class="lineno"> 1806</span>            new_model_state = self.to_state.models[app_label, model_name]</div>
<div class="line"><span class="lineno"> 1807</span>            <span class="keywordflow">if</span> old_model_state.managers != new_model_state.managers:</div>
<div class="line"><span class="lineno"> 1808</span>                self.add_operation(</div>
<div class="line"><span class="lineno"> 1809</span>                    app_label,</div>
<div class="line"><span class="lineno"> 1810</span>                    operations.AlterModelManagers(</div>
<div class="line"><span class="lineno"> 1811</span>                        name=model_name,</div>
<div class="line"><span class="lineno"> 1812</span>                        managers=new_model_state.managers,</div>
<div class="line"><span class="lineno"> 1813</span>                    ),</div>
<div class="line"><span class="lineno"> 1814</span>                )</div>
<div class="line"><span class="lineno"> 1815</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l00534">add_operation()</a>, <a class="el" href="autodetector_8py_source.html#l00056">from_state</a>, <a class="el" href="autodetector_8py_source.html#l00236">kept_model_keys</a>, <a class="el" href="autodetector_8py_source.html#l00572">renamed_models</a>, and <a class="el" href="autodetector_8py_source.html#l00057">to_state</a>.</p>

</div>
</div>
<a id="ae8b0b29606d2f848c9de8e284aa9c288" name="ae8b0b29606d2f848c9de8e284aa9c288"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8b0b29606d2f848c9de8e284aa9c288">&#9670;&#160;</a></span>generate_altered_options()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.generate_altered_options </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Work out if any non-schema-affecting options have changed and make an
operation to represent them in state changes (in case Python code in
migrations needs them).
</pre> 
<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l01726">1726</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1726</span>    <span class="keyword">def </span>generate_altered_options(self):</div>
<div class="line"><span class="lineno"> 1727</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1728</span><span class="stringliteral">        Work out if any non-schema-affecting options have changed and make an</span></div>
<div class="line"><span class="lineno"> 1729</span><span class="stringliteral">        operation to represent them in state changes (in case Python code in</span></div>
<div class="line"><span class="lineno"> 1730</span><span class="stringliteral">        migrations needs them).</span></div>
<div class="line"><span class="lineno"> 1731</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1732</span>        models_to_check = self.kept_model_keys.union(</div>
<div class="line"><span class="lineno"> 1733</span>            self.kept_proxy_keys,</div>
<div class="line"><span class="lineno"> 1734</span>            self.kept_unmanaged_keys,</div>
<div class="line"><span class="lineno"> 1735</span>            <span class="comment"># unmanaged converted to managed</span></div>
<div class="line"><span class="lineno"> 1736</span>            self.old_unmanaged_keys &amp; self.new_model_keys,</div>
<div class="line"><span class="lineno"> 1737</span>            <span class="comment"># managed converted to unmanaged</span></div>
<div class="line"><span class="lineno"> 1738</span>            self.old_model_keys &amp; self.new_unmanaged_keys,</div>
<div class="line"><span class="lineno"> 1739</span>        )</div>
<div class="line"><span class="lineno"> 1740</span> </div>
<div class="line"><span class="lineno"> 1741</span>        <span class="keywordflow">for</span> app_label, model_name <span class="keywordflow">in</span> sorted(models_to_check):</div>
<div class="line"><span class="lineno"> 1742</span>            old_model_name = self.renamed_models.get(</div>
<div class="line"><span class="lineno"> 1743</span>                (app_label, model_name), model_name</div>
<div class="line"><span class="lineno"> 1744</span>            )</div>
<div class="line"><span class="lineno"> 1745</span>            old_model_state = self.from_state.models[app_label, old_model_name]</div>
<div class="line"><span class="lineno"> 1746</span>            new_model_state = self.to_state.models[app_label, model_name]</div>
<div class="line"><span class="lineno"> 1747</span>            old_options = {</div>
<div class="line"><span class="lineno"> 1748</span>                key: value</div>
<div class="line"><span class="lineno"> 1749</span>                <span class="keywordflow">for</span> key, value <span class="keywordflow">in</span> old_model_state.options.items()</div>
<div class="line"><span class="lineno"> 1750</span>                <span class="keywordflow">if</span> key <span class="keywordflow">in</span> AlterModelOptions.ALTER_OPTION_KEYS</div>
<div class="line"><span class="lineno"> 1751</span>            }</div>
<div class="line"><span class="lineno"> 1752</span>            new_options = {</div>
<div class="line"><span class="lineno"> 1753</span>                key: value</div>
<div class="line"><span class="lineno"> 1754</span>                <span class="keywordflow">for</span> key, value <span class="keywordflow">in</span> new_model_state.options.items()</div>
<div class="line"><span class="lineno"> 1755</span>                <span class="keywordflow">if</span> key <span class="keywordflow">in</span> AlterModelOptions.ALTER_OPTION_KEYS</div>
<div class="line"><span class="lineno"> 1756</span>            }</div>
<div class="line"><span class="lineno"> 1757</span>            <span class="keywordflow">if</span> old_options != new_options:</div>
<div class="line"><span class="lineno"> 1758</span>                self.add_operation(</div>
<div class="line"><span class="lineno"> 1759</span>                    app_label,</div>
<div class="line"><span class="lineno"> 1760</span>                    operations.AlterModelOptions(</div>
<div class="line"><span class="lineno"> 1761</span>                        name=model_name,</div>
<div class="line"><span class="lineno"> 1762</span>                        options=new_options,</div>
<div class="line"><span class="lineno"> 1763</span>                    ),</div>
<div class="line"><span class="lineno"> 1764</span>                )</div>
<div class="line"><span class="lineno"> 1765</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l00534">add_operation()</a>, <a class="el" href="autodetector_8py_source.html#l00056">from_state</a>, <a class="el" href="autodetector_8py_source.html#l00236">kept_model_keys</a>, <a class="el" href="autodetector_8py_source.html#l00237">kept_proxy_keys</a>, <a class="el" href="autodetector_8py_source.html#l00238">kept_unmanaged_keys</a>, <a class="el" href="autodetector_8py_source.html#l00154">new_model_keys</a>, <a class="el" href="autodetector_8py_source.html#l00156">new_unmanaged_keys</a>, <a class="el" href="autodetector_8py_source.html#l00151">old_model_keys</a>, <a class="el" href="autodetector_8py_source.html#l00153">old_unmanaged_keys</a>, <a class="el" href="autodetector_8py_source.html#l00572">renamed_models</a>, and <a class="el" href="autodetector_8py_source.html#l00057">to_state</a>.</p>

</div>
</div>
<a id="afbaaa4665aafce84671990dd6cfa570c" name="afbaaa4665aafce84671990dd6cfa570c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbaaa4665aafce84671990dd6cfa570c">&#9670;&#160;</a></span>generate_altered_order_with_respect_to()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.generate_altered_order_with_respect_to </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l01766">1766</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1766</span>    <span class="keyword">def </span>generate_altered_order_with_respect_to(self):</div>
<div class="line"><span class="lineno"> 1767</span>        <span class="keywordflow">for</span> app_label, model_name <span class="keywordflow">in</span> sorted(self.kept_model_keys):</div>
<div class="line"><span class="lineno"> 1768</span>            old_model_name = self.renamed_models.get(</div>
<div class="line"><span class="lineno"> 1769</span>                (app_label, model_name), model_name</div>
<div class="line"><span class="lineno"> 1770</span>            )</div>
<div class="line"><span class="lineno"> 1771</span>            old_model_state = self.from_state.models[app_label, old_model_name]</div>
<div class="line"><span class="lineno"> 1772</span>            new_model_state = self.to_state.models[app_label, model_name]</div>
<div class="line"><span class="lineno"> 1773</span>            <span class="keywordflow">if</span> old_model_state.options.get(</div>
<div class="line"><span class="lineno"> 1774</span>                <span class="stringliteral">&quot;order_with_respect_to&quot;</span></div>
<div class="line"><span class="lineno"> 1775</span>            ) != new_model_state.options.get(<span class="stringliteral">&quot;order_with_respect_to&quot;</span>):</div>
<div class="line"><span class="lineno"> 1776</span>                <span class="comment"># Make sure it comes second if we&#39;re adding</span></div>
<div class="line"><span class="lineno"> 1777</span>                <span class="comment"># (removal dependency is part of RemoveField)</span></div>
<div class="line"><span class="lineno"> 1778</span>                dependencies = []</div>
<div class="line"><span class="lineno"> 1779</span>                <span class="keywordflow">if</span> new_model_state.options.get(<span class="stringliteral">&quot;order_with_respect_to&quot;</span>):</div>
<div class="line"><span class="lineno"> 1780</span>                    dependencies.append(</div>
<div class="line"><span class="lineno"> 1781</span>                        OperationDependency(</div>
<div class="line"><span class="lineno"> 1782</span>                            app_label,</div>
<div class="line"><span class="lineno"> 1783</span>                            model_name,</div>
<div class="line"><span class="lineno"> 1784</span>                            new_model_state.options[<span class="stringliteral">&quot;order_with_respect_to&quot;</span>],</div>
<div class="line"><span class="lineno"> 1785</span>                            OperationDependency.Type.CREATE,</div>
<div class="line"><span class="lineno"> 1786</span>                        )</div>
<div class="line"><span class="lineno"> 1787</span>                    )</div>
<div class="line"><span class="lineno"> 1788</span>                <span class="comment"># Actually generate the operation</span></div>
<div class="line"><span class="lineno"> 1789</span>                self.add_operation(</div>
<div class="line"><span class="lineno"> 1790</span>                    app_label,</div>
<div class="line"><span class="lineno"> 1791</span>                    operations.AlterOrderWithRespectTo(</div>
<div class="line"><span class="lineno"> 1792</span>                        name=model_name,</div>
<div class="line"><span class="lineno"> 1793</span>                        order_with_respect_to=new_model_state.options.get(</div>
<div class="line"><span class="lineno"> 1794</span>                            <span class="stringliteral">&quot;order_with_respect_to&quot;</span></div>
<div class="line"><span class="lineno"> 1795</span>                        ),</div>
<div class="line"><span class="lineno"> 1796</span>                    ),</div>
<div class="line"><span class="lineno"> 1797</span>                    dependencies=dependencies,</div>
<div class="line"><span class="lineno"> 1798</span>                )</div>
<div class="line"><span class="lineno"> 1799</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l00534">add_operation()</a>, <a class="el" href="autodetector_8py_source.html#l00056">from_state</a>, <a class="el" href="autodetector_8py_source.html#l00236">kept_model_keys</a>, <a class="el" href="autodetector_8py_source.html#l00572">renamed_models</a>, and <a class="el" href="autodetector_8py_source.html#l00057">to_state</a>.</p>

</div>
</div>
<a id="a9526d41d7e0f7b573e329bda9c5cb75d" name="a9526d41d7e0f7b573e329bda9c5cb75d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9526d41d7e0f7b573e329bda9c5cb75d">&#9670;&#160;</a></span>generate_altered_unique_together()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.generate_altered_unique_together </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l01680">1680</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1680</span>    <span class="keyword">def </span>generate_altered_unique_together(self):</div>
<div class="line"><span class="lineno"> 1681</span>        self._generate_altered_foo_together(operations.AlterUniqueTogether)</div>
<div class="line"><span class="lineno"> 1682</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l01664">_generate_altered_foo_together()</a>.</p>

</div>
</div>
<a id="a13e6732c0e8501ff2ab490f71e0ea527" name="a13e6732c0e8501ff2ab490f71e0ea527"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13e6732c0e8501ff2ab490f71e0ea527">&#9670;&#160;</a></span>generate_created_models()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.generate_created_models </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Find all new models (both managed and unmanaged) and make create
operations for them as well as separate operations to create any
foreign key or M2M relationships (these are optimized later, if
possible).

Defer any model options that refer to collections of fields that might
be deferred (e.g. unique_together).
</pre> 
<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00634">634</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  634</span>    <span class="keyword">def </span>generate_created_models(self):</div>
<div class="line"><span class="lineno">  635</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  636</span><span class="stringliteral">        Find all new models (both managed and unmanaged) and make create</span></div>
<div class="line"><span class="lineno">  637</span><span class="stringliteral">        operations for them as well as separate operations to create any</span></div>
<div class="line"><span class="lineno">  638</span><span class="stringliteral">        foreign key or M2M relationships (these are optimized later, if</span></div>
<div class="line"><span class="lineno">  639</span><span class="stringliteral">        possible).</span></div>
<div class="line"><span class="lineno">  640</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  641</span><span class="stringliteral">        Defer any model options that refer to collections of fields that might</span></div>
<div class="line"><span class="lineno">  642</span><span class="stringliteral">        be deferred (e.g. unique_together).</span></div>
<div class="line"><span class="lineno">  643</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  644</span>        old_keys = self.old_model_keys | self.old_unmanaged_keys</div>
<div class="line"><span class="lineno">  645</span>        added_models = self.new_model_keys - old_keys</div>
<div class="line"><span class="lineno">  646</span>        added_unmanaged_models = self.new_unmanaged_keys - old_keys</div>
<div class="line"><span class="lineno">  647</span>        all_added_models = chain(</div>
<div class="line"><span class="lineno">  648</span>            sorted(added_models, key=self.swappable_first_key, reverse=<span class="keyword">True</span>),</div>
<div class="line"><span class="lineno">  649</span>            sorted(added_unmanaged_models, key=self.swappable_first_key, reverse=<span class="keyword">True</span>),</div>
<div class="line"><span class="lineno">  650</span>        )</div>
<div class="line"><span class="lineno">  651</span>        <span class="keywordflow">for</span> app_label, model_name <span class="keywordflow">in</span> all_added_models:</div>
<div class="line"><span class="lineno">  652</span>            model_state = self.to_state.models[app_label, model_name]</div>
<div class="line"><span class="lineno">  653</span>            <span class="comment"># Gather related fields</span></div>
<div class="line"><span class="lineno">  654</span>            related_fields = {}</div>
<div class="line"><span class="lineno">  655</span>            primary_key_rel = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  656</span>            <span class="keywordflow">for</span> field_name, field <span class="keywordflow">in</span> model_state.fields.items():</div>
<div class="line"><span class="lineno">  657</span>                <span class="keywordflow">if</span> field.remote_field:</div>
<div class="line"><span class="lineno">  658</span>                    <span class="keywordflow">if</span> field.remote_field.model:</div>
<div class="line"><span class="lineno">  659</span>                        <span class="keywordflow">if</span> field.primary_key:</div>
<div class="line"><span class="lineno">  660</span>                            primary_key_rel = field.remote_field.model</div>
<div class="line"><span class="lineno">  661</span>                        <span class="keywordflow">elif</span> <span class="keywordflow">not</span> field.remote_field.parent_link:</div>
<div class="line"><span class="lineno">  662</span>                            related_fields[field_name] = field</div>
<div class="line"><span class="lineno">  663</span>                    <span class="keywordflow">if</span> getattr(field.remote_field, <span class="stringliteral">&quot;through&quot;</span>, <span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">  664</span>                        related_fields[field_name] = field</div>
<div class="line"><span class="lineno">  665</span> </div>
<div class="line"><span class="lineno">  666</span>            <span class="comment"># Are there indexes/unique_together to defer?</span></div>
<div class="line"><span class="lineno">  667</span>            indexes = model_state.options.pop(<span class="stringliteral">&quot;indexes&quot;</span>)</div>
<div class="line"><span class="lineno">  668</span>            constraints = model_state.options.pop(<span class="stringliteral">&quot;constraints&quot;</span>)</div>
<div class="line"><span class="lineno">  669</span>            unique_together = model_state.options.pop(<span class="stringliteral">&quot;unique_together&quot;</span>, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  670</span>            order_with_respect_to = model_state.options.pop(</div>
<div class="line"><span class="lineno">  671</span>                <span class="stringliteral">&quot;order_with_respect_to&quot;</span>, <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  672</span>            )</div>
<div class="line"><span class="lineno">  673</span>            <span class="comment"># Depend on the deletion of any possible proxy version of us</span></div>
<div class="line"><span class="lineno">  674</span>            dependencies = [</div>
<div class="line"><span class="lineno">  675</span>                OperationDependency(</div>
<div class="line"><span class="lineno">  676</span>                    app_label, model_name, <span class="keywordtype">None</span>, OperationDependency.Type.REMOVE</div>
<div class="line"><span class="lineno">  677</span>                ),</div>
<div class="line"><span class="lineno">  678</span>            ]</div>
<div class="line"><span class="lineno">  679</span>            <span class="comment"># Depend on all bases</span></div>
<div class="line"><span class="lineno">  680</span>            <span class="keywordflow">for</span> base <span class="keywordflow">in</span> model_state.bases:</div>
<div class="line"><span class="lineno">  681</span>                <span class="keywordflow">if</span> isinstance(base, str) <span class="keywordflow">and</span> <span class="stringliteral">&quot;.&quot;</span> <span class="keywordflow">in</span> base:</div>
<div class="line"><span class="lineno">  682</span>                    base_app_label, base_name = base.split(<span class="stringliteral">&quot;.&quot;</span>, 1)</div>
<div class="line"><span class="lineno">  683</span>                    dependencies.append(</div>
<div class="line"><span class="lineno">  684</span>                        OperationDependency(</div>
<div class="line"><span class="lineno">  685</span>                            base_app_label,</div>
<div class="line"><span class="lineno">  686</span>                            base_name,</div>
<div class="line"><span class="lineno">  687</span>                            <span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno">  688</span>                            OperationDependency.Type.CREATE,</div>
<div class="line"><span class="lineno">  689</span>                        )</div>
<div class="line"><span class="lineno">  690</span>                    )</div>
<div class="line"><span class="lineno">  691</span>                    <span class="comment"># Depend on the removal of base fields if the new model has</span></div>
<div class="line"><span class="lineno">  692</span>                    <span class="comment"># a field with the same name.</span></div>
<div class="line"><span class="lineno">  693</span>                    old_base_model_state = self.from_state.models.get(</div>
<div class="line"><span class="lineno">  694</span>                        (base_app_label, base_name)</div>
<div class="line"><span class="lineno">  695</span>                    )</div>
<div class="line"><span class="lineno">  696</span>                    new_base_model_state = self.to_state.models.get(</div>
<div class="line"><span class="lineno">  697</span>                        (base_app_label, base_name)</div>
<div class="line"><span class="lineno">  698</span>                    )</div>
<div class="line"><span class="lineno">  699</span>                    <span class="keywordflow">if</span> old_base_model_state <span class="keywordflow">and</span> new_base_model_state:</div>
<div class="line"><span class="lineno">  700</span>                        removed_base_fields = (</div>
<div class="line"><span class="lineno">  701</span>                            set(old_base_model_state.fields)</div>
<div class="line"><span class="lineno">  702</span>                            .difference(</div>
<div class="line"><span class="lineno">  703</span>                                new_base_model_state.fields,</div>
<div class="line"><span class="lineno">  704</span>                            )</div>
<div class="line"><span class="lineno">  705</span>                            .intersection(model_state.fields)</div>
<div class="line"><span class="lineno">  706</span>                        )</div>
<div class="line"><span class="lineno">  707</span>                        <span class="keywordflow">for</span> removed_base_field <span class="keywordflow">in</span> removed_base_fields:</div>
<div class="line"><span class="lineno">  708</span>                            dependencies.append(</div>
<div class="line"><span class="lineno">  709</span>                                OperationDependency(</div>
<div class="line"><span class="lineno">  710</span>                                    base_app_label,</div>
<div class="line"><span class="lineno">  711</span>                                    base_name,</div>
<div class="line"><span class="lineno">  712</span>                                    removed_base_field,</div>
<div class="line"><span class="lineno">  713</span>                                    OperationDependency.Type.REMOVE,</div>
<div class="line"><span class="lineno">  714</span>                                )</div>
<div class="line"><span class="lineno">  715</span>                            )</div>
<div class="line"><span class="lineno">  716</span>            <span class="comment"># Depend on the other end of the primary key if it&#39;s a relation</span></div>
<div class="line"><span class="lineno">  717</span>            <span class="keywordflow">if</span> primary_key_rel:</div>
<div class="line"><span class="lineno">  718</span>                dependencies.append(</div>
<div class="line"><span class="lineno">  719</span>                    OperationDependency(</div>
<div class="line"><span class="lineno">  720</span>                        *resolve_relation(primary_key_rel, app_label, model_name),</div>
<div class="line"><span class="lineno">  721</span>                        <span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno">  722</span>                        OperationDependency.Type.CREATE,</div>
<div class="line"><span class="lineno">  723</span>                    ),</div>
<div class="line"><span class="lineno">  724</span>                )</div>
<div class="line"><span class="lineno">  725</span>            <span class="comment"># Generate creation operation</span></div>
<div class="line"><span class="lineno">  726</span>            self.add_operation(</div>
<div class="line"><span class="lineno">  727</span>                app_label,</div>
<div class="line"><span class="lineno">  728</span>                operations.CreateModel(</div>
<div class="line"><span class="lineno">  729</span>                    name=model_state.name,</div>
<div class="line"><span class="lineno">  730</span>                    fields=[</div>
<div class="line"><span class="lineno">  731</span>                        d</div>
<div class="line"><span class="lineno">  732</span>                        <span class="keywordflow">for</span> d <span class="keywordflow">in</span> model_state.fields.items()</div>
<div class="line"><span class="lineno">  733</span>                        <span class="keywordflow">if</span> d[0] <span class="keywordflow">not</span> <span class="keywordflow">in</span> related_fields</div>
<div class="line"><span class="lineno">  734</span>                    ],</div>
<div class="line"><span class="lineno">  735</span>                    options=model_state.options,</div>
<div class="line"><span class="lineno">  736</span>                    bases=model_state.bases,</div>
<div class="line"><span class="lineno">  737</span>                    managers=model_state.managers,</div>
<div class="line"><span class="lineno">  738</span>                ),</div>
<div class="line"><span class="lineno">  739</span>                dependencies=dependencies,</div>
<div class="line"><span class="lineno">  740</span>                beginning=<span class="keyword">True</span>,</div>
<div class="line"><span class="lineno">  741</span>            )</div>
<div class="line"><span class="lineno">  742</span> </div>
<div class="line"><span class="lineno">  743</span>            <span class="comment"># Don&#39;t add operations which modify the database for unmanaged models</span></div>
<div class="line"><span class="lineno">  744</span>            <span class="keywordflow">if</span> <span class="keywordflow">not</span> model_state.options.get(<span class="stringliteral">&quot;managed&quot;</span>, <span class="keyword">True</span>):</div>
<div class="line"><span class="lineno">  745</span>                <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  746</span> </div>
<div class="line"><span class="lineno">  747</span>            <span class="comment"># Generate operations for each related field</span></div>
<div class="line"><span class="lineno">  748</span>            <span class="keywordflow">for</span> name, field <span class="keywordflow">in</span> sorted(related_fields.items()):</div>
<div class="line"><span class="lineno">  749</span>                dependencies = self._get_dependencies_for_foreign_key(</div>
<div class="line"><span class="lineno">  750</span>                    app_label,</div>
<div class="line"><span class="lineno">  751</span>                    model_name,</div>
<div class="line"><span class="lineno">  752</span>                    field,</div>
<div class="line"><span class="lineno">  753</span>                    self.to_state,</div>
<div class="line"><span class="lineno">  754</span>                )</div>
<div class="line"><span class="lineno">  755</span>                <span class="comment"># Depend on our own model being created</span></div>
<div class="line"><span class="lineno">  756</span>                dependencies.append(</div>
<div class="line"><span class="lineno">  757</span>                    OperationDependency(</div>
<div class="line"><span class="lineno">  758</span>                        app_label, model_name, <span class="keywordtype">None</span>, OperationDependency.Type.CREATE</div>
<div class="line"><span class="lineno">  759</span>                    )</div>
<div class="line"><span class="lineno">  760</span>                )</div>
<div class="line"><span class="lineno">  761</span>                <span class="comment"># Make operation</span></div>
<div class="line"><span class="lineno">  762</span>                self.add_operation(</div>
<div class="line"><span class="lineno">  763</span>                    app_label,</div>
<div class="line"><span class="lineno">  764</span>                    operations.AddField(</div>
<div class="line"><span class="lineno">  765</span>                        model_name=model_name,</div>
<div class="line"><span class="lineno">  766</span>                        name=name,</div>
<div class="line"><span class="lineno">  767</span>                        field=field,</div>
<div class="line"><span class="lineno">  768</span>                    ),</div>
<div class="line"><span class="lineno">  769</span>                    dependencies=list(set(dependencies)),</div>
<div class="line"><span class="lineno">  770</span>                )</div>
<div class="line"><span class="lineno">  771</span>            <span class="comment"># Generate other opns</span></div>
<div class="line"><span class="lineno">  772</span>            <span class="keywordflow">if</span> order_with_respect_to:</div>
<div class="line"><span class="lineno">  773</span>                self.add_operation(</div>
<div class="line"><span class="lineno">  774</span>                    app_label,</div>
<div class="line"><span class="lineno">  775</span>                    operations.AlterOrderWithRespectTo(</div>
<div class="line"><span class="lineno">  776</span>                        name=model_name,</div>
<div class="line"><span class="lineno">  777</span>                        order_with_respect_to=order_with_respect_to,</div>
<div class="line"><span class="lineno">  778</span>                    ),</div>
<div class="line"><span class="lineno">  779</span>                    dependencies=[</div>
<div class="line"><span class="lineno">  780</span>                        OperationDependency(</div>
<div class="line"><span class="lineno">  781</span>                            app_label,</div>
<div class="line"><span class="lineno">  782</span>                            model_name,</div>
<div class="line"><span class="lineno">  783</span>                            order_with_respect_to,</div>
<div class="line"><span class="lineno">  784</span>                            OperationDependency.Type.CREATE,</div>
<div class="line"><span class="lineno">  785</span>                        ),</div>
<div class="line"><span class="lineno">  786</span>                        OperationDependency(</div>
<div class="line"><span class="lineno">  787</span>                            app_label, model_name, <span class="keywordtype">None</span>, OperationDependency.Type.CREATE</div>
<div class="line"><span class="lineno">  788</span>                        ),</div>
<div class="line"><span class="lineno">  789</span>                    ],</div>
<div class="line"><span class="lineno">  790</span>                )</div>
<div class="line"><span class="lineno">  791</span>            related_dependencies = [</div>
<div class="line"><span class="lineno">  792</span>                OperationDependency(</div>
<div class="line"><span class="lineno">  793</span>                    app_label, model_name, name, OperationDependency.Type.CREATE</div>
<div class="line"><span class="lineno">  794</span>                )</div>
<div class="line"><span class="lineno">  795</span>                <span class="keywordflow">for</span> name <span class="keywordflow">in</span> sorted(related_fields)</div>
<div class="line"><span class="lineno">  796</span>            ]</div>
<div class="line"><span class="lineno">  797</span>            related_dependencies.append(</div>
<div class="line"><span class="lineno">  798</span>                OperationDependency(</div>
<div class="line"><span class="lineno">  799</span>                    app_label, model_name, <span class="keywordtype">None</span>, OperationDependency.Type.CREATE</div>
<div class="line"><span class="lineno">  800</span>                )</div>
<div class="line"><span class="lineno">  801</span>            )</div>
<div class="line"><span class="lineno">  802</span>            <span class="keywordflow">for</span> index <span class="keywordflow">in</span> indexes:</div>
<div class="line"><span class="lineno">  803</span>                self.add_operation(</div>
<div class="line"><span class="lineno">  804</span>                    app_label,</div>
<div class="line"><span class="lineno">  805</span>                    operations.AddIndex(</div>
<div class="line"><span class="lineno">  806</span>                        model_name=model_name,</div>
<div class="line"><span class="lineno">  807</span>                        index=index,</div>
<div class="line"><span class="lineno">  808</span>                    ),</div>
<div class="line"><span class="lineno">  809</span>                    dependencies=related_dependencies,</div>
<div class="line"><span class="lineno">  810</span>                )</div>
<div class="line"><span class="lineno">  811</span>            <span class="keywordflow">for</span> constraint <span class="keywordflow">in</span> constraints:</div>
<div class="line"><span class="lineno">  812</span>                self.add_operation(</div>
<div class="line"><span class="lineno">  813</span>                    app_label,</div>
<div class="line"><span class="lineno">  814</span>                    operations.AddConstraint(</div>
<div class="line"><span class="lineno">  815</span>                        model_name=model_name,</div>
<div class="line"><span class="lineno">  816</span>                        constraint=constraint,</div>
<div class="line"><span class="lineno">  817</span>                    ),</div>
<div class="line"><span class="lineno">  818</span>                    dependencies=related_dependencies,</div>
<div class="line"><span class="lineno">  819</span>                )</div>
<div class="line"><span class="lineno">  820</span>            <span class="keywordflow">if</span> unique_together:</div>
<div class="line"><span class="lineno">  821</span>                self.add_operation(</div>
<div class="line"><span class="lineno">  822</span>                    app_label,</div>
<div class="line"><span class="lineno">  823</span>                    operations.AlterUniqueTogether(</div>
<div class="line"><span class="lineno">  824</span>                        name=model_name,</div>
<div class="line"><span class="lineno">  825</span>                        unique_together=unique_together,</div>
<div class="line"><span class="lineno">  826</span>                    ),</div>
<div class="line"><span class="lineno">  827</span>                    dependencies=related_dependencies,</div>
<div class="line"><span class="lineno">  828</span>                )</div>
<div class="line"><span class="lineno">  829</span>            <span class="comment"># Fix relationships if the model changed from a proxy model to a</span></div>
<div class="line"><span class="lineno">  830</span>            <span class="comment"># concrete model.</span></div>
<div class="line"><span class="lineno">  831</span>            relations = self.to_state.relations</div>
<div class="line"><span class="lineno">  832</span>            <span class="keywordflow">if</span> (app_label, model_name) <span class="keywordflow">in</span> self.old_proxy_keys:</div>
<div class="line"><span class="lineno">  833</span>                <span class="keywordflow">for</span> related_model_key, related_fields <span class="keywordflow">in</span> relations[</div>
<div class="line"><span class="lineno">  834</span>                    app_label, model_name</div>
<div class="line"><span class="lineno">  835</span>                ].items():</div>
<div class="line"><span class="lineno">  836</span>                    related_model_state = self.to_state.models[related_model_key]</div>
<div class="line"><span class="lineno">  837</span>                    <span class="keywordflow">for</span> related_field_name, related_field <span class="keywordflow">in</span> related_fields.items():</div>
<div class="line"><span class="lineno">  838</span>                        self.add_operation(</div>
<div class="line"><span class="lineno">  839</span>                            related_model_state.app_label,</div>
<div class="line"><span class="lineno">  840</span>                            operations.AlterField(</div>
<div class="line"><span class="lineno">  841</span>                                model_name=related_model_state.name,</div>
<div class="line"><span class="lineno">  842</span>                                name=related_field_name,</div>
<div class="line"><span class="lineno">  843</span>                                field=related_field,</div>
<div class="line"><span class="lineno">  844</span>                            ),</div>
<div class="line"><span class="lineno">  845</span>                            dependencies=[</div>
<div class="line"><span class="lineno">  846</span>                                OperationDependency(</div>
<div class="line"><span class="lineno">  847</span>                                    app_label,</div>
<div class="line"><span class="lineno">  848</span>                                    model_name,</div>
<div class="line"><span class="lineno">  849</span>                                    <span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno">  850</span>                                    OperationDependency.Type.CREATE,</div>
<div class="line"><span class="lineno">  851</span>                                )</div>
<div class="line"><span class="lineno">  852</span>                            ],</div>
<div class="line"><span class="lineno">  853</span>                        )</div>
<div class="line"><span class="lineno">  854</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l01507">_get_dependencies_for_foreign_key()</a>, <a class="el" href="autodetector_8py_source.html#l00534">add_operation()</a>, <a class="el" href="autodetector_8py_source.html#l00056">from_state</a>, <a class="el" href="autodetector_8py_source.html#l00154">new_model_keys</a>, <a class="el" href="autodetector_8py_source.html#l00156">new_unmanaged_keys</a>, <a class="el" href="autodetector_8py_source.html#l00151">old_model_keys</a>, <a class="el" href="autodetector_8py_source.html#l00152">old_proxy_keys</a>, <a class="el" href="autodetector_8py_source.html#l00153">old_unmanaged_keys</a>, <a class="el" href="autodetector_8py_source.html#l00543">swappable_first_key()</a>, and <a class="el" href="autodetector_8py_source.html#l00057">to_state</a>.</p>

</div>
</div>
<a id="a3221ae34e5a26be8a8d61cc9931e02ff" name="a3221ae34e5a26be8a8d61cc9931e02ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3221ae34e5a26be8a8d61cc9931e02ff">&#9670;&#160;</a></span>generate_created_proxies()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.generate_created_proxies </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Make CreateModel statements for proxy models. Use the same statements
as that way there's less code duplication, but for proxy models it's
safe to skip all the pointless field stuff and chuck out an operation.
</pre> 
<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00855">855</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  855</span>    <span class="keyword">def </span>generate_created_proxies(self):</div>
<div class="line"><span class="lineno">  856</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  857</span><span class="stringliteral">        Make CreateModel statements for proxy models. Use the same statements</span></div>
<div class="line"><span class="lineno">  858</span><span class="stringliteral">        as that way there&#39;s less code duplication, but for proxy models it&#39;s</span></div>
<div class="line"><span class="lineno">  859</span><span class="stringliteral">        safe to skip all the pointless field stuff and chuck out an operation.</span></div>
<div class="line"><span class="lineno">  860</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  861</span>        added = self.new_proxy_keys - self.old_proxy_keys</div>
<div class="line"><span class="lineno">  862</span>        <span class="keywordflow">for</span> app_label, model_name <span class="keywordflow">in</span> sorted(added):</div>
<div class="line"><span class="lineno">  863</span>            model_state = self.to_state.models[app_label, model_name]</div>
<div class="line"><span class="lineno">  864</span>            <span class="keyword">assert</span> model_state.options.get(<span class="stringliteral">&quot;proxy&quot;</span>)</div>
<div class="line"><span class="lineno">  865</span>            <span class="comment"># Depend on the deletion of any possible non-proxy version of us</span></div>
<div class="line"><span class="lineno">  866</span>            dependencies = [</div>
<div class="line"><span class="lineno">  867</span>                OperationDependency(</div>
<div class="line"><span class="lineno">  868</span>                    app_label, model_name, <span class="keywordtype">None</span>, OperationDependency.Type.REMOVE</div>
<div class="line"><span class="lineno">  869</span>                ),</div>
<div class="line"><span class="lineno">  870</span>            ]</div>
<div class="line"><span class="lineno">  871</span>            <span class="comment"># Depend on all bases</span></div>
<div class="line"><span class="lineno">  872</span>            <span class="keywordflow">for</span> base <span class="keywordflow">in</span> model_state.bases:</div>
<div class="line"><span class="lineno">  873</span>                <span class="keywordflow">if</span> isinstance(base, str) <span class="keywordflow">and</span> <span class="stringliteral">&quot;.&quot;</span> <span class="keywordflow">in</span> base:</div>
<div class="line"><span class="lineno">  874</span>                    base_app_label, base_name = base.split(<span class="stringliteral">&quot;.&quot;</span>, 1)</div>
<div class="line"><span class="lineno">  875</span>                    dependencies.append(</div>
<div class="line"><span class="lineno">  876</span>                        OperationDependency(</div>
<div class="line"><span class="lineno">  877</span>                            base_app_label,</div>
<div class="line"><span class="lineno">  878</span>                            base_name,</div>
<div class="line"><span class="lineno">  879</span>                            <span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno">  880</span>                            OperationDependency.Type.CREATE,</div>
<div class="line"><span class="lineno">  881</span>                        )</div>
<div class="line"><span class="lineno">  882</span>                    )</div>
<div class="line"><span class="lineno">  883</span>            <span class="comment"># Generate creation operation</span></div>
<div class="line"><span class="lineno">  884</span>            self.add_operation(</div>
<div class="line"><span class="lineno">  885</span>                app_label,</div>
<div class="line"><span class="lineno">  886</span>                operations.CreateModel(</div>
<div class="line"><span class="lineno">  887</span>                    name=model_state.name,</div>
<div class="line"><span class="lineno">  888</span>                    fields=[],</div>
<div class="line"><span class="lineno">  889</span>                    options=model_state.options,</div>
<div class="line"><span class="lineno">  890</span>                    bases=model_state.bases,</div>
<div class="line"><span class="lineno">  891</span>                    managers=model_state.managers,</div>
<div class="line"><span class="lineno">  892</span>                ),</div>
<div class="line"><span class="lineno">  893</span>                <span class="comment"># Depend on the deletion of any possible non-proxy version of us</span></div>
<div class="line"><span class="lineno">  894</span>                dependencies=dependencies,</div>
<div class="line"><span class="lineno">  895</span>            )</div>
<div class="line"><span class="lineno">  896</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l00534">add_operation()</a>, <a class="el" href="autodetector_8py_source.html#l00155">new_proxy_keys</a>, <a class="el" href="autodetector_8py_source.html#l00152">old_proxy_keys</a>, and <a class="el" href="autodetector_8py_source.html#l00057">to_state</a>.</p>

</div>
</div>
<a id="a5cbca66c331add1d0a571aa75126df10" name="a5cbca66c331add1d0a571aa75126df10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cbca66c331add1d0a571aa75126df10">&#9670;&#160;</a></span>generate_deleted_models()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.generate_deleted_models </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Find all deleted models (managed and unmanaged) and make delete
operations for them as well as separate operations to delete any
foreign key or M2M relationships (these are optimized later, if
possible).

Also bring forward removal of any model options that refer to
collections of fields - the inverse of generate_created_models().
</pre> 
<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00897">897</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  897</span>    <span class="keyword">def </span>generate_deleted_models(self):</div>
<div class="line"><span class="lineno">  898</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  899</span><span class="stringliteral">        Find all deleted models (managed and unmanaged) and make delete</span></div>
<div class="line"><span class="lineno">  900</span><span class="stringliteral">        operations for them as well as separate operations to delete any</span></div>
<div class="line"><span class="lineno">  901</span><span class="stringliteral">        foreign key or M2M relationships (these are optimized later, if</span></div>
<div class="line"><span class="lineno">  902</span><span class="stringliteral">        possible).</span></div>
<div class="line"><span class="lineno">  903</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  904</span><span class="stringliteral">        Also bring forward removal of any model options that refer to</span></div>
<div class="line"><span class="lineno">  905</span><span class="stringliteral">        collections of fields - the inverse of generate_created_models().</span></div>
<div class="line"><span class="lineno">  906</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  907</span>        new_keys = self.new_model_keys | self.new_unmanaged_keys</div>
<div class="line"><span class="lineno">  908</span>        deleted_models = self.old_model_keys - new_keys</div>
<div class="line"><span class="lineno">  909</span>        deleted_unmanaged_models = self.old_unmanaged_keys - new_keys</div>
<div class="line"><span class="lineno">  910</span>        all_deleted_models = chain(</div>
<div class="line"><span class="lineno">  911</span>            sorted(deleted_models), sorted(deleted_unmanaged_models)</div>
<div class="line"><span class="lineno">  912</span>        )</div>
<div class="line"><span class="lineno">  913</span>        <span class="keywordflow">for</span> app_label, model_name <span class="keywordflow">in</span> all_deleted_models:</div>
<div class="line"><span class="lineno">  914</span>            model_state = self.from_state.models[app_label, model_name]</div>
<div class="line"><span class="lineno">  915</span>            <span class="comment"># Gather related fields</span></div>
<div class="line"><span class="lineno">  916</span>            related_fields = {}</div>
<div class="line"><span class="lineno">  917</span>            <span class="keywordflow">for</span> field_name, field <span class="keywordflow">in</span> model_state.fields.items():</div>
<div class="line"><span class="lineno">  918</span>                <span class="keywordflow">if</span> field.remote_field:</div>
<div class="line"><span class="lineno">  919</span>                    <span class="keywordflow">if</span> field.remote_field.model:</div>
<div class="line"><span class="lineno">  920</span>                        related_fields[field_name] = field</div>
<div class="line"><span class="lineno">  921</span>                    <span class="keywordflow">if</span> getattr(field.remote_field, <span class="stringliteral">&quot;through&quot;</span>, <span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">  922</span>                        related_fields[field_name] = field</div>
<div class="line"><span class="lineno">  923</span>            <span class="comment"># Generate option removal first</span></div>
<div class="line"><span class="lineno">  924</span>            unique_together = model_state.options.pop(<span class="stringliteral">&quot;unique_together&quot;</span>, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  925</span>            <span class="keywordflow">if</span> unique_together:</div>
<div class="line"><span class="lineno">  926</span>                self.add_operation(</div>
<div class="line"><span class="lineno">  927</span>                    app_label,</div>
<div class="line"><span class="lineno">  928</span>                    operations.AlterUniqueTogether(</div>
<div class="line"><span class="lineno">  929</span>                        name=model_name,</div>
<div class="line"><span class="lineno">  930</span>                        unique_together=<span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno">  931</span>                    ),</div>
<div class="line"><span class="lineno">  932</span>                )</div>
<div class="line"><span class="lineno">  933</span>            <span class="comment"># Then remove each related field</span></div>
<div class="line"><span class="lineno">  934</span>            <span class="keywordflow">for</span> name <span class="keywordflow">in</span> sorted(related_fields):</div>
<div class="line"><span class="lineno">  935</span>                self.add_operation(</div>
<div class="line"><span class="lineno">  936</span>                    app_label,</div>
<div class="line"><span class="lineno">  937</span>                    operations.RemoveField(</div>
<div class="line"><span class="lineno">  938</span>                        model_name=model_name,</div>
<div class="line"><span class="lineno">  939</span>                        name=name,</div>
<div class="line"><span class="lineno">  940</span>                    ),</div>
<div class="line"><span class="lineno">  941</span>                )</div>
<div class="line"><span class="lineno">  942</span>            <span class="comment"># Finally, remove the model.</span></div>
<div class="line"><span class="lineno">  943</span>            <span class="comment"># This depends on both the removal/alteration of all incoming fields</span></div>
<div class="line"><span class="lineno">  944</span>            <span class="comment"># and the removal of all its own related fields, and if it&#39;s</span></div>
<div class="line"><span class="lineno">  945</span>            <span class="comment"># a through model the field that references it.</span></div>
<div class="line"><span class="lineno">  946</span>            dependencies = []</div>
<div class="line"><span class="lineno">  947</span>            relations = self.from_state.relations</div>
<div class="line"><span class="lineno">  948</span>            <span class="keywordflow">for</span> (</div>
<div class="line"><span class="lineno">  949</span>                related_object_app_label,</div>
<div class="line"><span class="lineno">  950</span>                object_name,</div>
<div class="line"><span class="lineno">  951</span>            ), relation_related_fields <span class="keywordflow">in</span> relations[app_label, model_name].items():</div>
<div class="line"><span class="lineno">  952</span>                <span class="keywordflow">for</span> field_name, field <span class="keywordflow">in</span> relation_related_fields.items():</div>
<div class="line"><span class="lineno">  953</span>                    dependencies.append(</div>
<div class="line"><span class="lineno">  954</span>                        OperationDependency(</div>
<div class="line"><span class="lineno">  955</span>                            related_object_app_label,</div>
<div class="line"><span class="lineno">  956</span>                            object_name,</div>
<div class="line"><span class="lineno">  957</span>                            field_name,</div>
<div class="line"><span class="lineno">  958</span>                            OperationDependency.Type.REMOVE,</div>
<div class="line"><span class="lineno">  959</span>                        ),</div>
<div class="line"><span class="lineno">  960</span>                    )</div>
<div class="line"><span class="lineno">  961</span>                    <span class="keywordflow">if</span> <span class="keywordflow">not</span> field.many_to_many:</div>
<div class="line"><span class="lineno">  962</span>                        dependencies.append(</div>
<div class="line"><span class="lineno">  963</span>                            OperationDependency(</div>
<div class="line"><span class="lineno">  964</span>                                related_object_app_label,</div>
<div class="line"><span class="lineno">  965</span>                                object_name,</div>
<div class="line"><span class="lineno">  966</span>                                field_name,</div>
<div class="line"><span class="lineno">  967</span>                                OperationDependency.Type.ALTER,</div>
<div class="line"><span class="lineno">  968</span>                            ),</div>
<div class="line"><span class="lineno">  969</span>                        )</div>
<div class="line"><span class="lineno">  970</span> </div>
<div class="line"><span class="lineno">  971</span>            <span class="keywordflow">for</span> name <span class="keywordflow">in</span> sorted(related_fields):</div>
<div class="line"><span class="lineno">  972</span>                dependencies.append(</div>
<div class="line"><span class="lineno">  973</span>                    OperationDependency(</div>
<div class="line"><span class="lineno">  974</span>                        app_label, model_name, name, OperationDependency.Type.REMOVE</div>
<div class="line"><span class="lineno">  975</span>                    )</div>
<div class="line"><span class="lineno">  976</span>                )</div>
<div class="line"><span class="lineno">  977</span>            <span class="comment"># We&#39;re referenced in another field&#39;s through=</span></div>
<div class="line"><span class="lineno">  978</span>            through_user = self.through_users.get((app_label, model_state.name_lower))</div>
<div class="line"><span class="lineno">  979</span>            <span class="keywordflow">if</span> through_user:</div>
<div class="line"><span class="lineno">  980</span>                dependencies.append(</div>
<div class="line"><span class="lineno">  981</span>                    OperationDependency(*through_user, OperationDependency.Type.REMOVE),</div>
<div class="line"><span class="lineno">  982</span>                )</div>
<div class="line"><span class="lineno">  983</span>            <span class="comment"># Finally, make the operation, deduping any dependencies</span></div>
<div class="line"><span class="lineno">  984</span>            self.add_operation(</div>
<div class="line"><span class="lineno">  985</span>                app_label,</div>
<div class="line"><span class="lineno">  986</span>                operations.DeleteModel(</div>
<div class="line"><span class="lineno">  987</span>                    name=model_state.name,</div>
<div class="line"><span class="lineno">  988</span>                ),</div>
<div class="line"><span class="lineno">  989</span>                dependencies=list(set(dependencies)),</div>
<div class="line"><span class="lineno">  990</span>            )</div>
<div class="line"><span class="lineno">  991</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l00534">add_operation()</a>, <a class="el" href="autodetector_8py_source.html#l00056">from_state</a>, <a class="el" href="autodetector_8py_source.html#l00154">new_model_keys</a>, <a class="el" href="autodetector_8py_source.html#l00156">new_unmanaged_keys</a>, <a class="el" href="autodetector_8py_source.html#l00151">old_model_keys</a>, <a class="el" href="autodetector_8py_source.html#l00153">old_unmanaged_keys</a>, and <a class="el" href="autodetector_8py_source.html#l00239">through_users</a>.</p>

</div>
</div>
<a id="ae468ca67a71f52051a2445ff1e6af344" name="ae468ca67a71f52051a2445ff1e6af344"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae468ca67a71f52051a2445ff1e6af344">&#9670;&#160;</a></span>generate_deleted_proxies()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.generate_deleted_proxies </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Make DeleteModel options for proxy models.</pre> 
<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00992">992</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  992</span>    <span class="keyword">def </span>generate_deleted_proxies(self):</div>
<div class="line"><span class="lineno">  993</span>        <span class="stringliteral">&quot;&quot;&quot;Make DeleteModel options for proxy models.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  994</span>        deleted = self.old_proxy_keys - self.new_proxy_keys</div>
<div class="line"><span class="lineno">  995</span>        <span class="keywordflow">for</span> app_label, model_name <span class="keywordflow">in</span> sorted(deleted):</div>
<div class="line"><span class="lineno">  996</span>            model_state = self.from_state.models[app_label, model_name]</div>
<div class="line"><span class="lineno">  997</span>            <span class="keyword">assert</span> model_state.options.get(<span class="stringliteral">&quot;proxy&quot;</span>)</div>
<div class="line"><span class="lineno">  998</span>            self.add_operation(</div>
<div class="line"><span class="lineno">  999</span>                app_label,</div>
<div class="line"><span class="lineno"> 1000</span>                operations.DeleteModel(</div>
<div class="line"><span class="lineno"> 1001</span>                    name=model_state.name,</div>
<div class="line"><span class="lineno"> 1002</span>                ),</div>
<div class="line"><span class="lineno"> 1003</span>            )</div>
<div class="line"><span class="lineno"> 1004</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l00534">add_operation()</a>, <a class="el" href="autodetector_8py_source.html#l00056">from_state</a>, <a class="el" href="autodetector_8py_source.html#l00155">new_proxy_keys</a>, and <a class="el" href="autodetector_8py_source.html#l00152">old_proxy_keys</a>.</p>

</div>
</div>
<a id="ab3f64632734cb26b5afafb67c1ad4aaa" name="ab3f64632734cb26b5afafb67c1ad4aaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3f64632734cb26b5afafb67c1ad4aaa">&#9670;&#160;</a></span>generate_removed_altered_unique_together()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.generate_removed_altered_unique_together </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l01661">1661</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1661</span>    <span class="keyword">def </span>generate_removed_altered_unique_together(self):</div>
<div class="line"><span class="lineno"> 1662</span>        self._generate_removed_altered_foo_together(operations.AlterUniqueTogether)</div>
<div class="line"><span class="lineno"> 1663</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l01636">_generate_removed_altered_foo_together()</a>.</p>

</div>
</div>
<a id="a51bafeed131e7021ef4ef1b5fb0426ea" name="a51bafeed131e7021ef4ef1b5fb0426ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51bafeed131e7021ef4ef1b5fb0426ea">&#9670;&#160;</a></span>generate_removed_constraints()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.generate_removed_constraints </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l01492">1492</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1492</span>    <span class="keyword">def </span>generate_removed_constraints(self):</div>
<div class="line"><span class="lineno"> 1493</span>        <span class="keywordflow">for</span> (</div>
<div class="line"><span class="lineno"> 1494</span>            app_label,</div>
<div class="line"><span class="lineno"> 1495</span>            model_name,</div>
<div class="line"><span class="lineno"> 1496</span>        ), alt_constraints <span class="keywordflow">in</span> self.altered_constraints.items():</div>
<div class="line"><span class="lineno"> 1497</span>            <span class="keywordflow">for</span> constraint <span class="keywordflow">in</span> alt_constraints[<span class="stringliteral">&quot;removed_constraints&quot;</span>]:</div>
<div class="line"><span class="lineno"> 1498</span>                self.add_operation(</div>
<div class="line"><span class="lineno"> 1499</span>                    app_label,</div>
<div class="line"><span class="lineno"> 1500</span>                    operations.RemoveConstraint(</div>
<div class="line"><span class="lineno"> 1501</span>                        model_name=model_name,</div>
<div class="line"><span class="lineno"> 1502</span>                        name=constraint.name,</div>
<div class="line"><span class="lineno"> 1503</span>                    ),</div>
<div class="line"><span class="lineno"> 1504</span>                )</div>
<div class="line"><span class="lineno"> 1505</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l00534">add_operation()</a>, and <a class="el" href="autodetector_8py_source.html#l00146">altered_constraints</a>.</p>

</div>
</div>
<a id="ac11651cbda2fdf185635eb7d43b030ef" name="ac11651cbda2fdf185635eb7d43b030ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac11651cbda2fdf185635eb7d43b030ef">&#9670;&#160;</a></span>generate_removed_fields()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.generate_removed_fields </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Make RemoveField operations.</pre> 
<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l01169">1169</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1169</span>    <span class="keyword">def </span>generate_removed_fields(self):</div>
<div class="line"><span class="lineno"> 1170</span>        <span class="stringliteral">&quot;&quot;&quot;Make RemoveField operations.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1171</span>        <span class="keywordflow">for</span> app_label, model_name, field_name <span class="keywordflow">in</span> sorted(</div>
<div class="line"><span class="lineno"> 1172</span>            self.old_field_keys - self.new_field_keys</div>
<div class="line"><span class="lineno"> 1173</span>        ):</div>
<div class="line"><span class="lineno"> 1174</span>            self._generate_removed_field(app_label, model_name, field_name)</div>
<div class="line"><span class="lineno"> 1175</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l01176">_generate_removed_field()</a>, <a class="el" href="autodetector_8py_source.html#l00247">new_field_keys</a>, and <a class="el" href="autodetector_8py_source.html#l00240">old_field_keys</a>.</p>

</div>
</div>
<a id="a6f8f521964bf110849a7b59f1d1d9757" name="a6f8f521964bf110849a7b59f1d1d9757"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f8f521964bf110849a7b59f1d1d9757">&#9670;&#160;</a></span>generate_removed_indexes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.generate_removed_indexes </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l01427">1427</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1427</span>    <span class="keyword">def </span>generate_removed_indexes(self):</div>
<div class="line"><span class="lineno"> 1428</span>        <span class="keywordflow">for</span> (app_label, model_name), alt_indexes <span class="keywordflow">in</span> self.altered_indexes.items():</div>
<div class="line"><span class="lineno"> 1429</span>            <span class="keywordflow">for</span> index <span class="keywordflow">in</span> alt_indexes[<span class="stringliteral">&quot;removed_indexes&quot;</span>]:</div>
<div class="line"><span class="lineno"> 1430</span>                self.add_operation(</div>
<div class="line"><span class="lineno"> 1431</span>                    app_label,</div>
<div class="line"><span class="lineno"> 1432</span>                    operations.RemoveIndex(</div>
<div class="line"><span class="lineno"> 1433</span>                        model_name=model_name,</div>
<div class="line"><span class="lineno"> 1434</span>                        name=index.name,</div>
<div class="line"><span class="lineno"> 1435</span>                    ),</div>
<div class="line"><span class="lineno"> 1436</span>                )</div>
<div class="line"><span class="lineno"> 1437</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l00534">add_operation()</a>, and <a class="el" href="autodetector_8py_source.html#l00145">altered_indexes</a>.</p>

</div>
</div>
<a id="aadb22b62b82ef0aa2d94eb721f521365" name="aadb22b62b82ef0aa2d94eb721f521365"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadb22b62b82ef0aa2d94eb721f521365">&#9670;&#160;</a></span>generate_renamed_fields()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.generate_renamed_fields </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Generate RenameField operations.</pre> 
<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l01067">1067</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1067</span>    <span class="keyword">def </span>generate_renamed_fields(self):</div>
<div class="line"><span class="lineno"> 1068</span>        <span class="stringliteral">&quot;&quot;&quot;Generate RenameField operations.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1069</span>        <span class="keywordflow">for</span> (</div>
<div class="line"><span class="lineno"> 1070</span>            rem_app_label,</div>
<div class="line"><span class="lineno"> 1071</span>            rem_model_name,</div>
<div class="line"><span class="lineno"> 1072</span>            rem_db_column,</div>
<div class="line"><span class="lineno"> 1073</span>            rem_field_name,</div>
<div class="line"><span class="lineno"> 1074</span>            app_label,</div>
<div class="line"><span class="lineno"> 1075</span>            model_name,</div>
<div class="line"><span class="lineno"> 1076</span>            field,</div>
<div class="line"><span class="lineno"> 1077</span>            field_name,</div>
<div class="line"><span class="lineno"> 1078</span>        ) <span class="keywordflow">in</span> self.renamed_operations:</div>
<div class="line"><span class="lineno"> 1079</span>            <span class="comment"># A db_column mismatch requires a prior noop AlterField for the</span></div>
<div class="line"><span class="lineno"> 1080</span>            <span class="comment"># subsequent RenameField to be a noop on attempts at preserving the</span></div>
<div class="line"><span class="lineno"> 1081</span>            <span class="comment"># old name.</span></div>
<div class="line"><span class="lineno"> 1082</span>            <span class="keywordflow">if</span> rem_db_column != field.db_column:</div>
<div class="line"><span class="lineno"> 1083</span>                altered_field = field.clone()</div>
<div class="line"><span class="lineno"> 1084</span>                altered_field.name = rem_field_name</div>
<div class="line"><span class="lineno"> 1085</span>                self.add_operation(</div>
<div class="line"><span class="lineno"> 1086</span>                    app_label,</div>
<div class="line"><span class="lineno"> 1087</span>                    operations.AlterField(</div>
<div class="line"><span class="lineno"> 1088</span>                        model_name=model_name,</div>
<div class="line"><span class="lineno"> 1089</span>                        name=rem_field_name,</div>
<div class="line"><span class="lineno"> 1090</span>                        field=altered_field,</div>
<div class="line"><span class="lineno"> 1091</span>                    ),</div>
<div class="line"><span class="lineno"> 1092</span>                )</div>
<div class="line"><span class="lineno"> 1093</span>            self.add_operation(</div>
<div class="line"><span class="lineno"> 1094</span>                app_label,</div>
<div class="line"><span class="lineno"> 1095</span>                operations.RenameField(</div>
<div class="line"><span class="lineno"> 1096</span>                    model_name=model_name,</div>
<div class="line"><span class="lineno"> 1097</span>                    old_name=rem_field_name,</div>
<div class="line"><span class="lineno"> 1098</span>                    new_name=field_name,</div>
<div class="line"><span class="lineno"> 1099</span>                ),</div>
<div class="line"><span class="lineno"> 1100</span>            )</div>
<div class="line"><span class="lineno"> 1101</span>            self.old_field_keys.remove((rem_app_label, rem_model_name, rem_field_name))</div>
<div class="line"><span class="lineno"> 1102</span>            self.old_field_keys.add((app_label, model_name, field_name))</div>
<div class="line"><span class="lineno"> 1103</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l00534">add_operation()</a>, <a class="el" href="autodetector_8py_source.html#l00240">old_field_keys</a>, and <a class="el" href="autodetector_8py_source.html#l01007">renamed_operations</a>.</p>

</div>
</div>
<a id="a6bdde89b9f00807bff9bb4dcf26974d3" name="a6bdde89b9f00807bff9bb4dcf26974d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bdde89b9f00807bff9bb4dcf26974d3">&#9670;&#160;</a></span>generate_renamed_indexes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.generate_renamed_indexes </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l01438">1438</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1438</span>    <span class="keyword">def </span>generate_renamed_indexes(self):</div>
<div class="line"><span class="lineno"> 1439</span>        <span class="keywordflow">for</span> (app_label, model_name), alt_indexes <span class="keywordflow">in</span> self.altered_indexes.items():</div>
<div class="line"><span class="lineno"> 1440</span>            <span class="keywordflow">for</span> old_index_name, new_index_name, old_fields <span class="keywordflow">in</span> alt_indexes[</div>
<div class="line"><span class="lineno"> 1441</span>                <span class="stringliteral">&quot;renamed_indexes&quot;</span></div>
<div class="line"><span class="lineno"> 1442</span>            ]:</div>
<div class="line"><span class="lineno"> 1443</span>                self.add_operation(</div>
<div class="line"><span class="lineno"> 1444</span>                    app_label,</div>
<div class="line"><span class="lineno"> 1445</span>                    operations.RenameIndex(</div>
<div class="line"><span class="lineno"> 1446</span>                        model_name=model_name,</div>
<div class="line"><span class="lineno"> 1447</span>                        new_name=new_index_name,</div>
<div class="line"><span class="lineno"> 1448</span>                        old_name=old_index_name,</div>
<div class="line"><span class="lineno"> 1449</span>                        old_fields=old_fields,</div>
<div class="line"><span class="lineno"> 1450</span>                    ),</div>
<div class="line"><span class="lineno"> 1451</span>                )</div>
<div class="line"><span class="lineno"> 1452</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l00534">add_operation()</a>, and <a class="el" href="autodetector_8py_source.html#l00145">altered_indexes</a>.</p>

</div>
</div>
<a id="a21e8d95f6652845410c17519744e77fb" name="a21e8d95f6652845410c17519744e77fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21e8d95f6652845410c17519744e77fb">&#9670;&#160;</a></span>generate_renamed_models()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.generate_renamed_models </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Find any renamed models, generate the operations for them, and remove
the old entry from the model lists. Must be run before other
model-level generation.
</pre> 
<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00566">566</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  566</span>    <span class="keyword">def </span>generate_renamed_models(self):</div>
<div class="line"><span class="lineno">  567</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  568</span><span class="stringliteral">        Find any renamed models, generate the operations for them, and remove</span></div>
<div class="line"><span class="lineno">  569</span><span class="stringliteral">        the old entry from the model lists. Must be run before other</span></div>
<div class="line"><span class="lineno">  570</span><span class="stringliteral">        model-level generation.</span></div>
<div class="line"><span class="lineno">  571</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  572</span>        self.renamed_models = {}</div>
<div class="line"><span class="lineno">  573</span>        self.renamed_models_rel = {}</div>
<div class="line"><span class="lineno">  574</span>        added_models = self.new_model_keys - self.old_model_keys</div>
<div class="line"><span class="lineno">  575</span>        <span class="keywordflow">for</span> app_label, model_name <span class="keywordflow">in</span> sorted(added_models):</div>
<div class="line"><span class="lineno">  576</span>            model_state = self.to_state.models[app_label, model_name]</div>
<div class="line"><span class="lineno">  577</span>            model_fields_def = self.only_relation_agnostic_fields(model_state.fields)</div>
<div class="line"><span class="lineno">  578</span> </div>
<div class="line"><span class="lineno">  579</span>            removed_models = self.old_model_keys - self.new_model_keys</div>
<div class="line"><span class="lineno">  580</span>            <span class="keywordflow">for</span> rem_app_label, rem_model_name <span class="keywordflow">in</span> removed_models:</div>
<div class="line"><span class="lineno">  581</span>                <span class="keywordflow">if</span> rem_app_label == app_label:</div>
<div class="line"><span class="lineno">  582</span>                    rem_model_state = self.from_state.models[</div>
<div class="line"><span class="lineno">  583</span>                        rem_app_label, rem_model_name</div>
<div class="line"><span class="lineno">  584</span>                    ]</div>
<div class="line"><span class="lineno">  585</span>                    rem_model_fields_def = self.only_relation_agnostic_fields(</div>
<div class="line"><span class="lineno">  586</span>                        rem_model_state.fields</div>
<div class="line"><span class="lineno">  587</span>                    )</div>
<div class="line"><span class="lineno">  588</span>                    <span class="keywordflow">if</span> model_fields_def == rem_model_fields_def:</div>
<div class="line"><span class="lineno">  589</span>                        <span class="keywordflow">if</span> self.questioner.ask_rename_model(</div>
<div class="line"><span class="lineno">  590</span>                            rem_model_state, model_state</div>
<div class="line"><span class="lineno">  591</span>                        ):</div>
<div class="line"><span class="lineno">  592</span>                            dependencies = []</div>
<div class="line"><span class="lineno">  593</span>                            fields = list(model_state.fields.values()) + [</div>
<div class="line"><span class="lineno">  594</span>                                field.remote_field</div>
<div class="line"><span class="lineno">  595</span>                                <span class="keywordflow">for</span> relations <span class="keywordflow">in</span> self.to_state.relations[</div>
<div class="line"><span class="lineno">  596</span>                                    app_label, model_name</div>
<div class="line"><span class="lineno">  597</span>                                ].values()</div>
<div class="line"><span class="lineno">  598</span>                                <span class="keywordflow">for</span> field <span class="keywordflow">in</span> relations.values()</div>
<div class="line"><span class="lineno">  599</span>                            ]</div>
<div class="line"><span class="lineno">  600</span>                            <span class="keywordflow">for</span> field <span class="keywordflow">in</span> fields:</div>
<div class="line"><span class="lineno">  601</span>                                <span class="keywordflow">if</span> field.is_relation:</div>
<div class="line"><span class="lineno">  602</span>                                    dependencies.extend(</div>
<div class="line"><span class="lineno">  603</span>                                        self._get_dependencies_for_foreign_key(</div>
<div class="line"><span class="lineno">  604</span>                                            app_label,</div>
<div class="line"><span class="lineno">  605</span>                                            model_name,</div>
<div class="line"><span class="lineno">  606</span>                                            field,</div>
<div class="line"><span class="lineno">  607</span>                                            self.to_state,</div>
<div class="line"><span class="lineno">  608</span>                                        )</div>
<div class="line"><span class="lineno">  609</span>                                    )</div>
<div class="line"><span class="lineno">  610</span>                            self.add_operation(</div>
<div class="line"><span class="lineno">  611</span>                                app_label,</div>
<div class="line"><span class="lineno">  612</span>                                operations.RenameModel(</div>
<div class="line"><span class="lineno">  613</span>                                    old_name=rem_model_state.name,</div>
<div class="line"><span class="lineno">  614</span>                                    new_name=model_state.name,</div>
<div class="line"><span class="lineno">  615</span>                                ),</div>
<div class="line"><span class="lineno">  616</span>                                dependencies=dependencies,</div>
<div class="line"><span class="lineno">  617</span>                            )</div>
<div class="line"><span class="lineno">  618</span>                            self.renamed_models[app_label, model_name] = rem_model_name</div>
<div class="line"><span class="lineno">  619</span>                            renamed_models_rel_key = <span class="stringliteral">&quot;%s.%s&quot;</span> % (</div>
<div class="line"><span class="lineno">  620</span>                                rem_model_state.app_label,</div>
<div class="line"><span class="lineno">  621</span>                                rem_model_state.name_lower,</div>
<div class="line"><span class="lineno">  622</span>                            )</div>
<div class="line"><span class="lineno">  623</span>                            self.renamed_models_rel[renamed_models_rel_key] = (</div>
<div class="line"><span class="lineno">  624</span>                                <span class="stringliteral">&quot;%s.%s&quot;</span></div>
<div class="line"><span class="lineno">  625</span>                                % (</div>
<div class="line"><span class="lineno">  626</span>                                    model_state.app_label,</div>
<div class="line"><span class="lineno">  627</span>                                    model_state.name_lower,</div>
<div class="line"><span class="lineno">  628</span>                                )</div>
<div class="line"><span class="lineno">  629</span>                            )</div>
<div class="line"><span class="lineno">  630</span>                            self.old_model_keys.remove((rem_app_label, rem_model_name))</div>
<div class="line"><span class="lineno">  631</span>                            self.old_model_keys.add((app_label, model_name))</div>
<div class="line"><span class="lineno">  632</span>                            <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  633</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a1d06b0d4ccc0bce4efdddacee94f57c2" name="a1d06b0d4ccc0bce4efdddacee94f57c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d06b0d4ccc0bce4efdddacee94f57c2">&#9670;&#160;</a></span>only_relation_agnostic_fields()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.only_relation_agnostic_fields </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>fields</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Return a definition of the fields that ignores field names and
what related fields actually relate to. Used for detecting renames (as
the related fields change during renames).
</pre> 
<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00111">111</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  111</span>    <span class="keyword">def </span>only_relation_agnostic_fields(self, fields):</div>
<div class="line"><span class="lineno">  112</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  113</span><span class="stringliteral">        Return a definition of the fields that ignores field names and</span></div>
<div class="line"><span class="lineno">  114</span><span class="stringliteral">        what related fields actually relate to. Used for detecting renames (as</span></div>
<div class="line"><span class="lineno">  115</span><span class="stringliteral">        the related fields change during renames).</span></div>
<div class="line"><span class="lineno">  116</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  117</span>        fields_def = []</div>
<div class="line"><span class="lineno">  118</span>        <span class="keywordflow">for</span> name, field <span class="keywordflow">in</span> sorted(fields.items()):</div>
<div class="line"><span class="lineno">  119</span>            deconstruction = self.deep_deconstruct(field)</div>
<div class="line"><span class="lineno">  120</span>            <span class="keywordflow">if</span> field.remote_field <span class="keywordflow">and</span> field.remote_field.model:</div>
<div class="line"><span class="lineno">  121</span>                deconstruction[2].pop(<span class="stringliteral">&quot;to&quot;</span>, <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno">  122</span>            fields_def.append(deconstruction)</div>
<div class="line"><span class="lineno">  123</span>        <span class="keywordflow">return</span> fields_def</div>
<div class="line"><span class="lineno">  124</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l00073">deep_deconstruct()</a>.</p>

</div>
</div>
<a id="a4a1dae6fc864c1f8fc65f77538e9267d" name="a4a1dae6fc864c1f8fc65f77538e9267d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a1dae6fc864c1f8fc65f77538e9267d">&#9670;&#160;</a></span>parse_number()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.parse_number </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>cls</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>name</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Given a migration name, try to extract a number from the beginning of
it. For a squashed migration such as '0001_squashed_0004', return the
second number. If no number is found, return None.
</pre> 
<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l01896">1896</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1896</span>    <span class="keyword">def </span>parse_number(cls, name):</div>
<div class="line"><span class="lineno"> 1897</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1898</span><span class="stringliteral">        Given a migration name, try to extract a number from the beginning of</span></div>
<div class="line"><span class="lineno"> 1899</span><span class="stringliteral">        it. For a squashed migration such as &#39;0001_squashed_0004&#39;, return the</span></div>
<div class="line"><span class="lineno"> 1900</span><span class="stringliteral">        second number. If no number is found, return None.</span></div>
<div class="line"><span class="lineno"> 1901</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1902</span>        <span class="keywordflow">if</span> squashed_match := re.search(<span class="stringliteral">r&quot;.*_squashed_(\d+)&quot;</span>, name):</div>
<div class="line"><span class="lineno"> 1903</span>            <span class="keywordflow">return</span> int(squashed_match[1])</div>
<div class="line"><span class="lineno"> 1904</span>        match = re.match(<span class="stringliteral">r&quot;^\d+&quot;</span>, name)</div>
<div class="line"><span class="lineno"> 1905</span>        <span class="keywordflow">if</span> match:</div>
<div class="line"><span class="lineno"> 1906</span>            <span class="keywordflow">return</span> int(match[0])</div>
<div class="line"><span class="lineno"> 1907</span>        <span class="keywordflow">return</span> <span class="keywordtype">None</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l01816">arrange_for_graph()</a>.</p>

</div>
</div>
<a id="aa10b4b0cac4ad4a34f83478c2592af4a" name="aa10b4b0cac4ad4a34f83478c2592af4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa10b4b0cac4ad4a34f83478c2592af4a">&#9670;&#160;</a></span>swappable_first_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.swappable_first_key </td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>self</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>item</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Place potential swappable models first in lists of created models (only
real way to solve #22783).
</pre> 
<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00543">543</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  543</span>    <span class="keyword">def </span>swappable_first_key(self, item):</div>
<div class="line"><span class="lineno">  544</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  545</span><span class="stringliteral">        Place potential swappable models first in lists of created models (only</span></div>
<div class="line"><span class="lineno">  546</span><span class="stringliteral">        real way to solve #22783).</span></div>
<div class="line"><span class="lineno">  547</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  548</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  549</span>            model_state = self.to_state.models[item]</div>
<div class="line"><span class="lineno">  550</span>            base_names = {</div>
<div class="line"><span class="lineno">  551</span>                base <span class="keywordflow">if</span> isinstance(base, str) <span class="keywordflow">else</span> base.__name__</div>
<div class="line"><span class="lineno">  552</span>                <span class="keywordflow">for</span> base <span class="keywordflow">in</span> model_state.bases</div>
<div class="line"><span class="lineno">  553</span>            }</div>
<div class="line"><span class="lineno">  554</span>            string_version = <span class="stringliteral">&quot;%s.%s&quot;</span> % (item[0], item[1])</div>
<div class="line"><span class="lineno">  555</span>            <span class="keywordflow">if</span> (</div>
<div class="line"><span class="lineno">  556</span>                model_state.options.get(<span class="stringliteral">&quot;swappable&quot;</span>)</div>
<div class="line"><span class="lineno">  557</span>                <span class="keywordflow">or</span> <span class="stringliteral">&quot;AbstractUser&quot;</span> <span class="keywordflow">in</span> base_names</div>
<div class="line"><span class="lineno">  558</span>                <span class="keywordflow">or</span> <span class="stringliteral">&quot;AbstractBaseUser&quot;</span> <span class="keywordflow">in</span> base_names</div>
<div class="line"><span class="lineno">  559</span>                <span class="keywordflow">or</span> settings.AUTH_USER_MODEL.lower() == string_version.lower()</div>
<div class="line"><span class="lineno">  560</span>            ):</div>
<div class="line"><span class="lineno">  561</span>                <span class="keywordflow">return</span> (<span class="stringliteral">&quot;___&quot;</span> + item[0], <span class="stringliteral">&quot;___&quot;</span> + item[1])</div>
<div class="line"><span class="lineno">  562</span>        <span class="keywordflow">except</span> LookupError:</div>
<div class="line"><span class="lineno">  563</span>            <span class="keywordflow">pass</span></div>
<div class="line"><span class="lineno">  564</span>        <span class="keywordflow">return</span> item</div>
<div class="line"><span class="lineno">  565</span> </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="autodetector_8py_source.html#l00057">to_state</a>.</p>

<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l00634">generate_created_models()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a5b156d6f6452ffc33f685217ce32870a" name="a5b156d6f6452ffc33f685217ce32870a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b156d6f6452ffc33f685217ce32870a">&#9670;&#160;</a></span>altered_constraints</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dict django.db.migrations.autodetector.MigrationAutodetector.altered_constraints = {}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00146">146</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l01453">create_altered_constraints()</a>, <a class="el" href="autodetector_8py_source.html#l01476">generate_added_constraints()</a>, and <a class="el" href="autodetector_8py_source.html#l01492">generate_removed_constraints()</a>.</p>

</div>
</div>
<a id="a2b0c1f89f9c779cd0191d30f1633b5f3" name="a2b0c1f89f9c779cd0191d30f1633b5f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b0c1f89f9c779cd0191d30f1633b5f3">&#9670;&#160;</a></span>altered_indexes</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dict django.db.migrations.autodetector.MigrationAutodetector.altered_indexes = {}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00145">145</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l01414">generate_added_indexes()</a>, <a class="el" href="autodetector_8py_source.html#l01427">generate_removed_indexes()</a>, and <a class="el" href="autodetector_8py_source.html#l01438">generate_renamed_indexes()</a>.</p>

</div>
</div>
<a id="ae567bfab90e6fa7354a80b80f828bad5" name="ae567bfab90e6fa7354a80b80f828bad5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae567bfab90e6fa7354a80b80f828bad5">&#9670;&#160;</a></span>existing_apps</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dict django.db.migrations.autodetector.MigrationAutodetector.existing_apps = {app for app, model in from_state.models}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00059">59</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>

</div>
</div>
<a id="ae3935993133c78ec4bcac747661221c6" name="ae3935993133c78ec4bcac747661221c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3935993133c78ec4bcac747661221c6">&#9670;&#160;</a></span>from_state</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.from_state = from_state</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00056">56</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l00253">_generate_through_model_map()</a>, <a class="el" href="autodetector_8py_source.html#l01589">_get_altered_foo_together_operations()</a>, <a class="el" href="autodetector_8py_source.html#l01453">create_altered_constraints()</a>, <a class="el" href="autodetector_8py_source.html#l01683">generate_altered_db_table()</a>, <a class="el" href="autodetector_8py_source.html#l01704">generate_altered_db_table_comment()</a>, <a class="el" href="autodetector_8py_source.html#l01202">generate_altered_fields()</a>, <a class="el" href="autodetector_8py_source.html#l01800">generate_altered_managers()</a>, <a class="el" href="autodetector_8py_source.html#l01726">generate_altered_options()</a>, <a class="el" href="autodetector_8py_source.html#l01766">generate_altered_order_with_respect_to()</a>, <a class="el" href="autodetector_8py_source.html#l00634">generate_created_models()</a>, <a class="el" href="autodetector_8py_source.html#l00897">generate_deleted_models()</a>, and <a class="el" href="autodetector_8py_source.html#l00992">generate_deleted_proxies()</a>.</p>

</div>
</div>
<a id="ae064abf9d094023a19f4afcaa8e83bd6" name="ae064abf9d094023a19f4afcaa8e83bd6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae064abf9d094023a19f4afcaa8e83bd6">&#9670;&#160;</a></span>generated_operations</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.generated_operations = {}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00144">144</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l00414">_sort_migrations()</a>, and <a class="el" href="autodetector_8py_source.html#l00534">add_operation()</a>.</p>

</div>
</div>
<a id="a9ff0aef9e237d17156720d41d2b674e7" name="a9ff0aef9e237d17156720d41d2b674e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ff0aef9e237d17156720d41d2b674e7">&#9670;&#160;</a></span>kept_model_keys</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.kept_model_keys = self.old_model_keys &amp; self.new_model_keys</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00236">236</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l01589">_get_altered_foo_together_operations()</a>, <a class="el" href="autodetector_8py_source.html#l01453">create_altered_constraints()</a>, <a class="el" href="autodetector_8py_source.html#l01683">generate_altered_db_table()</a>, <a class="el" href="autodetector_8py_source.html#l01704">generate_altered_db_table_comment()</a>, <a class="el" href="autodetector_8py_source.html#l01800">generate_altered_managers()</a>, <a class="el" href="autodetector_8py_source.html#l01726">generate_altered_options()</a>, and <a class="el" href="autodetector_8py_source.html#l01766">generate_altered_order_with_respect_to()</a>.</p>

</div>
</div>
<a id="a303f64576427a2fa5166fb13aacaa696" name="a303f64576427a2fa5166fb13aacaa696"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a303f64576427a2fa5166fb13aacaa696">&#9670;&#160;</a></span>kept_proxy_keys</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.kept_proxy_keys = self.old_proxy_keys &amp; self.new_proxy_keys</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00237">237</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l01683">generate_altered_db_table()</a>, <a class="el" href="autodetector_8py_source.html#l01704">generate_altered_db_table_comment()</a>, and <a class="el" href="autodetector_8py_source.html#l01726">generate_altered_options()</a>.</p>

</div>
</div>
<a id="a1f95191e638375e25599d9b4e5adff5d" name="a1f95191e638375e25599d9b4e5adff5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f95191e638375e25599d9b4e5adff5d">&#9670;&#160;</a></span>kept_unmanaged_keys</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.kept_unmanaged_keys = self.old_unmanaged_keys &amp; self.new_unmanaged_keys</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00238">238</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l01683">generate_altered_db_table()</a>, <a class="el" href="autodetector_8py_source.html#l01704">generate_altered_db_table_comment()</a>, and <a class="el" href="autodetector_8py_source.html#l01726">generate_altered_options()</a>.</p>

</div>
</div>
<a id="af008e8fdb39f73d34d831c6872079d48" name="af008e8fdb39f73d34d831c6872079d48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af008e8fdb39f73d34d831c6872079d48">&#9670;&#160;</a></span>migrations</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dict django.db.migrations.autodetector.MigrationAutodetector.migrations = {}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00305">305</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l00432">_optimize_migrations()</a>.</p>

</div>
</div>
<a id="aa115c366a5aaf355cc6af5992fa1636c" name="aa115c366a5aaf355cc6af5992fa1636c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa115c366a5aaf355cc6af5992fa1636c">&#9670;&#160;</a></span>new_field_keys</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dict django.db.migrations.autodetector.MigrationAutodetector.new_field_keys</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=  {</div>
<div class="line">            (app_label, model_name, field_name)</div>
<div class="line">            <span class="keywordflow">for</span> app_label, model_name <span class="keywordflow">in</span> self.kept_model_keys</div>
<div class="line">            <span class="keywordflow">for</span> field_name <span class="keywordflow">in</span> self.to_state.models[app_label, model_name].fields</div>
<div class="line">        }</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00247">247</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l01552">_get_dependencies_for_generated_field()</a>, <a class="el" href="autodetector_8py_source.html#l01104">generate_added_fields()</a>, <a class="el" href="autodetector_8py_source.html#l01202">generate_altered_fields()</a>, and <a class="el" href="autodetector_8py_source.html#l01169">generate_removed_fields()</a>.</p>

</div>
</div>
<a id="aca782281b2c8f16702d8a7cfa97e6a04" name="aca782281b2c8f16702d8a7cfa97e6a04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca782281b2c8f16702d8a7cfa97e6a04">&#9670;&#160;</a></span>new_model_keys</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.new_model_keys = set()</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00154">154</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l01726">generate_altered_options()</a>, <a class="el" href="autodetector_8py_source.html#l00634">generate_created_models()</a>, and <a class="el" href="autodetector_8py_source.html#l00897">generate_deleted_models()</a>.</p>

</div>
</div>
<a id="ac813b271465b35a1ab0f7e0176e169d8" name="ac813b271465b35a1ab0f7e0176e169d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac813b271465b35a1ab0f7e0176e169d8">&#9670;&#160;</a></span>new_proxy_keys</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.new_proxy_keys = set()</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00155">155</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l00855">generate_created_proxies()</a>, and <a class="el" href="autodetector_8py_source.html#l00992">generate_deleted_proxies()</a>.</p>

</div>
</div>
<a id="a4119d514d649df84612160f721638c00" name="a4119d514d649df84612160f721638c00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4119d514d649df84612160f721638c00">&#9670;&#160;</a></span>new_unmanaged_keys</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.new_unmanaged_keys = set()</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00156">156</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l01726">generate_altered_options()</a>, <a class="el" href="autodetector_8py_source.html#l00634">generate_created_models()</a>, and <a class="el" href="autodetector_8py_source.html#l00897">generate_deleted_models()</a>.</p>

</div>
</div>
<a id="a7bd81319931b2d3d1f9082073a4fe1a4" name="a7bd81319931b2d3d1f9082073a4fe1a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7bd81319931b2d3d1f9082073a4fe1a4">&#9670;&#160;</a></span>old_field_keys</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dict django.db.migrations.autodetector.MigrationAutodetector.old_field_keys</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=  {</div>
<div class="line">            (app_label, model_name, field_name)</div>
<div class="line">            <span class="keywordflow">for</span> app_label, model_name <span class="keywordflow">in</span> self.kept_model_keys</div>
<div class="line">            <span class="keywordflow">for</span> field_name <span class="keywordflow">in</span> self.from_state.models[</div>
<div class="line">                app_label, self.renamed_models.get((app_label, model_name), model_name)</div>
<div class="line">            ].fields</div>
<div class="line">        }</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00240">240</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l01552">_get_dependencies_for_generated_field()</a>, <a class="el" href="autodetector_8py_source.html#l01104">generate_added_fields()</a>, <a class="el" href="autodetector_8py_source.html#l01202">generate_altered_fields()</a>, <a class="el" href="autodetector_8py_source.html#l01169">generate_removed_fields()</a>, and <a class="el" href="autodetector_8py_source.html#l01067">generate_renamed_fields()</a>.</p>

</div>
</div>
<a id="a27fc3da1c7714b60fc3ddd078e9eaf7b" name="a27fc3da1c7714b60fc3ddd078e9eaf7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27fc3da1c7714b60fc3ddd078e9eaf7b">&#9670;&#160;</a></span>old_model_keys</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.old_model_keys = set()</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00151">151</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l00253">_generate_through_model_map()</a>, <a class="el" href="autodetector_8py_source.html#l01726">generate_altered_options()</a>, <a class="el" href="autodetector_8py_source.html#l00634">generate_created_models()</a>, and <a class="el" href="autodetector_8py_source.html#l00897">generate_deleted_models()</a>.</p>

</div>
</div>
<a id="a65fe03dbaad2fc1a6f9687c9d394819e" name="a65fe03dbaad2fc1a6f9687c9d394819e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65fe03dbaad2fc1a6f9687c9d394819e">&#9670;&#160;</a></span>old_proxy_keys</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.old_proxy_keys = set()</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00152">152</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l00634">generate_created_models()</a>, <a class="el" href="autodetector_8py_source.html#l00855">generate_created_proxies()</a>, and <a class="el" href="autodetector_8py_source.html#l00992">generate_deleted_proxies()</a>.</p>

</div>
</div>
<a id="a475932761b0856d91b3bd5cd6f4e29d9" name="a475932761b0856d91b3bd5cd6f4e29d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a475932761b0856d91b3bd5cd6f4e29d9">&#9670;&#160;</a></span>old_unmanaged_keys</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.old_unmanaged_keys = set()</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00153">153</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l01726">generate_altered_options()</a>, <a class="el" href="autodetector_8py_source.html#l00634">generate_created_models()</a>, and <a class="el" href="autodetector_8py_source.html#l00897">generate_deleted_models()</a>.</p>

</div>
</div>
<a id="a76aec2ce3dd7c311c1b6c45933c3e81c" name="a76aec2ce3dd7c311c1b6c45933c3e81c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76aec2ce3dd7c311c1b6c45933c3e81c">&#9670;&#160;</a></span>questioner</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.questioner = questioner or <a class="el" href="classdjango_1_1db_1_1migrations_1_1questioner_1_1_migration_questioner.html">MigrationQuestioner</a>()</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00058">58</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l01111">_generate_added_field()</a>, <a class="el" href="autodetector_8py_source.html#l01816">arrange_for_graph()</a>, and <a class="el" href="autodetector_8py_source.html#l01202">generate_altered_fields()</a>.</p>

</div>
</div>
<a id="afddac3c1d0bf574757c8baada184a75b" name="afddac3c1d0bf574757c8baada184a75b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afddac3c1d0bf574757c8baada184a75b">&#9670;&#160;</a></span>renamed_fields</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dict django.db.migrations.autodetector.MigrationAutodetector.renamed_fields = {}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00147">147</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l01589">_get_altered_foo_together_operations()</a>, and <a class="el" href="autodetector_8py_source.html#l01202">generate_altered_fields()</a>.</p>

</div>
</div>
<a id="a69d602dfd71c9a08b938c8ceadcf59ec" name="a69d602dfd71c9a08b938c8ceadcf59ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69d602dfd71c9a08b938c8ceadcf59ec">&#9670;&#160;</a></span>renamed_index_together_values</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.renamed_index_together_values = defaultdict(list)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l01327">1327</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l01636">_generate_removed_altered_foo_together()</a>.</p>

</div>
</div>
<a id="acf7c12b831f5771f0d1b69882c1e310e" name="acf7c12b831f5771f0d1b69882c1e310e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf7c12b831f5771f0d1b69882c1e310e">&#9670;&#160;</a></span>renamed_models</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dict django.db.migrations.autodetector.MigrationAutodetector.renamed_models = {}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00572">572</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l00253">_generate_through_model_map()</a>, <a class="el" href="autodetector_8py_source.html#l01589">_get_altered_foo_together_operations()</a>, <a class="el" href="autodetector_8py_source.html#l01453">create_altered_constraints()</a>, <a class="el" href="autodetector_8py_source.html#l01683">generate_altered_db_table()</a>, <a class="el" href="autodetector_8py_source.html#l01704">generate_altered_db_table_comment()</a>, <a class="el" href="autodetector_8py_source.html#l01202">generate_altered_fields()</a>, <a class="el" href="autodetector_8py_source.html#l01800">generate_altered_managers()</a>, <a class="el" href="autodetector_8py_source.html#l01726">generate_altered_options()</a>, and <a class="el" href="autodetector_8py_source.html#l01766">generate_altered_order_with_respect_to()</a>.</p>

</div>
</div>
<a id="a346b69907bdc87ee21f61b4e31a23392" name="a346b69907bdc87ee21f61b4e31a23392"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a346b69907bdc87ee21f61b4e31a23392">&#9670;&#160;</a></span>renamed_models_rel</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dict django.db.migrations.autodetector.MigrationAutodetector.renamed_models_rel = {}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00573">573</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>

</div>
</div>
<a id="adf862f92cdb4ae7784c197ab87569383" name="adf862f92cdb4ae7784c197ab87569383"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf862f92cdb4ae7784c197ab87569383">&#9670;&#160;</a></span>renamed_operations</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">list django.db.migrations.autodetector.MigrationAutodetector.renamed_operations = []</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l01007">1007</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l01067">generate_renamed_fields()</a>.</p>

</div>
</div>
<a id="ac99ba9cb443efb4f6cb55f1dc8e0782b" name="ac99ba9cb443efb4f6cb55f1dc8e0782b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac99ba9cb443efb4f6cb55f1dc8e0782b">&#9670;&#160;</a></span>through_users</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dict django.db.migrations.autodetector.MigrationAutodetector.through_users = {}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00239">239</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l00253">_generate_through_model_map()</a>, and <a class="el" href="autodetector_8py_source.html#l00897">generate_deleted_models()</a>.</p>

</div>
</div>
<a id="ae481e4bba8448edbffe5eda74a7169bd" name="ae481e4bba8448edbffe5eda74a7169bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae481e4bba8448edbffe5eda74a7169bd">&#9670;&#160;</a></span>to_state</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">django.db.migrations.autodetector.MigrationAutodetector.to_state = to_state</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="autodetector_8py_source.html#l00057">57</a> of file <a class="el" href="autodetector_8py_source.html">autodetector.py</a>.</p>

<p class="reference">Referenced by <a class="el" href="autodetector_8py_source.html#l01111">_generate_added_field()</a>, <a class="el" href="autodetector_8py_source.html#l01589">_get_altered_foo_together_operations()</a>, <a class="el" href="autodetector_8py_source.html#l01552">_get_dependencies_for_generated_field()</a>, <a class="el" href="autodetector_8py_source.html#l01573">_get_dependencies_for_model()</a>, <a class="el" href="autodetector_8py_source.html#l01453">create_altered_constraints()</a>, <a class="el" href="autodetector_8py_source.html#l01683">generate_altered_db_table()</a>, <a class="el" href="autodetector_8py_source.html#l01704">generate_altered_db_table_comment()</a>, <a class="el" href="autodetector_8py_source.html#l01202">generate_altered_fields()</a>, <a class="el" href="autodetector_8py_source.html#l01800">generate_altered_managers()</a>, <a class="el" href="autodetector_8py_source.html#l01726">generate_altered_options()</a>, <a class="el" href="autodetector_8py_source.html#l01766">generate_altered_order_with_respect_to()</a>, <a class="el" href="autodetector_8py_source.html#l00634">generate_created_models()</a>, <a class="el" href="autodetector_8py_source.html#l00855">generate_created_proxies()</a>, and <a class="el" href="autodetector_8py_source.html#l00543">swappable_first_key()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>project/ENV/Lib/site-packages/django/db/migrations/<a class="el" href="autodetector_8py_source.html">autodetector.py</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacedjango.html">django</a></li><li class="navelem"><a class="el" href="namespacedjango_1_1db.html">db</a></li><li class="navelem"><a class="el" href="namespacedjango_1_1db_1_1migrations.html">migrations</a></li><li class="navelem"><a class="el" href="namespacedjango_1_1db_1_1migrations_1_1autodetector.html">autodetector</a></li><li class="navelem"><a class="el" href="classdjango_1_1db_1_1migrations_1_1autodetector_1_1_migration_autodetector.html">MigrationAutodetector</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
